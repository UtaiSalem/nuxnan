import{z as V,af as z,r as m,N as F,f as I,aA as M,g as P,c as a,b as n,d as h,F as f,j as Y,a as t,u as r,t as b,n as U,w as q,a8 as G,Y as L,aB as H,o,aC as J,I as d}from"./DuB962GZ.js";import{C as K}from"./DvOU9n0k.js";import{_ as O}from"./Oh9mCLdH.js";import"./fgoR5NrX.js";import"./BgB4xtqt.js";import"./DG8aYUbs.js";import"./CaSR6SuD.js";import"./BQxta0Da.js";import"./BmpSa16v.js";import"./DlRiQVPw.js";import"./C3g3vxIO.js";const Q={key:1,class:"bg-red-50 dark:bg-red-900/20 rounded-xl p-8 text-center max-w-md mx-auto"},W={class:"text-red-600 dark:text-red-400 mb-4"},X={key:0,class:"bg-gradient-to-r from-blue-600 via-cyan-600 to-purple-600 dark:from-blue-800 dark:via-cyan-800 dark:to-purple-800 rounded-2xl p-6 shadow-xl mb-6"},Z={class:"flex items-center justify-between"},ee={class:"flex items-center gap-4"},te={class:"w-14 h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg"},se={class:"text-white/80 text-sm"},oe={key:1,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12 text-center"},ae={class:"text-gray-600 dark:text-gray-400"},ve=V({__name:"lessons",setup(ne){const p=M(),x=H(),w=z(),l=L("course"),g=L("isCourseAdmin"),c=m([]),v=m(!0),u=m(null),y=m(!1),C=F(()=>(console.log("isRoot Path Check:",p.path),/\/lessons\/?$/.test(p.path))),i=async()=>{if(l.value?.id){v.value=!0,u.value=null;try{const e=await w.get(`/api/courses/${l.value.id}/lessons`);console.log("Lessons Response:",e),c.value=e.lessons||e.data||e||[]}catch(e){console.error("Error fetching lessons:",e),u.value=e.message||"ไม่สามารถโหลดบทเรียนได้"}finally{v.value=!1}}},$=()=>{x.push(`/courses/${l.value.id}/lessons/create`)},B=e=>{x.push(`/courses/${l.value.id}/lessons/${e.id}/edit`)},E=async e=>{if(confirm("ยืนยันการลบบทเรียน?"))try{await w.delete(`/api/courses/${l.value.id}/lessons/${e}`),await i()}catch(s){console.error("Error deleting lesson",s),alert("เกิดข้อผิดพลาดในการลบ")}},N=async e=>{await i()},D=async e=>{await i()},R=async e=>{},S=e=>{},j=e=>{x.push(`/courses/${l.value.id}/lessons/${e.id}#comments`)},A=()=>{window.scrollTo({top:0,behavior:"smooth"})},k=()=>{y.value=window.scrollY>300};return I(()=>{console.log("Lessons Mounted. Name:",p.name),i(),window.addEventListener("scroll",k)}),P(()=>{window.removeEventListener("scroll",k)}),(e,s)=>{const T=J;return o(),a("div",null,[n(T),C.value?(o(),a(f,{key:0},[v.value?(o(),Y(K,{key:0})):u.value?(o(),a("div",Q,[n(r(d),{icon:"fluent:error-circle-24-regular",class:"w-16 h-16 text-red-500 mx-auto mb-4"}),s[0]||(s[0]=t("h3",{class:"text-xl font-bold text-red-700 dark:text-red-400 mb-2"},"เกิดข้อผิดพลาด",-1)),t("p",W,b(u.value),1),t("button",{onClick:i,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," ลองใหม่ ")])):(o(),a(f,{key:2},[r(g)?(o(),a("div",X,[t("div",Z,[t("div",ee,[t("div",te,[n(r(d),{icon:"fluent:book-24-filled",class:"w-7 h-7 text-white"})]),t("div",null,[s[1]||(s[1]=t("h2",{class:"text-2xl font-bold text-white mb-1"},"บทเรียนทั้งหมด",-1)),t("p",se,b(c.value.length)+" บทเรียน",1)])]),t("button",{onClick:$,class:"flex items-center gap-2 px-5 py-3 bg-white text-blue-600 rounded-xl hover:bg-blue-50 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 font-bold"},[n(r(d),{icon:"fluent:add-circle-24-filled",class:"w-5 h-5"}),s[2]||(s[2]=t("span",null,"เพิ่มบทเรียน",-1))])])])):h("",!0),c.value.length?h("",!0):(o(),a("div",oe,[n(r(d),{icon:"fluent:book-24-regular",class:"w-24 h-24 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s[3]||(s[3]=t("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-2"}," ยังไม่มีบทเรียนในรายวิชานี้ ",-1)),t("p",ae,b(r(g)?"เริ่มสร้างบทเรียนแรกของคุณ":"อาจารย์กำลังเตรียมบทเรียนอยู่"),1)])),(o(!0),a(f,null,U(c.value,_=>(o(),a("div",{key:_.id},[n(O,{lesson:_,"is-admin":r(g),onEdit:B,onDelete:E,onLike:N,onDislike:D,onBookmark:R,onShare:S,onComment:j},null,8,["lesson","is-admin"])]))),128))],64))],64)):h("",!0),n(G,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 translate-y-10","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition ease-in duration-300","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-10"},{default:q(()=>[y.value?(o(),a("button",{key:0,onClick:A,class:"fixed bottom-8 right-8 z-[999] p-3 bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-full shadow-lg border border-gray-200 dark:border-gray-700 hover:shadow-xl hover:-translate-y-1 transition-all",title:"เลื่อนขึ้นด้านบน"},[n(r(d),{icon:"fluent:arrow-up-24-filled",class:"w-6 h-6"})])):h("",!0)]),_:1})])}}});export{ve as default};
