import{r as d,j as h,o as l,w as m,a as s,c as A,d as $,h as w,b as u}from"./DuB962GZ.js";import{S as n}from"./BQxta0Da.js";import I from"./DlGh3WWW.js";import{_ as R}from"./CeNU_Arc.js";import{_ as T}from"./9FJTssRe.js";import"./fgoR5NrX.js";import"./CZOFP7UD.js";import"./Dz4Xxw99.js";import"./Dn9pp5cj.js";const x={class:"mt-4"},B={key:0},V={__name:"AcademyLayout",props:{academy:Object,isAcademyAdmin:Boolean},setup(r){const e=r;d(!1),d([]);const p=d(e.academy.data.logo?"/storage/images/academies/logos/"+e.academy.data.logo:"/storage/images/academies/logos/default_logo.png"),y=d(e.academy.data.cover?"/storage/images/academies/covers/"+e.academy.data.cover:"/storage/images/academies/covers/default_cover.png"),c=d(e.academy.data.name),i=d(e.academy.data.slogan);async function g(a){const t=new FormData;t.append("cover",a),t.append("_method","patch"),await axios.post(`/academies/${e.academy.data.id}/update`,t)}async function b(a){const t=new FormData;t.append("logo",a),t.append("_method","patch"),await axios.post(`/academies/${e.academy.data.id}/update`,t)}async function f(a){await axios.patch(`/academies/${e.academy.data.id}/update`,{name:a})}async function v(a){await axios.patch(`/academies/${e.academy.data.id}/update`,{slogan:a})}async function C(){try{let a=await axios.post(`/academies/${e.academy.data.id}/members`);a.data&&a.data.success?(e.academy.data.memberStatus=a.data.memberStatus,e.academy.data.total_students=a.data.totalStudents,a.data&&a.data.success&&(e.academy.data.memberStatus=a.data.memberStatus,n.fire("เสร็จสิ้น","ขอเป็นสมาชิกเรียบร้อยแล้ว","success"))):a.data&&!a.data.success&&n.fire("เกิดข้อผิดพลาด",a.data.msg,"error")}catch(a){console.log(a)}}async function S(){console.log("unmember");try{let a=await axios.post(`/academies/${e.academy.data.id}/unmembers`);a.data&&a.data.success&&(e.academy.data.memberStatus==2&&e.academy.data.total_students--,e.academy.data.memberStatus=null,n.fire("เสร็จสิ้น","ออกจากการเป็นสมาชิกเรียบร้อยแล้ว","success"))}catch(a){console.log(a)}}return(a,t)=>(l(),h(I,{title:e.academy.data.name},{coverProfileCard:m(()=>[u(R,{coverImage:y.value,logoImage:p.value,coverHeader:c.value,"onUpdate:coverHeader":t[0]||(t[0]=o=>c.value=o),coverSubheader:i.value,"onUpdate:coverSubheader":t[1]||(t[1]=o=>i.value=o),model:"Academy",modelTable:"academies",modelableId:e.academy.data.id,modelableType:"app/models/Academy",modelableRoute:`/academies/${e.academy.data.id}`,modelData:e.academy.data,subModelDataLength:e.academy.data.courses_offered,subModelNameTh:"รายวิชา",isAcademyAdmin:e.isAcademyAdmin,onCoverImageChange:t[2]||(t[2]=o=>{g(o)}),onLogoImageChange:t[3]||(t[3]=o=>{b(o)}),onHeaderChange:t[4]||(t[4]=o=>{f(o)}),onSubheaderChange:t[5]||(t[5]=o=>{v(o)}),onRequestTobeMember:C,onRequestTobeUnmember:S},null,8,["coverImage","logoImage","coverHeader","coverSubheader","modelableId","modelableRoute","modelData","subModelDataLength","isAcademyAdmin"]),u(T,{academy:r.academy,activeTab:0},null,8,["academy"])]),leftSideWidget:m(()=>[...t[6]||(t[6]=[s("div",{class:"space-y-4"},null,-1)])]),mainContent:m(()=>[s("div",x,[a.$slots.academyContent?(l(),A("div",B,[w(a.$slots,"academyContent")])):$("",!0)])]),rightSideWidget:m(()=>[...t[7]||(t[7]=[s("div",null,null,-1)])]),_:3},8,["title"]))}};export{V as default};
