import{z as C,an as U,af as q,A as z,r as x,Z as M,N as $,c as f,a as t,b as n,u as s,d as k,l as i,e as u,y as m,aj as v,F as B,n as N,j,t as w,O as H,m as S,o as g,I as p}from"./DuB962GZ.js";import{S as h}from"./BQxta0Da.js";const F={class:"container mx-auto px-4 py-6 max-w-4xl"},I={class:"flex items-center gap-4 mb-6"},T={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},A={class:"p-6 space-y-6"},L={class:"grid gap-6"},O={class:"grid md:grid-cols-2 gap-6"},P={class:"space-y-4"},R={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},E={class:"relative"},Z={class:"space-y-4"},G={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},J={class:"flex flex-col sm:flex-row gap-6"},K={class:"flex items-center gap-3 cursor-pointer group"},Q={class:"relative flex items-center"},W={class:"flex items-center gap-3 cursor-pointer group"},X={class:"relative flex items-center"},Y={key:0,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},ee={class:"flex items-start gap-3"},te={class:"list-disc list-inside text-sm text-red-600 dark:text-red-400"},re={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3"},se=["disabled"],ae=["disabled"],ie=C({__name:"create",setup(oe){const b=U().params.id,_=q();z();const l=x(!1),d=x([]),r=M({title:"",description:"",start_date:new Date,end_date:new Date(Date.now()+3600*1e3),time_limit:60,passing_score:50,is_active:!0,shuffle_questions:!1}),c=$(()=>r.title.trim()!==""&&r.time_limit>0&&r.passing_score>=0&&r.passing_score<=100&&(!r.start_date||!r.end_date||new Date(r.end_date)>new Date(r.start_date))),V=async()=>{if(!(!c.value||l.value)){l.value=!0,d.value=[];try{const o={title:r.title,description:r.description,time_limit:r.time_limit,passing_score:r.passing_score,is_active:r.is_active,shuffle_questions:r.shuffle_questions,start_date:r.start_date,end_date:r.end_date};(await _.post(`/api/courses/${b}/quizzes`,o)).success&&(h.fire({icon:"success",title:"สร้างแบบทดสอบสำเร็จ",timer:1500,showConfirmButton:!1}),H(`/courses/${b}/quizzes`))}catch(o){console.error(o),o.data?.errors?d.value=Object.values(o.data.errors).flat():d.value=["เกิดข้อผิดพลาดในการสร้างแบบทดสอบ"],h.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:d.value[0]})}finally{l.value=!1}}};return(o,e)=>{const y=S("VueDatePicker");return g(),f("div",F,[t("div",I,[t("button",{onClick:e[0]||(e[0]=a=>o.$router.back()),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-500 transition-colors"},[n(s(p),{icon:"fluent:arrow-left-24-regular",class:"w-6 h-6"})]),e[10]||(e[10]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"สร้างแบบทดสอบใหม่"),t("p",{class:"text-sm text-gray-500"},"กรอกข้อมูลเพื่อสร้างแบบทดสอบสำหรับรายวิชานี้")],-1))]),t("div",T,[t("div",A,[t("div",L,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[u(" ชื่อแบบทดสอบ "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s(r).title=a),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-shadow",placeholder:"เช่น แบบทดสอบบทที่ 1"},null,512),[[m,s(r).title]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," คำอธิบาย ",-1)),i(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>s(r).description=a),rows:"3",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-shadow",placeholder:"รายละเอียดย่อ หรือคำชี้แจง..."},null,512),[[m,s(r).description]])])]),e[24]||(e[24]=t("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),t("div",O,[t("div",P,[t("h3",R,[n(s(p),{icon:"fluent:timer-24-regular",class:"w-5 h-5 text-gray-400"}),e[13]||(e[13]=u(" การตั้งค่าเวลาและคะแนน ",-1))]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[u(" เวลาในการทำข้อสอบ (นาที) "),t("span",{class:"text-red-500"},"*")],-1)),i(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>s(r).time_limit=a),type:"number",min:"1",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[m,s(r).time_limit,void 0,{number:!0}]])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[u(" เกณฑ์ผ่าน (%) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",E,[i(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s(r).passing_score=a),type:"number",min:"0",max:"100",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-8"},null,512),[[m,s(r).passing_score,void 0,{number:!0}]]),e[15]||(e[15]=t("span",{class:"absolute right-3 top-2.5 text-gray-500"},"%",-1))])])]),t("div",Z,[t("h3",G,[n(s(p),{icon:"fluent:calendar-ltr-24-regular",class:"w-5 h-5 text-gray-400"}),e[17]||(e[17]=u(" กำหนดการ ",-1))]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," เริ่มทำได้ตั้งแต่ ",-1)),n(y,{modelValue:s(r).start_date,"onUpdate:modelValue":e[5]||(e[5]=a=>s(r).start_date=a),format:"dd/MM/yyyy HH:mm","auto-apply":"",teleport:!0,"input-class-name":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white"},null,8,["modelValue"])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," สิ้นสุดเมื่อ ",-1)),n(y,{modelValue:s(r).end_date,"onUpdate:modelValue":e[6]||(e[6]=a=>s(r).end_date=a),format:"dd/MM/yyyy HH:mm","auto-apply":"",teleport:!0},null,8,["modelValue"])])])]),e[25]||(e[25]=t("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),t("div",J,[t("label",K,[t("div",Q,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=a=>s(r).shuffle_questions=a),class:"peer sr-only"},null,512),[[v,s(r).shuffle_questions]]),e[20]||(e[20]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"},null,-1))]),e[21]||(e[21]=t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors"},"สลับข้อคำถาม",-1))]),t("label",W,[t("div",X,[i(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>s(r).is_active=a),class:"peer sr-only"},null,512),[[v,s(r).is_active]]),e[22]||(e[22]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-600"},null,-1))]),e[23]||(e[23]=t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-300 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors"},"เปิดใช้งาน (เผยแพร่)",-1))])]),s(d).length?(g(),f("div",Y,[t("div",ee,[n(s(p),{icon:"fluent:error-circle-24-filled",class:"w-5 h-5 text-red-500 mt-0.5"}),t("ul",te,[(g(!0),f(B,null,N(s(d),(a,D)=>(g(),f("li",{key:D},w(a),1))),128))])])])):k("",!0)]),t("div",re,[t("button",{onClick:e[9]||(e[9]=a=>o.$router.back()),class:"px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:s(l)}," ยกเลิก ",8,se),t("button",{onClick:V,class:"px-6 py-2 rounded-lg bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-medium hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2",disabled:!s(c)||s(l)},[s(l)?(g(),j(s(p),{key:0,icon:"svg-spinners:ring-resize",class:"w-5 h-5"})):k("",!0),t("span",null,w(s(l)?"กำลังบันทึก...":"สร้างแบบทดสอบ"),1)],8,ae)])])])}}});export{ie as default};
