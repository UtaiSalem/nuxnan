import{z as M,r as w,N as G,c as g,o,a as e,d as $,b as d,u as l,I as u,q as L,e as j,t as D,i as H,j as T,a4 as U,f as N,G as K,_ as z,af as P,a8 as Q,w as W,l as F,y as R,p as X,m as Z,F as V,n as E,O as ee,Y as O}from"./DuB962GZ.js";import{_ as te}from"./BgB4xtqt.js";import{a as q,_ as Y}from"./BtFEd6Q7.js";import{u as se}from"./CaSR6SuD.js";import{C as ae}from"./DvOU9n0k.js";import"./BmpSa16v.js";import"./BQxta0Da.js";const re={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden mb-6 border border-gray-200 dark:border-gray-700 group"},ne={class:"relative"},oe={class:"relative h-32 bg-gradient-to-br from-violet-600 via-indigo-600 to-cyan-600 dark:from-violet-900 dark:via-indigo-900 dark:to-cyan-900 overflow-hidden rounded-t-2xl"},le={class:"w-full h-full flex items-center justify-center"},ie={class:"absolute top-4 left-4 flex flex-wrap gap-2"},de={key:0,class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/90 backdrop-blur-md text-white text-xs font-bold shadow-lg ring-1 ring-white/20 transition-transform hover:scale-105"},ue={key:0,class:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200"},ge={class:"p-6"},ce={class:"mb-4"},me={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2 leading-tight"},be={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mt-2"},ve={key:0,class:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full ml-1"},fe={key:0,class:"prose prose-sm dark:prose-invert max-w-none mb-6"},pe={class:"flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700"},ye={key:0,class:"flex items-center gap-2"},xe={key:1},ke={key:0},he={key:1},we={key:2},$e={key:1,class:"mt-6 pt-6 border-t border-gray-100 dark:border-gray-700"},Ce={key:2,class:"mt-6 pt-6 border-t border-gray-100 dark:border-gray-700"},Se={components:{AssignmentGradingView:Y,AssignmentSubmissionForm:q}},_e=M({...Se,__name:"AssignmentCard",props:{assignment:{},isCourseAdmin:{type:Boolean,default:!1},courseId:{}},emits:["edit","delete","click"],setup(a,{emit:S}){const m=a,x=S;w(!1);const y=c=>c?new Date(c).toLocaleString("th-TH",{dateStyle:"medium",timeStyle:"short"}):"-",p=G(()=>m.assignment.status===1||m.assignment.is_published?{text:"เผยแพร่",color:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",icon:"fluent:checkmark-circle-16-filled"}:{text:"ร่าง",color:"bg-gray-100 text-gray-700 dark:bg-gray-700/30 dark:text-gray-400",icon:"fluent:drafts-16-regular"}),t=G(()=>m.assignment.due_date?new Date(m.assignment.due_date)<new Date:!1),h=G(()=>m.assignment.answer_status==="submitted"||m.assignment.answer_status==="graded"),v=w(!1),_=()=>{v.value=!v.value};return(c,f)=>(o(),g("article",re,[e("div",ne,[e("div",oe,[f[5]||(f[5]=e("div",{class:"absolute inset-0 bg-black/10"},null,-1)),e("div",le,[d(l(u),{icon:"fluent:clipboard-task-24-filled",class:"w-16 h-16 text-white/20 animate-pulse"})])]),e("div",ie,[e("span",{class:L(["inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-bold shadow-lg backdrop-blur-md bg-white/90 dark:bg-gray-900/80 ring-1 ring-white/20 transition-transform hover:scale-105",p.value.color])},[d(l(u),{icon:p.value.icon,class:"w-3.5 h-3.5"},null,8,["icon"]),j(" "+D(p.value.text),1)],2),a.assignment.points?(o(),g("span",de,[d(l(u),{icon:"fluent:star-20-filled",class:"w-3.5 h-3.5"}),j(" "+D(a.assignment.points)+" คะแนน ",1)])):$("",!0)]),a.isCourseAdmin?(o(),g("div",ue,[e("button",{onClick:f[0]||(f[0]=H(A=>x("edit",a.assignment),["stop"])),class:"p-2 bg-white/90 dark:bg-gray-800/90 rounded-lg hover:bg-white dark:hover:bg-gray-800 text-blue-600 shadow-lg backdrop-blur hover:scale-105 transition-all",title:"แก้ไข"},[d(l(u),{icon:"fluent:edit-24-regular",class:"w-5 h-5"})]),e("button",{onClick:f[1]||(f[1]=H(A=>x("delete",a.assignment.id),["stop"])),class:"p-2 bg-white/90 dark:bg-gray-800/90 rounded-lg hover:bg-white dark:hover:bg-gray-800 text-red-600 shadow-lg backdrop-blur hover:scale-105 transition-all",title:"ลบ"},[d(l(u),{icon:"fluent:delete-24-regular",class:"w-5 h-5"})])])):$("",!0)]),e("div",ge,[e("div",ce,[e("button",{onClick:f[2]||(f[2]=A=>x("click",a.assignment)),class:"text-left w-full group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors"},[e("h2",me,D(a.assignment.title||a.assignment.name),1)]),e("div",be,[a.assignment.due_date?(o(),g("div",{key:0,class:L(["flex items-center gap-1.5",t.value?"text-red-500 font-medium":""])},[d(l(u),{icon:"fluent:calendar-clock-24-regular",class:"w-4 h-4"}),e("span",null,"กำหนดส่ง: "+D(y(a.assignment.due_date)),1),t.value?(o(),g("span",ve,"เกินกำหนด")):$("",!0)],2)):$("",!0)])]),a.assignment.description?(o(),g("div",fe,[d(te,{content:a.assignment.description},null,8,["content"])])):$("",!0),e("div",pe,[a.assignment.answer_status!==void 0?(o(),g("div",ye,[f[6]||(f[6]=e("span",{class:"text-sm font-medium text-gray-500"},"สถานะ:",-1)),e("span",{class:L(["px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1.5",a.assignment.answer_status==="submitted"||a.assignment.answer_status==="graded"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-orange-50 text-orange-500 border-orange-100"])},[d(l(u),{icon:a.assignment.answer_status==="submitted"||a.assignment.answer_status==="graded"?"fluent:checkmark-circle-16-filled":"fluent:circle-16-regular"},null,8,["icon"]),j(" "+D(a.assignment.answer_status==="submitted"||a.assignment.answer_status==="graded"?"ส่งแล้ว":"ยังไม่ส่ง"),1)],2)])):(o(),g("div",xe)),e("button",{onClick:f[3]||(f[3]=H(A=>a.isCourseAdmin?_():x("click",a.assignment),["stop"])),class:"flex items-center gap-2 px-5 py-2.5 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors shadow-md hover:shadow-lg font-medium text-sm"},[a.isCourseAdmin?(o(),g("span",ke,D(v.value?"ซ่อนคำตอบ":"ตรวจคำตอบ / ดูรายชื่อ"),1)):h.value?(o(),g("span",he,"ดูรายละเอียด / แก้ไข")):(o(),g("span",we,"ดูรายละเอียด")),a.isCourseAdmin?(o(),T(l(u),{key:3,icon:v.value?"fluent:chevron-up-24-filled":"fluent:chevron-down-24-filled",class:"w-4 h-4 ml-1"},null,8,["icon"])):(o(),T(l(u),{key:4,icon:"fluent:arrow-right-24-filled",class:"w-4 h-4"}))])]),a.isCourseAdmin&&v.value?(o(),g("div",$e,[d(Y,{assignment:a.assignment,courseId:a.courseId},null,8,["assignment","courseId"])])):$("",!0),!a.isCourseAdmin&&!h.value?(o(),g("div",Ce,[d(q,{assignment:a.assignment,courseId:a.courseId,onSubmitted:f[4]||(f[4]=A=>x("click",a.assignment))},null,8,["assignment","courseId"])])):$("",!0)])]))}}),Ae={key:0,class:"toolbar bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-t-xl p-2 flex flex-wrap gap-1"},Ie={class:"flex gap-1 border-r border-gray-300 dark:border-gray-600 pr-2"},De={class:"flex gap-1 border-r border-gray-300 dark:border-gray-600 pr-2"},Le={class:"flex gap-1 border-r border-gray-300 dark:border-gray-600 pr-2"},Te={class:"flex gap-1 border-r border-gray-300 dark:border-gray-600 pr-2"},Be={class:"flex gap-1"},je={class:"flex gap-1 ml-auto"},Me=["data-placeholder"],Fe=M({__name:"RichTextEditor",props:{modelValue:{},placeholder:{default:"เริ่มเขียนเนื้อหา..."},disabled:{type:Boolean,default:!1},class:{default:""}},emits:["update:modelValue"],setup(a,{emit:S}){const m=a,x=S,y=w(),p=w(m.modelValue||""),t=w(!1),h=w(!1),v=w(!1);U(()=>m.modelValue,k=>{k!==p.value&&y.value&&(p.value=k||"",y.value.innerHTML=p.value)}),N(()=>{y.value&&(y.value.innerHTML=p.value)});const _=()=>{y.value&&(p.value=y.value.innerHTML,x("update:modelValue",p.value))},c=(k,n=void 0)=>{document.execCommand(k,!1,n),y.value?.focus(),f()},f=()=>{t.value=document.queryCommandState("bold"),h.value=document.queryCommandState("italic"),v.value=document.queryCommandState("underline")},A=()=>{f()};return N(()=>{document.addEventListener("selectionchange",A)}),K(()=>{document.removeEventListener("selectionchange",A)}),(k,n)=>(o(),g("div",{class:L(["rich-text-editor",m.class])},[a.disabled?$("",!0):(o(),g("div",Ae,[e("div",Ie,[e("button",{type:"button",onClick:n[0]||(n[0]=b=>c("bold")),class:L(["toolbar-btn",t.value&&"active"]),title:"Bold (Ctrl+B)"},[d(l(u),{icon:"fluent:text-bold-24-regular",class:"w-4 h-4"})],2),e("button",{type:"button",onClick:n[1]||(n[1]=b=>c("italic")),class:L(["toolbar-btn",h.value&&"active"]),title:"Italic (Ctrl+I)"},[d(l(u),{icon:"fluent:text-italic-24-regular",class:"w-4 h-4"})],2),e("button",{type:"button",onClick:n[2]||(n[2]=b=>c("underline")),class:L(["toolbar-btn",v.value&&"active"]),title:"Underline (Ctrl+U)"},[d(l(u),{icon:"fluent:text-underline-24-regular",class:"w-4 h-4"})],2),e("button",{type:"button",onClick:n[3]||(n[3]=b=>c("strikeThrough")),class:"toolbar-btn",title:"Strikethrough"},[d(l(u),{icon:"fluent:text-strikethrough-24-regular",class:"w-4 h-4"})])]),e("div",De,[e("button",{type:"button",onClick:n[4]||(n[4]=b=>c("formatBlock","h1")),class:"toolbar-btn",title:"Heading 1"}," H1 "),e("button",{type:"button",onClick:n[5]||(n[5]=b=>c("formatBlock","h2")),class:"toolbar-btn",title:"Heading 2"}," H2 "),e("button",{type:"button",onClick:n[6]||(n[6]=b=>c("formatBlock","h3")),class:"toolbar-btn",title:"Heading 3"}," H3 "),e("button",{type:"button",onClick:n[7]||(n[7]=b=>c("formatBlock","p")),class:"toolbar-btn",title:"Paragraph"}," P ")]),e("div",Le,[e("button",{type:"button",onClick:n[8]||(n[8]=b=>c("insertUnorderedList")),class:"toolbar-btn",title:"Bullet List"},[d(l(u),{icon:"fluent:text-bullet-list-24-regular",class:"w-4 h-4"})]),e("button",{type:"button",onClick:n[9]||(n[9]=b=>c("insertOrderedList")),class:"toolbar-btn",title:"Numbered List"},[d(l(u),{icon:"fluent:text-number-list-ltr-24-regular",class:"w-4 h-4"})])]),e("div",Te,[e("button",{type:"button",onClick:n[10]||(n[10]=b=>c("justifyLeft")),class:"toolbar-btn",title:"Align Left"},[d(l(u),{icon:"fluent:text-align-left-24-regular",class:"w-4 h-4"})]),e("button",{type:"button",onClick:n[11]||(n[11]=b=>c("justifyCenter")),class:"toolbar-btn",title:"Align Center"},[d(l(u),{icon:"fluent:text-align-center-24-regular",class:"w-4 h-4"})]),e("button",{type:"button",onClick:n[12]||(n[12]=b=>c("justifyRight")),class:"toolbar-btn",title:"Align Right"},[d(l(u),{icon:"fluent:text-align-right-24-regular",class:"w-4 h-4"})])]),e("div",Be,[e("button",{type:"button",onClick:n[13]||(n[13]=b=>c("createLink",k.prompt("Enter URL:")||void 0)),class:"toolbar-btn",title:"Insert Link"},[d(l(u),{icon:"fluent:link-24-regular",class:"w-4 h-4"})]),e("button",{type:"button",onClick:n[14]||(n[14]=b=>c("unlink")),class:"toolbar-btn",title:"Remove Link"},[d(l(u),{icon:"fluent:link-dismiss-24-regular",class:"w-4 h-4"})])]),e("div",je,[e("button",{type:"button",onClick:n[15]||(n[15]=b=>c("removeFormat")),class:"toolbar-btn",title:"Clear Formatting"},[d(l(u),{icon:"fluent:text-clear-formatting-24-regular",class:"w-4 h-4"})])])])),e("div",{ref_key:"editorRef",ref:y,contenteditable:"true",onInput:_,class:L(["editor-content","min-h-[300px] max-h-[600px] overflow-y-auto","p-4 bg-white dark:bg-gray-900","border border-gray-300 dark:border-gray-600",a.disabled?"rounded-xl":"rounded-b-xl border-t-0","focus:outline-none focus:ring-2 focus:ring-blue-500","prose prose-lg dark:prose-invert max-w-none"]),"data-placeholder":a.placeholder},null,42,Me)],2))}}),Ue=z(Fe,[["__scopeId","data-v-4177e530"]]),Ve={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},Ee={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},Ge={class:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 z-10"},He={class:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2"},Re={class:"p-6 space-y-6"},Ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Pe={class:"col-span-1 md:col-span-2"},Oe={class:"grid grid-cols-2 gap-4"},ze={class:"relative"},qe={class:"relative"},Ye=["max"],Je={class:"relative"},Ke={key:0},Qe={class:"flex flex-wrap gap-3"},We=["onClick"],Xe={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Ze=["src"],et=["onClick"],tt=["src"],st={class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},at=["onClick"],rt={class:"aspect-video flex flex-col items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:border-green-500 hover:text-green-500 transition-colors bg-gray-50 dark:bg-gray-700/50 hover:bg-green-50 dark:hover:bg-green-900/10"},nt={class:"p-6 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl sticky bottom-0 z-10"},ot=["disabled"],lt={key:1},it=M({__name:"CourseAssignmentFormModal",props:{show:{type:Boolean},courseId:{},assignment:{},availableGroups:{}},emits:["close","submit"],setup(a,{emit:S}){const m=a,x=S,y=P(),p=se(),t=w({title:"",description:"",points:10,passing_score:0,start_date:"",due_date:"",status:"1",target_groups:[],images:[],existingImages:[]}),h=w(!1),v=w([]),_=()=>{const r=new Date,s=r.getFullYear(),C=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0"),I=String(r.getHours()).padStart(2,"0"),B=String(r.getMinutes()).padStart(2,"0");return`${s}-${C}-${i}T${I}:${B}`},c=()=>{const r=new Date;r.setDate(r.getDate()+1);const s=r.getFullYear(),C=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0"),I=String(r.getHours()).padStart(2,"0"),B=String(r.getMinutes()).padStart(2,"0");return`${s}-${C}-${i}T${I}:${B}`},f=()=>{t.value={title:"",description:"",points:10,passing_score:5,start_date:_(),due_date:c(),status:"1",target_groups:[],images:[],existingImages:[]},v.value=[]};U(()=>m.assignment,r=>{r?t.value={title:r.title,description:r.description||"",points:r.points||10,passing_score:r.passing_score||0,start_date:r.start_date?new Date(r.start_date):"",due_date:r.due_date?new Date(r.due_date):"",status:String(r.status??"1"),target_groups:r.target_groups||[],images:[],existingImages:r.images||[]}:f()},{immediate:!0}),U(()=>t.value.points,r=>{m.assignment||(t.value.passing_score=Math.floor(r/2))});const A=r=>{const s=r.target;if(s.files){const C=Array.from(s.files);t.value.images=[...t.value.images,...C],C.forEach(i=>{const I=new FileReader;I.onload=B=>{B.target?.result&&v.value.push(B.target.result)},I.readAsDataURL(i)})}},k=r=>{t.value.images.splice(r,1),v.value.splice(r,1)},n=r=>{t.value.existingImages=t.value.existingImages.filter(s=>s.id!==r)},b=r=>{const s=t.value.target_groups.indexOf(r);s===-1?t.value.target_groups.push(r):t.value.target_groups.splice(s,1)},J=async()=>{if(!t.value.title){p.toast("กรุณาระบุหัวข้อแบบฝึกหัด","warning");return}h.value=!0;try{const r=new FormData;r.append("title",t.value.title),t.value.description&&r.append("description",t.value.description),r.append("points",t.value.points.toString()),r.append("passing_score",t.value.passing_score.toString()),r.append("status",t.value.status.toString()),t.value.start_date&&r.append("start_date",new Date(t.value.start_date).toISOString()),t.value.due_date&&r.append("due_date",new Date(t.value.due_date).toISOString()),t.value.target_groups&&t.value.target_groups.length>0&&t.value.target_groups.forEach((C,i)=>{r.append(`target_groups[${i}]`,C.toString())}),t.value.images.forEach(C=>{r.append("images[]",C)});let s;m.assignment?(r.append("_method","PUT"),s=await y.post(`/api/courses/${m.courseId}/assignments/${m.assignment.id}`,r)):s=await y.post(`/api/courses/${m.courseId}/assignments`,r),s.assignment&&(x("submit",s.assignment),p.toast(m.assignment?"แก้ไขแบบฝึกหัดสำเร็จ":"สร้างแบบฝึกหัดสำเร็จ","success"),x("close"))}catch(r){console.error("Failed to save assignment:",r),p.error(r?.data?.message||"ไม่สามารถบันทึกข้อมูลได้")}finally{h.value=!1}};return U(()=>m.show,r=>{r&&!m.assignment&&f()}),(r,s)=>{const C=Z("VueDatePicker");return o(),T(Q,{name:"fade"},{default:W(()=>[a.show?(o(),g("div",Ve,[e("div",Ee,[e("div",Ge,[e("h3",He,[d(l(u),{icon:"fluent:clipboard-task-edit-24-filled",class:"text-green-600"}),j(" "+D(a.assignment?"แก้ไขแบบฝึกหัด":"สร้างแบบฝึกหัดใหม่"),1)]),e("button",{onClick:s[0]||(s[0]=i=>x("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors"},[d(l(u),{icon:"fluent:dismiss-24-regular",class:"w-6 h-6 text-gray-500"})])]),e("div",Re,[e("div",Ne,[e("div",Pe,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[j(" หัวข้อแบบฝึกหัด "),e("span",{class:"text-red-500"},"*")],-1)),F(e("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>t.value.title=i),type:"text",class:"w-full px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all",placeholder:"Ex. แบบฝึกหัดทบทวนบทที่ 1"},null,512),[[R,t.value.title]])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," สถานะ ",-1)),F(e("select",{"onUpdate:modelValue":s[2]||(s[2]=i=>t.value.status=i),class:"w-full px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all appearance-none"},[...s[10]||(s[10]=[e("option",{value:"1"},"เผยแพร่ (Published)",-1),e("option",{value:"0"},"ฉบับร่าง (Draft)",-1)])],512),[[X,t.value.status]])]),e("div",Oe,[e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," คะแนนเต็ม ",-1)),e("div",ze,[F(e("input",{"onUpdate:modelValue":s[3]||(s[3]=i=>t.value.points=i),type:"number",min:"0",class:"w-full px-4 py-2 pl-10 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all"},null,512),[[R,t.value.points]]),d(l(u),{icon:"fluent:star-24-regular",class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," เกณฑ์ผ่าน ",-1)),e("div",qe,[F(e("input",{"onUpdate:modelValue":s[4]||(s[4]=i=>t.value.passing_score=i),type:"number",min:"0",max:t.value.points,class:"w-full px-4 py-2 pl-10 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all"},null,8,Ye),[[R,t.value.passing_score]]),d(l(u),{icon:"fluent:checkmark-circle-24-regular",class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})])])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," วันที่เริ่มต้น (Start Date) ",-1)),e("div",Je,[d(C,{modelValue:t.value.start_date,"onUpdate:modelValue":s[5]||(s[5]=i=>t.value.start_date=i),"auto-apply":"","enable-time-picker":!0,dark:!0},null,8,["modelValue"])])]),e("div",null,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," กำหนดส่ง (Due Date) ",-1)),d(C,{modelValue:t.value.due_date,"onUpdate:modelValue":s[6]||(s[6]=i=>t.value.due_date=i),"auto-apply":"","enable-time-picker":!0,dark:!0},null,8,["modelValue"])])]),e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," คำอธิบาย / โจทย์ ",-1)),d(Ue,{modelValue:t.value.description,"onUpdate:modelValue":s[7]||(s[7]=i=>t.value.description=i),placeholder:"ระบุรายละเอียดของงาน...",class:"min-h-[200px]"},null,8,["modelValue"])]),a.availableGroups&&a.availableGroups.length>0?(o(),g("div",Ke,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," มอบหมายให้กลุ่มเรียน (Target Groups) ",-1)),e("div",Qe,[(o(!0),g(V,null,E(a.availableGroups,i=>(o(),g("button",{key:i.id,type:"button",onClick:I=>b(i.id),class:L(["flex items-center gap-2 px-4 py-2 rounded-lg border transition-all duration-200",[t.value.target_groups.includes(i.id)?"bg-green-50 border-green-500 text-green-700 dark:bg-green-900/30 dark:border-green-500 dark:text-green-400":"bg-gray-50 border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-500"]])},[e("div",{class:L(["w-5 h-5 rounded border flex items-center justify-center transition-colors",[t.value.target_groups.includes(i.id)?"bg-green-500 border-green-500":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-500"]])},[t.value.target_groups.includes(i.id)?(o(),T(l(u),{key:0,icon:"fluent:checkmark-12-filled",class:"w-3 h-3 text-white"})):$("",!0)],2),e("span",null,D(i.name),1)],10,We))),128))]),s[18]||(s[18]=e("p",{class:"text-xs text-gray-500 mt-2"},"* หากไม่เลือกกลุ่มเรียนใดๆ งานจะถูกมอบหมายให้นักเรียนทุกคนในรายวิชา",-1))])):$("",!0),e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," รูปภาพประกอบ ",-1)),e("div",Xe,[(o(!0),g(V,null,E(t.value.existingImages,i=>(o(),g("div",{key:i.id,class:"relative group aspect-video bg-gray-100 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},[e("img",{src:i.full_url||i.image_url,class:"w-full h-full object-cover"},null,8,Ze),e("button",{onClick:I=>n(i.id),class:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600"},[d(l(u),{icon:"fluent:delete-16-filled",class:"w-4 h-4"})],8,et)]))),128)),(o(!0),g(V,null,E(v.value,(i,I)=>(o(),g("div",{key:I,class:"relative group aspect-video bg-gray-100 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},[e("img",{src:i,class:"w-full h-full object-cover"},null,8,tt),e("div",st,[e("button",{onClick:B=>k(I),class:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"},[d(l(u),{icon:"fluent:delete-20-filled",class:"w-5 h-5"})],8,at)])]))),128)),e("label",rt,[d(l(u),{icon:"fluent:image-add-24-regular",class:"w-8 h-8 mb-2"}),s[19]||(s[19]=e("span",{class:"text-xs font-medium"},"เพิ่มรูปภาพ",-1)),e("input",{type:"file",multiple:"",accept:"image/*",class:"hidden",onChange:A},null,32)])])])]),e("div",nt,[e("button",{onClick:s[8]||(s[8]=i=>x("close")),class:"px-5 py-2.5 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl transition-colors"}," ยกเลิก "),e("button",{onClick:J,disabled:h.value,class:"px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-medium rounded-xl shadow-lg shadow-green-500/30 hover:shadow-green-500/40 hover:from-green-600 hover:to-emerald-700 active:scale-[0.98] transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[h.value?(o(),T(l(u),{key:0,icon:"eos-icons:loading",class:"w-5 h-5"})):(o(),g("span",lt,D(a.assignment?"บันทึกการแก้ไข":"สร้างแบบฝึกหัด"),1))],8,ot)])])])):$("",!0)]),_:1})}}}),dt=z(it,[["__scopeId","data-v-a24a25fe"]]),ut={class:"space-y-4"},gt={key:0,class:"bg-gradient-to-r from-violet-600 via-indigo-600 to-cyan-600 dark:from-violet-900 dark:via-indigo-900 dark:to-cyan-900 rounded-2xl p-6 shadow-xl mb-6 text-white"},ct={class:"flex items-center justify-between"},mt={class:"flex items-center gap-4"},bt={class:"w-14 h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg"},vt={class:"text-white/80 text-sm"},ft={key:1,class:"space-y-3"},pt={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12 text-center border border-gray-100 dark:border-gray-700"},yt={class:"w-24 h-24 bg-gray-50 dark:bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-6"},xt={class:"text-gray-500 dark:text-gray-400 mb-8 max-w-xs mx-auto"},kt=M({__name:"AssignmentsList",props:{assignments:{default:()=>[]},isCourseAdmin:{type:Boolean,default:!1},courseId:{},availableGroups:{default:()=>[]}},emits:["refresh"],setup(a,{emit:S}){const m=a,x=S,y=P(),p=w(!1),t=w(!1),h=w(null),v=(k=null)=>{h.value=k,t.value=!0},_=()=>{x("refresh"),t.value=!1},c=k=>{ee(`/courses/${m.courseId}/assignments/${k.id}`)},f=k=>{v(k)},A=async k=>{if(confirm("ยืนยันการลบภาระงานนี้หรือไม่?")){p.value=!0;try{await y.delete(`/api/courses/${m.courseId}/assignments/${k}`)&&x("refresh")}catch(n){alert(n.data?.msg||"ไม่สามารถลบภาระงานได้")}finally{p.value=!1}}};return(k,n)=>(o(),g("div",ut,[a.isCourseAdmin?(o(),g("div",gt,[e("div",ct,[e("div",mt,[e("div",bt,[d(l(u),{icon:"material-symbols:assignment-outline",class:"w-7 h-7 text-white"})]),e("div",null,[n[3]||(n[3]=e("h2",{class:"text-2xl font-bold mb-1"},"ภาระงานทั้งหมด",-1)),e("p",vt,D(a.assignments.length)+" งาน",1)])]),a.isCourseAdmin?(o(),g("button",{key:0,onClick:n[0]||(n[0]=b=>v(null)),class:"flex items-center gap-2 px-5 py-3 bg-white/10 text-white rounded-xl hover:bg-white/20 border border-white/20 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 font-bold backdrop-blur-sm"},[d(l(u),{icon:"fluent:add-circle-24-filled",class:"w-5 h-5"}),n[4]||(n[4]=e("span",null,"สร้างงานใหม่",-1))])):$("",!0)])])):$("",!0),a.assignments.length>0?(o(),g("div",ft,[(o(!0),g(V,null,E(a.assignments,b=>(o(),T(_e,{key:b.id,assignment:b,"course-id":a.courseId,"is-course-admin":a.isCourseAdmin,onClick:c,onEdit:f,onDelete:A},null,8,["assignment","course-id","is-course-admin"]))),128))])):(o(),g("div",pt,[e("div",yt,[d(l(u),{icon:"fluent:clipboard-task-24-regular",class:"w-12 h-12 text-gray-400"})]),n[6]||(n[6]=e("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"ยังไม่มีภาระงาน",-1)),e("p",xt,D(a.isCourseAdmin?"เริ่มต้นสร้างภาระงานให้นักเรียนของคุณ":"อาจารย์ยังไม่ได้มอบหมายงานในขณะนี้"),1),a.isCourseAdmin?(o(),g("button",{key:0,onClick:n[1]||(n[1]=b=>v(null)),class:"inline-flex items-center gap-2 px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all shadow-lg hover:shadow-orange-500/30 font-semibold"},[d(l(u),{icon:"fluent:add-24-filled",class:"w-5 h-5"}),n[5]||(n[5]=j(" สร้างภาระงานแรก ",-1))])):$("",!0)])),d(dt,{show:t.value,assignment:h.value,"course-id":a.courseId,"available-groups":a.availableGroups,onClose:n[2]||(n[2]=b=>t.value=!1),onSubmit:_},null,8,["show","assignment","course-id","available-groups"])]))}}),It=M({__name:"index",setup(a){const S=O("course"),m=O("isCourseAdmin"),x=P(),y=w([]),p=w([]),t=w(!0),h=async()=>{if(S.value?.id){t.value=!0;try{const v=S.value.id,_=await x.get(`/api/courses/${v}/assignments`),c=_.assignments||[];y.value=Array.isArray(c)?c:c.data||[],p.value=_.groups||[]}catch(v){console.error("Failed to load assignments:",v)}finally{t.value=!1}}};return N(()=>{h()}),(v,_)=>(o(),g("div",null,[l(t)?(o(),T(ae,{key:0})):(o(),T(kt,{key:1,assignments:l(y),"available-groups":l(p),"course-id":l(S)?.id,"is-course-admin":l(m),onRefresh:h},null,8,["assignments","available-groups","course-id","is-course-admin"]))]))}});export{It as default};
