import{_ as Ae}from"./CehGOp-7.js";import{z as Q,C as De,r as w,a4 as J,N as K,f as oe,g as ne,c as m,o as c,a as e,b as n,q as _,j as H,d as $,u as r,I as i,t as v,a8 as Be,w as O,F as G,n as Y,i as Te,a5 as je,_ as ie,af as de,x as Se,e as T,ab as Me,l as R,y as F,Y as le}from"./DuB962GZ.js";import{C as Ie}from"./DvOU9n0k.js";import{u as Ue}from"./BmpSa16v.js";import{S as P}from"./BQxta0Da.js";import"./CouwXKwP.js";const Ee=["title"],Ve={key:0,class:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-36 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50"},Le={class:"py-1"},Re=["onClick","disabled"],Fe={class:"flex-1 text-left"},Ne=Q({__name:"AttendanceStatusBadge",props:{status:{},attendanceId:{},memberId:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["update-status"],setup(x,{emit:C}){const{$apiFetch:D}=De(),A=x,h=C,f=w(A.status),S=w(!1),B=w(!1),j=w(null);J(()=>A.status,a=>{f.value=a});const U=[{value:1,label:"มา",icon:"heroicons:check-circle",color:"green"},{value:2,label:"สาย",icon:"heroicons:clock",color:"amber"},{value:3,label:"ลา",icon:"heroicons:document-text",color:"blue"},{value:null,label:"ขาด",icon:"heroicons:x-circle",color:"red"}],p=K(()=>{const a=f.value;return a===1?{label:"มา",icon:"heroicons:check-circle-20-solid",color:"green",bgClass:"bg-green-50 dark:bg-green-900/40",textClass:"text-green-800 dark:text-green-200",iconClass:"text-green-600 dark:text-green-400"}:a===2?{label:"สาย",icon:"heroicons:clock-20-solid",color:"amber",bgClass:"bg-amber-50 dark:bg-amber-900/40",textClass:"text-amber-800 dark:text-amber-200",iconClass:"text-amber-600 dark:text-amber-400"}:a===3?{label:"ลา",icon:"heroicons:document-text-20-solid",color:"blue",bgClass:"bg-blue-50 dark:bg-blue-900/40",textClass:"text-blue-800 dark:text-blue-200",iconClass:"text-blue-600 dark:text-blue-400"}:{label:"ขาด",icon:"heroicons:x-circle-20-solid",color:"red",bgClass:"bg-red-50 dark:bg-red-900/40",textClass:"text-red-800 dark:text-red-200",iconClass:"text-red-600 dark:text-red-400"}}),y=()=>{A.isCourseAdmin&&(S.value=!S.value)},d=()=>{S.value=!1},u=async a=>{if(!B.value){if(f.value===a||f.value===null&&a===null){d();return}B.value=!0;try{const l=a===null?0:a;await D(`/api/attendances/${A.attendanceId}/member/${A.memberId}/update-status`,{method:"POST",body:{status:l}}),f.value=a,h("update-status",{attendanceId:A.attendanceId,memberId:A.memberId,status:a})}catch(l){console.error("Failed to update status:",l)}finally{B.value=!1,await je(),d()}}},b=a=>{j.value&&!j.value.contains(a.target)&&d()};return oe(()=>{document.addEventListener("click",b)}),ne(()=>{document.removeEventListener("click",b)}),(a,l)=>(c(),m("div",{ref_key:"menuRef",ref:j,class:"relative inline-flex items-center gap-1"},[e("div",{class:_(["inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-semibold transition-all duration-200 border",p.value.bgClass,p.value.textClass,p.value.color==="green"?"border-green-200 dark:border-green-800":"",p.value.color==="amber"?"border-amber-200 dark:border-amber-800":"",p.value.color==="blue"?"border-blue-200 dark:border-blue-800":"",p.value.color==="red"?"border-red-200 dark:border-red-800":"",x.isCourseAdmin?"cursor-pointer hover:shadow-sm active:scale-95":""]),onClick:y,title:x.isCourseAdmin?"คลิกเพื่อเปลี่ยนสถานะ":p.value.label},[n(r(i),{icon:B.value?"svg-spinners:ring-resize":p.value.icon,class:_(["w-4 h-4",p.value.iconClass])},null,8,["icon","class"]),e("span",null,v(p.value.label),1),x.isCourseAdmin&&!B.value?(c(),H(r(i),{key:0,icon:"heroicons:chevron-down",class:_(["w-3 h-3 ml-0.5 transition-transform duration-200",[{"rotate-180":S.value},p.value.iconClass]])},null,8,["class"])):$("",!0)],10,Ee),n(Be,{"enter-active-class":"transition ease-out duration-150","enter-from-class":"opacity-0 scale-95 -translate-y-1","enter-to-class":"opacity-100 scale-100 translate-y-0","leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100 scale-100 translate-y-0","leave-to-class":"opacity-0 scale-95 -translate-y-1"},{default:O(()=>[S.value&&x.isCourseAdmin?(c(),m("div",Ve,[l[0]||(l[0]=e("div",{class:"px-3 py-2 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600"},[e("p",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide"},"เลือกสถานะ")],-1)),e("div",Le,[(c(),m(G,null,Y(U,g=>e("button",{key:g.value??"null",onClick:Te(E=>u(g.value),["stop"]),disabled:B.value,class:_(["w-full flex items-center gap-2.5 px-3 py-2.5 text-sm font-medium transition-all duration-150 hover:bg-gray-100 dark:hover:bg-gray-700/50",[f.value===g.value||f.value===null&&g.value===null||f.value===void 0&&g.value===null||f.value===0&&g.value===null?`bg-${g.color}-50 dark:bg-${g.color}-900/20 text-${g.color}-700 dark:text-${g.color}-300`:"text-gray-700 dark:text-gray-300"]])},[e("div",{class:_(["w-7 h-7 rounded-full flex items-center justify-center",g.color==="green"?"bg-green-100 dark:bg-green-900/30":"",g.color==="amber"?"bg-amber-100 dark:bg-amber-900/30":"",g.color==="blue"?"bg-blue-100 dark:bg-blue-900/30":"",g.color==="red"?"bg-red-100 dark:bg-red-900/30":""])},[n(r(i),{icon:g.icon,class:_(["w-4 h-4",[g.color==="green"?"text-green-600 dark:text-green-400":"",g.color==="amber"?"text-amber-600 dark:text-amber-400":"",g.color==="blue"?"text-blue-600 dark:text-blue-400":"",g.color==="red"?"text-red-600 dark:text-red-400":""]])},null,8,["icon","class"])],2),e("span",Fe,v(g.label),1),f.value===g.value||f.value===null&&g.value===null||f.value===void 0&&g.value===null||f.value===0&&g.value===null?(c(),H(r(i),{key:0,icon:"heroicons:check",class:_(["w-4 h-4",[g.color==="green"?"text-green-600":"",g.color==="amber"?"text-amber-600":"",g.color==="blue"?"text-blue-600":"",g.color==="red"?"text-red-600":""]])},null,8,["class"])):$("",!0)],10,Re)),64))])])):$("",!0)]),_:1})],512))}}),Oe=ie(Ne,[["__scopeId","data-v-def1b4d7"]]),Pe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ze={class:"relative overflow-x-auto"},He={class:"w-full"},Ge={class:"bg-gradient-to-r from-gray-50 via-gray-100 to-slate-100 dark:from-gray-700 dark:via-gray-800 dark:to-gray-700 border-b-2 border-gray-200 dark:border-gray-600"},qe={class:"text-center"},Ye={scope:"col",class:"px-6 py-4 border border-slate-300 dark:border-gray-600 font-black text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 min-w-[280px] sticky left-0 z-20"},We={class:"flex items-center justify-center gap-3"},Je={class:"w-10 h-10 bg-gradient-to-br from-violet-100 to-purple-100 dark:from-violet-900 dark:to-purple-900 rounded-xl flex items-center justify-center shadow-sm"},Ke=["onClick"],Qe={class:"text-xs text-gray-500 dark:text-gray-400"},Xe={class:"mt-1"},Ze={key:0,scope:"col",class:"px-3 py-4 border bg-white dark:bg-gray-800 sticky right-0 z-20"},et={class:"bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700"},tt={class:"p-2 border border-slate-300 dark:border-gray-600 whitespace-nowrap sticky left-0 z-10 bg-white dark:bg-gray-800"},rt={class:"flex items-center min-w-fit group"},st={class:"relative"},at=["src","alt"],lt={class:"ml-3 flex-1"},ot={class:"text-gray-900 dark:text-gray-100 font-bold text-md tracking-wide group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors duration-200"},nt={class:"flex items-center mt-1 space-x-2 text-xs"},it={key:0,class:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-violet-100 to-purple-100 dark:from-violet-900/50 dark:to-purple-900/50 text-violet-700 dark:text-violet-300 rounded-full font-medium border border-violet-200 dark:border-violet-700"},dt={key:1,class:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 text-blue-700 dark:text-blue-300 rounded-full font-medium border border-blue-200 dark:border-blue-700"},ut={class:"flex justify-center items-center"},ct={key:0},gt=["colspan"],bt={class:"flex flex-col items-center justify-center"},mt=Q({__name:"AttendancesTable",props:{attendances:{},groupMembers:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["create","view-details","edit","delete","update-status"],setup(x,{emit:C}){const{getAvatarUrl:D}=Ue(),A=x,h=C,f=p=>p?new Date(p).toLocaleDateString("th-TH",{day:"numeric",month:"short"}):"",S=K(()=>[...A.attendances].sort((p,y)=>{const d=new Date(p.date||p.start_at||p.created_at).getTime(),u=new Date(y.date||y.start_at||y.created_at).getTime();return d-u})),B=(p,y)=>p.details?.find(u=>u.course_member_id===y)?.status,j=p=>D(p.user||p),U=p=>{const y=p.target,d=y.alt||"User";y.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(d)}&color=7F9CF5&background=EBF4FF`};return(p,y)=>(c(),m("div",Pe,[e("div",ze,[e("table",He,[e("thead",Ge,[e("tr",qe,[e("th",Ye,[e("div",We,[e("div",Je,[n(r(i),{icon:"fluent:people-24-filled",class:"w-5 h-5 text-violet-600 dark:text-violet-400"})]),y[2]||(y[2]=e("span",{class:"uppercase tracking-wide"},"สมาชิก",-1))])]),(c(!0),m(G,null,Y(r(S),(d,u)=>(c(),m("th",{scope:"col",key:d.id,class:"px-3 py-4 border border-slate-300 dark:border-gray-600 min-w-[100px]"},[e("button",{onClick:b=>h("view-details",d),class:"flex flex-col justify-center items-center mx-auto text-sm font-bold text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-xl px-3 py-2 transition-all duration-300 transform hover:scale-105 shadow-sm hover:shadow-md"},[e("span",Qe,"#"+v(u+1),1),e("span",Xe,v(f(d.date)),1),n(r(i),{icon:"fluent:eye-24-regular",width:"16",height:"16",class:"mt-1"})],8,Ke)]))),128)),x.isCourseAdmin?(c(),m("th",Ze,[e("button",{onClick:y[0]||(y[0]=d=>h("create")),class:"flex justify-center items-center mx-auto text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-xl p-3 transition-all duration-300 transform hover:scale-105 shadow-sm hover:shadow-md",title:"เพิ่มการเช็คชื่อใหม่"},[n(r(i),{icon:"fluent:add-circle-24-filled",width:"24",height:"24"})])])):$("",!0)])]),e("tbody",et,[(c(!0),m(G,null,Y(x.groupMembers,d=>(c(),m("tr",{key:d.id,class:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200"},[e("td",tt,[e("div",rt,[e("div",st,[e("img",{class:"w-14 h-14 rounded-full border-2 border-white dark:border-gray-700 shadow-md transition-all duration-300 group-hover:scale-105 group-hover:shadow-lg object-cover",src:j(d),alt:d.user?.name||d.name||"Avatar",onError:U},null,40,at),y[3]||(y[3]=e("div",{class:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"},null,-1))]),e("div",lt,[e("p",ot,v(d.name||d.member_name||d.user?.name||"ไม่มีชื่อ"),1),e("div",nt,[d.order_number?(c(),m("span",it,[n(r(i),{icon:"fluent:number-symbol-square-20-regular",width:"14",height:"14"}),e("span",null,v(d.order_number),1)])):$("",!0),d.group?(c(),m("span",dt,[n(r(i),{icon:"fluent:people-team-20-regular",width:"14",height:"14"}),e("span",null,v(d.group.name),1)])):$("",!0)])])])]),(c(!0),m(G,null,Y(r(S),u=>(c(),m("td",{key:u.id,class:"p-3 whitespace-nowrap border border-slate-300 dark:border-gray-600 text-center"},[e("div",ut,[n(Oe,{status:B(u,d.id),attendanceId:u.id,memberId:d.id,isCourseAdmin:x.isCourseAdmin,onUpdateStatus:y[1]||(y[1]=b=>h("update-status",b))},null,8,["status","attendanceId","memberId","isCourseAdmin"])])]))),128))]))),128)),x.groupMembers.length===0?(c(),m("tr",ct,[e("td",{colspan:x.attendances.length+(x.isCourseAdmin?2:1),class:"p-12 text-center"},[e("div",bt,[n(r(i),{icon:"fluent:people-24-regular",class:"w-16 h-16 text-gray-400 dark:text-gray-600 mb-4"}),y[4]||(y[4]=e("p",{class:"text-gray-500 dark:text-gray-400 font-medium"},"ไม่มีสมาชิกในกลุ่มนี้",-1))])],8,gt)])):$("",!0)])])])]))}}),ft={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},xt={class:"bg-gradient-to-r from-violet-500 via-purple-500 to-fuchsia-500 px-6 py-4"},pt={class:"flex items-center justify-between"},yt={class:"flex items-center gap-3"},vt={class:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center"},ht={class:"text-white text-lg font-bold"},kt=["disabled"],wt={class:"overflow-x-auto"},_t={class:"w-full"},$t={class:"bg-gradient-to-r from-violet-50 via-purple-50 to-fuchsia-50 dark:from-violet-900/30 dark:via-purple-900/30 dark:to-fuchsia-900/30"},Ct={class:"px-4 py-4 text-center"},At={class:"flex items-center justify-center gap-2"},Dt={class:"w-8 h-8 bg-violet-100 dark:bg-violet-800 rounded-lg flex items-center justify-center"},Bt={class:"px-4 py-4 text-center"},Tt={class:"flex items-center justify-center gap-2"},jt={class:"w-8 h-8 bg-purple-100 dark:bg-purple-800 rounded-lg flex items-center justify-center"},St={class:"px-4 py-4 text-center"},Mt={class:"flex items-center justify-center gap-2"},It={class:"w-8 h-8 bg-cyan-100 dark:bg-cyan-800 rounded-lg flex items-center justify-center"},Ut={class:"px-4 py-4 text-center"},Et={class:"flex items-center justify-center gap-2"},Vt={class:"w-8 h-8 bg-pink-100 dark:bg-pink-800 rounded-lg flex items-center justify-center"},Lt={class:"px-4 py-4 text-center"},Rt={class:"flex items-center justify-center gap-2"},Ft={class:"w-8 h-8 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center"},Nt={class:"px-4 py-4 text-center"},Ot={class:"flex items-center justify-center gap-2"},Pt={class:"w-8 h-8 bg-emerald-100 dark:bg-emerald-800 rounded-lg flex items-center justify-center"},zt={class:"divide-y divide-gray-100 dark:divide-gray-700"},Ht={class:"px-4 py-4 text-center"},Gt={class:"inline-flex items-center justify-center w-8 h-8 bg-violet-100 dark:bg-violet-800 text-violet-700 dark:text-violet-300 rounded-lg font-bold text-sm"},qt={class:"px-4 py-4 text-center"},Yt={class:"flex flex-col items-center"},Wt={class:"font-semibold text-gray-900 dark:text-white"},Jt={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Kt={class:"px-4 py-4 text-center"},Qt={class:"inline-flex items-center gap-2 px-3 py-1.5 bg-cyan-50 dark:bg-cyan-900/30 rounded-lg"},Xt={class:"font-semibold text-cyan-700 dark:text-cyan-300"},Zt={class:"px-4 py-4 text-center"},er={class:"inline-flex items-center gap-2 px-3 py-1.5 bg-pink-50 dark:bg-pink-900/30 rounded-lg"},tr={class:"font-semibold text-pink-700 dark:text-pink-300"},rr={class:"px-4 py-4 text-center"},sr={class:"text-gray-600 dark:text-gray-400"},ar={class:"px-4 py-4 text-center"},lr=["onClick","disabled"],or={key:2,class:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-700"},nr={key:0,class:"py-12 text-center"},ir={class:"w-24 h-24 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-2xl flex items-center justify-center"},dr={key:1,class:"divide-y divide-gray-100 dark:divide-gray-700"},ur=Q({__name:"StudentAttendanceTable",props:{attendances:{},loading:{type:Boolean,default:!1}},emits:["reload","check-in-success"],setup(x,{emit:C}){const D=C,A=de(),h=w(null),f=b=>{const a=new Date,l=new Date(b.start_at),g=new Date(b.finish_at);return a>=l&&a<=g},S=b=>{const a=new Date,l=new Date(b.start_at);return a<l},B=b=>b.status===1||b.status===2,j=b=>{const a=new Date,l=new Date(b.start_at),g=b.late_time||15,E=new Date(l.getTime()+g*6e4);return a>E},U=async b=>{if(!h.value){h.value=b.id;try{const a=await A.post(`/api/attendances/${b.id}/check-in`),l=a.status===1?"มา (ตรงเวลา)":"มา (สาย)",g=a.status===1?"#10b981":"#f59e0b";await P.fire({icon:"success",title:"รายงานตัวสำเร็จ!",html:`
        <div class="text-center">
          <p class="text-lg font-semibold" style="color: ${g}">${l}</p>
          <p class="text-gray-500 mt-2">เวลาเข้าเรียน: ${a.time_in}</p>
        </div>
      `,confirmButtonColor:"#8b5cf6",confirmButtonText:"ตกลง",timer:3e3,timerProgressBar:!0}),D("check-in-success",{attendanceId:b.id,status:a.status}),D("reload")}catch(a){const l=a.response?.data?.message||"เกิดข้อผิดพลาด กรุณาลองใหม่";P.fire({icon:"error",title:"ไม่สามารถรายงานตัวได้",text:l,confirmButtonColor:"#8b5cf6",confirmButtonText:"ตกลง"})}finally{h.value=null}}},p=b=>{if(!b)return"-";const a=new Date(b),l=a.getDate(),g=a.getMonth()+1,E=a.getFullYear()+543;return`${String(l).padStart(2,"0")}/${String(g).padStart(2,"0")}/${E}`},y=b=>{if(!b)return"";const a=new Date(b);return["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"][a.getDay()]},d=b=>{if(!b)return"-";const a=new Date(b),l=String(a.getHours()).padStart(2,"0"),g=String(a.getMinutes()).padStart(2,"0");return`${l}:${g}`},u=b=>b===1?{label:"มา",icon:"heroicons:check-circle-20-solid",bgClass:"bg-green-100 dark:bg-green-900/40",textClass:"text-green-700 dark:text-green-300",iconClass:"text-green-600 dark:text-green-400",dotClass:"bg-green-500"}:b===2?{label:"สาย",icon:"heroicons:clock-20-solid",bgClass:"bg-amber-100 dark:bg-amber-900/40",textClass:"text-amber-700 dark:text-amber-300",iconClass:"text-amber-600 dark:text-amber-400",dotClass:"bg-amber-500"}:b===3?{label:"ลา",icon:"heroicons:document-text-20-solid",bgClass:"bg-blue-100 dark:bg-blue-900/40",textClass:"text-blue-700 dark:text-blue-300",iconClass:"text-blue-600 dark:text-blue-400",dotClass:"bg-blue-500"}:{label:"ขาด",icon:"heroicons:x-circle-20-solid",bgClass:"bg-red-100 dark:bg-red-900/40",textClass:"text-red-700 dark:text-red-300",iconClass:"text-red-600 dark:text-red-400",dotClass:"bg-red-500"};return(b,a)=>(c(),m("div",ft,[e("div",xt,[e("div",pt,[e("div",yt,[e("div",vt,[n(r(i),{icon:"fluent:calendar-checkmark-24-filled",class:"w-7 h-7 text-white"})]),e("div",null,[a[1]||(a[1]=e("h3",{class:"text-white/80 text-sm font-medium"},"ข้อมูลการเข้าเรียน",-1)),e("p",ht," แสดง "+v(x.attendances.length)+" จาก "+v(x.attendances.length)+" รายการ ",1)])]),e("button",{onClick:a[0]||(a[0]=l=>D("reload")),disabled:x.loading,class:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white rounded-lg transition-all duration-200 font-medium disabled:opacity-50"},[n(r(i),{icon:"fluent:arrow-sync-24-filled",class:_(["w-5 h-5",{"animate-spin":x.loading}])},null,8,["class"]),a[2]||(a[2]=e("span",null,"รีโหลด",-1))],8,kt)])]),e("div",wt,[e("table",_t,[e("thead",$t,[e("tr",null,[e("th",Ct,[e("div",At,[e("div",Dt,[n(r(i),{icon:"fluent:number-symbol-24-regular",class:"w-5 h-5 text-violet-600 dark:text-violet-400"})]),a[3]||(a[3]=e("span",{class:"text-sm font-bold text-violet-700 dark:text-violet-300"},"ลำดับ",-1))])]),e("th",Bt,[e("div",Tt,[e("div",jt,[n(r(i),{icon:"fluent:calendar-24-regular",class:"w-5 h-5 text-purple-600 dark:text-purple-400"})]),a[4]||(a[4]=e("span",{class:"text-sm font-bold text-purple-700 dark:text-purple-300"},"วันที่",-1))])]),e("th",St,[e("div",Mt,[e("div",It,[n(r(i),{icon:"fluent:play-circle-24-regular",class:"w-5 h-5 text-cyan-600 dark:text-cyan-400"})]),a[5]||(a[5]=e("span",{class:"text-sm font-bold text-cyan-700 dark:text-cyan-300"},"เวลาเริ่ม",-1))])]),e("th",Ut,[e("div",Et,[e("div",Vt,[n(r(i),{icon:"fluent:stop-24-regular",class:"w-5 h-5 text-pink-600 dark:text-pink-400"})]),a[6]||(a[6]=e("span",{class:"text-sm font-bold text-pink-700 dark:text-pink-300"},"เวลาสิ้นสุด",-1))])]),e("th",Lt,[e("div",Rt,[e("div",Ft,[n(r(i),{icon:"fluent:document-text-24-regular",class:"w-5 h-5 text-slate-600 dark:text-slate-400"})]),a[7]||(a[7]=e("span",{class:"text-sm font-bold text-slate-700 dark:text-slate-300"},"คำอธิบาย",-1))])]),e("th",Nt,[e("div",Ot,[e("div",Pt,[n(r(i),{icon:"fluent:checkmark-circle-24-regular",class:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})]),a[8]||(a[8]=e("span",{class:"text-sm font-bold text-emerald-700 dark:text-emerald-300"},"สถานะการเข้าเรียน",-1))])])])]),e("tbody",zt,[(c(!0),m(G,null,Y(x.attendances,(l,g)=>(c(),m("tr",{key:l.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"},[e("td",Ht,[e("span",Gt,v(g+1),1)]),e("td",qt,[e("div",Yt,[e("span",Wt,v(p(l.date||l.start_at)),1),e("span",Jt,v(y(l.date||l.start_at)),1)])]),e("td",Kt,[e("div",Qt,[n(r(i),{icon:"fluent:play-circle-24-filled",class:"w-4 h-4 text-cyan-600 dark:text-cyan-400"}),e("span",Xt,v(d(l.start_at)),1)])]),e("td",Zt,[e("div",er,[n(r(i),{icon:"fluent:stop-24-filled",class:"w-4 h-4 text-pink-600 dark:text-pink-400"}),e("span",tr,v(d(l.finish_at)),1)])]),e("td",rr,[e("span",sr,v(l.description||"-"),1)]),e("td",ar,[B(l)?(c(),m("div",{key:0,class:_(["inline-flex items-center gap-2 px-4 py-2 rounded-full",u(l.status).bgClass])},[n(r(i),{icon:u(l.status).icon,class:_(["w-5 h-5",u(l.status).iconClass])},null,8,["icon","class"]),e("span",{class:_(["font-semibold",u(l.status).textClass])},v(u(l.status).label),3),e("span",{class:_(["w-2 h-2 rounded-full animate-pulse",u(l.status).dotClass])},null,2)],2)):f(l)?(c(),m("button",{key:1,onClick:E=>U(l),disabled:h.value!==null,class:_(["inline-flex items-center gap-2 px-4 py-2 rounded-full font-semibold transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",j(l)?"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-800/50":"bg-green-100 dark:bg-green-900/40 text-green-700 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-800/50"])},[h.value===l.id?(c(),H(r(i),{key:0,icon:"fluent:spinner-ios-20-filled",class:"w-5 h-5 animate-spin"})):(c(),H(r(i),{key:1,icon:j(l)?"heroicons:clock-20-solid":"heroicons:hand-raised-20-solid",class:"w-5 h-5"},null,8,["icon"])),e("span",null,v(h.value===l.id?"กำลังรายงานตัว...":j(l)?"รายงานตัว (สาย)":"รายงานตัว"),1)],10,lr)):S(l)?(c(),m("div",or,[n(r(i),{icon:"fluent:clock-24-regular",class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),a[9]||(a[9]=e("span",{class:"font-semibold text-gray-500 dark:text-gray-400"},"รอเวลาเริ่ม",-1))])):(c(),m("div",{key:3,class:_(["inline-flex items-center gap-2 px-4 py-2 rounded-full",u(l.status).bgClass])},[n(r(i),{icon:u(l.status).icon,class:_(["w-5 h-5",u(l.status).iconClass])},null,8,["icon","class"]),e("span",{class:_(["font-semibold",u(l.status).textClass])},v(u(l.status).label),3),e("span",{class:_(["w-2 h-2 rounded-full animate-pulse",u(l.status).dotClass])},null,2)],2))])]))),128))])])]),x.attendances.length===0&&!x.loading?(c(),m("div",nr,[e("div",ir,[n(r(i),{icon:"fluent:calendar-empty-24-regular",class:"w-12 h-12 text-gray-400 dark:text-gray-500"})]),a[10]||(a[10]=e("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," ยังไม่มีข้อมูลการเข้าเรียน ",-1)),a[11]||(a[11]=e("p",{class:"text-gray-500 dark:text-gray-400"}," รอผู้สอนสร้างการเช็คชื่อใหม่ ",-1))])):$("",!0),x.loading?(c(),m("div",dr,[(c(),m(G,null,Y(3,l=>e("div",{key:l,class:"px-4 py-4 flex items-center gap-4 animate-pulse"},[...a[12]||(a[12]=[Se('<div class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-lg"></div><div class="flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-24 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-20 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"></div>',6)])])),64))])):$("",!0)]))}}),cr={class:"space-y-6"},gr={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4"},br={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},mr={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},fr=["onClick"],xr={class:"flex items-start justify-between gap-2"},pr={class:"flex-1 min-w-0"},yr={class:"flex items-center gap-2 mb-1"},vr={class:"font-semibold text-gray-900 dark:text-white truncate"},hr={class:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1"},kr={key:0,class:"mt-3 flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400"},wr={key:1,class:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-xl shadow-sm p-4 border border-blue-200 dark:border-gray-600"},_r={class:"flex flex-wrap items-center justify-between gap-4"},$r={class:"flex items-center gap-3"},Cr={class:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"},Ar={class:"text-xs text-gray-500 dark:text-gray-400"},Dr={key:0,class:"ml-2"},Br={class:"flex items-center gap-3"},Tr=["disabled"],jr={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Sr={key:0,class:"mt-3 flex items-center gap-2 text-sm text-green-600 dark:text-green-400"},Mr={key:5,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-12 text-center"},Ir={class:"w-32 h-32 mx-auto mb-6 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-3xl flex items-center justify-center"},Ur={class:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto"},Er={class:"space-y-4"},Vr={key:0,class:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},Lr={class:"flex items-center gap-3"},Rr={class:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"},Fr={class:"font-semibold text-gray-900 dark:text-white"},Nr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Or={class:"grid grid-cols-2 gap-4"},Pr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},zr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Hr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Gr={class:"flex items-center gap-3"},qr={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center"},Yr={key:0,class:"space-y-4"},Wr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Jr={class:"grid grid-cols-2 gap-4"},Kr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Qr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Xr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Zr={class:"flex items-center justify-between"},es={class:"flex items-center gap-3"},ts={class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md"},rs={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},ss={class:"space-y-4"},as={key:0,class:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-4 border border-blue-200 dark:border-gray-600"},ls={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},os={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},ns=["disabled"],is={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},ds=["disabled"],us={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},cs=["disabled"],gs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},bs=["disabled"],ms={class:"flex items-center justify-between w-full"},fs={key:0,class:"flex items-center gap-3"},xs=Q({__name:"AttendancesList",props:{courseId:{},isCourseAdmin:{type:Boolean,default:!1}},setup(x){const C=x,D=de(),A=w([]),h=w([]),f=w(null),S=w([]),B=w(null),j=w(!0),U=w(!1),p=w(!1),y=w(!1),d=w(null),u=w(null);w([]),w(!1);const b=w(!0),a=w(15),l=w(null),g=w(null),E=w(!1),W=s=>{const t=s.getFullYear(),k=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),V=String(s.getHours()).padStart(2,"0"),L=String(s.getMinutes()).padStart(2,"0");return`${t}-${k}-${o}T${V}:${L}`},X=s=>{if(!s)return"";const t=new Date(s);return isNaN(t.getTime())?"":W(t)},Z=(s,t=45)=>{if(!s)return"";const k=new Date(s);return isNaN(k.getTime())?"":(k.setMinutes(k.getMinutes()+t),W(k))},re=new Date,ue=new Date(re.getTime()+45*6e4),M=w({title:"",date:new Date().toISOString().split("T")[0],start_time:W(re),end_time:W(ue),description:"",late_time:15});J(()=>M.value.start_time,(s,t)=>{s&&s!==t&&(M.value.end_time=Z(s,45))});const N=async(s,t=!1)=>{t||(j.value=!0);try{const k=new URLSearchParams;s&&k.append("group_id",s.toString());const o=k.toString(),V=`/api/courses/${C.courseId}/attendances${o?`?${o}`:""}`,L=await D.get(V);if(L.courseMemberOfAuth&&(B.value=L.courseMemberOfAuth),L.groups&&h.value.length===0&&(h.value=L.groups,C.isCourseAdmin&&h.value.length>0&&!f.value)){const I=B.value?.last_accessed_group_tab;I&&h.value.some(q=>q.id===I)?f.value=I:f.value=h.value[0].id;const z=h.value.find(q=>q.id===f.value);z?.members&&(S.value=z.members.sort((q,Ce)=>(q.order_number||0)-(Ce.order_number||0)));return}if(s){const I=h.value.find(z=>z.id===s);I?.members&&(S.value=I.members.sort((z,q)=>(z.order_number||0)-(q.order_number||0)))}A.value=L.data||L}catch(k){console.error("Error fetching attendances:",k),A.value=[]}finally{j.value=!1}},ce=async s=>{if(!(!C.isCourseAdmin||!B.value))try{await D.patch(`/api/courses/${C.courseId}/members/update-last-access-group`,{last_accessed_group_tab:s})}catch(t){console.error("Error updating last access group tab:",t)}},ge=async()=>{if(!f.value){alert("กรุณาเลือกกลุ่มเรียน");return}try{const s={description:M.value.description,start_at:M.value.start_time,finish_at:M.value.end_time,late_time:M.value.late_time||15};await D.post(`/api/courses/${C.courseId}/groups/${f.value}/attendances`,s),U.value=!1,ve(),await N(f.value),P.fire({toast:!0,position:"top-end",icon:"success",title:"สร้างสำเร็จ",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"colored-toast"}})}catch(s){console.error("Error creating attendance:",s),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถสร้างการเช็คชื่อได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},be=async()=>{if(d.value)try{const s={description:d.value.description,start_at:d.value.start_at,finish_at:d.value.finish_at,late_time:d.value.late_time||0};await D.patch(`/api/attendances/${d.value.id}`,s),p.value=!1,await N(f.value)}catch(s){console.error("Error updating attendance:",s),alert("เกิดข้อผิดพลาดในการอัพเดทการเช็คชื่อ")}},me=async s=>{if(confirm("คุณต้องการลบการเช็คชื่อนี้หรือไม่?"))try{await D.delete(`/api/attendances/${s}`),N()}catch(t){console.error("Error deleting attendance:",t)}},fe=s=>{u.value={...s,start_at:X(s.start_at),finish_at:X(s.finish_at)},y.value=!0},xe=s=>{d.value={...s,start_at:X(s.start_at),finish_at:X(s.finish_at)},p.value=!0};J(()=>u.value?.start_at,(s,t)=>{s&&s!==t&&u.value&&(u.value.finish_at=Z(s,45))}),J(()=>d.value?.start_at,(s,t)=>{s&&s!==t&&d.value&&(d.value.finish_at=Z(s,45))});const pe=async()=>{if(u.value)try{const s={description:u.value.description,start_at:u.value.start_at,finish_at:u.value.finish_at,late_time:u.value.late_time||0};await D.patch(`/api/attendances/${u.value.id}`,s),y.value=!1,await N(f.value),P.fire({toast:!0,position:"top-end",icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"colored-toast"}})}catch(s){console.error("Error updating attendance:",s),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพเดทข้อมูลได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},ye=async()=>{if(!(!u.value||!(await P.fire({title:"ลบการเช็คชื่อ?",html:`<p class="text-gray-600">คุณต้องการลบการเช็คชื่อ<br/><strong>${u.value.description||"วันที่ "+new Date(u.value.date).toLocaleDateString("th-TH")}</strong></p><p class="text-red-600 text-sm mt-2">การดำเนินการน้ีไม่สามารถย้อนกลับได้</p>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",reverseButtons:!0,customClass:{popup:"rounded-xl",confirmButton:"px-5 py-2 rounded-lg font-medium",cancelButton:"px-5 py-2 rounded-lg font-medium"}})).isConfirmed))try{await D.delete(`/api/attendances/${u.value.id}`),y.value=!1,await N(f.value)}catch(t){console.error("Error deleting attendance:",t),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถลบการเช็คชื่อได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},ve=()=>{const s=new Date,t=new Date(s.getTime()+45*6e4);M.value={title:"",date:new Date().toISOString().split("T")[0],start_time:W(s),end_time:W(t),description:"",late_time:15}},he=async({attendanceId:s,memberId:t,status:k})=>{const o=A.value.find(I=>I.id===s);if(!o)return;const V=o.details?.find(I=>I.course_member_id===t),L=V?V.status:null;V?V.status=k:o.details&&o.details.push({course_member_id:t,status:k});try{const I=k===null?0:k;await D.post(`/api/attendances/${s}/member/${t}/update-status`,{status:I}),P.fire({toast:!0,position:"top-end",icon:"success",title:"อัพเดทสถานะสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0})}catch(I){if(V&&L!==null)V.status=L;else if(V&&L===null){const z=o.details.indexOf(V);z>-1&&o.details.splice(z,1)}console.error("Error updating member status:",I),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพเดทสถานะได้",showConfirmButton:!1,timer:2e3})}},ke=s=>s?new Date(s).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"",se=K(()=>!C.isCourseAdmin||!f.value?A.value:A.value.filter(s=>s.group_id===f.value)),ae=K(()=>{if(C.isCourseAdmin||!B.value)return[];const s=B.value.group_id;return A.value.filter(t=>!s||t.group_id===s).map(t=>{const k=t.details?.find(o=>o.course_member_id===B.value?.id);return{id:t.id,date:t.date||t.start_at,start_at:t.start_at,finish_at:t.finish_at,late_time:t.late_time||15,description:t.description,status:k?.status??null,time_in:k?.time_in}}).sort((t,k)=>new Date(k.date).getTime()-new Date(t.date).getTime())});J(f,(s,t)=>{s&&C.isCourseAdmin&&(t!=null&&ce(s),N(s))});const ee=()=>{l.value&&clearInterval(l.value),b.value&&C.isCourseAdmin&&(l.value=Me(async()=>{!j.value&&!U.value&&!p.value&&!y.value&&(E.value=!0,await N(f.value,!0),g.value=new Date,E.value=!1)},a.value*1e3))},te=()=>{l.value&&(clearInterval(l.value),l.value=null)},we=()=>{b.value=!b.value,b.value?ee():te()},_e=async()=>{E.value=!0,await N(f.value,!0),g.value=new Date,E.value=!1},$e=K(()=>{if(!g.value)return"";const t=Math.floor((new Date().getTime()-g.value.getTime())/1e3);return t<60?`${t} วินาทีที่แล้ว`:t<3600?`${Math.floor(t/60)} นาทีที่แล้ว`:g.value.toLocaleTimeString("th-TH")});return J(b,s=>{s?ee():te()}),oe(()=>{N(),C.isCourseAdmin&&ee()}),ne(()=>{te()}),(s,t)=>{const k=Ae;return c(),m("div",cr,[x.isCourseAdmin&&r(h).length>0?(c(),m("div",gr,[e("label",br,[n(r(i),{icon:"fluent:people-team-24-regular",class:"w-5 h-5 inline-block mr-2"}),t[22]||(t[22]=T(" เลือกกลุ่มเรียน ",-1))]),e("div",mr,[(c(!0),m(G,null,Y(r(h),o=>(c(),m("button",{key:o.id,onClick:V=>f.value=o.id,class:_(["relative p-4 rounded-xl border-2 transition-all duration-300 text-left",r(f)===o.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-md scale-105":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-sm"])},[e("div",xr,[e("div",pr,[e("div",yr,[e("div",{class:_(["w-3 h-3 rounded-full transition-all",r(f)===o.id?"bg-blue-500 animate-pulse":"bg-gray-400"])},null,2),e("h4",vr,v(o.name||`กลุ่ม ${o.id}`),1)]),e("p",hr,[n(r(i),{icon:"fluent:people-20-regular",class:"w-4 h-4"}),e("span",null,v(o.members?.length||o.member_count||0)+" คน",1)])]),r(f)===o.id?(c(),H(r(i),{key:0,icon:"fluent:checkmark-circle-24-filled",class:"w-6 h-6 text-blue-500 flex-shrink-0"})):$("",!0)])],10,fr))),128))]),r(j)?(c(),m("div",kr,[...t[23]||(t[23]=[e("div",{class:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1),e("span",null,"กำลังโหลดประวัติการเช็คชื่อ...",-1)])])):$("",!0)])):$("",!0),x.isCourseAdmin&&r(h).length>0?(c(),m("div",wr,[e("div",_r,[e("div",$r,[e("div",Cr,[n(r(i),{icon:"fluent:arrow-sync-24-filled",class:_(["w-5 h-5 text-white",{"animate-spin":r(E)}])},null,8,["class"])]),e("div",null,[t[24]||(t[24]=e("h3",{class:"font-semibold text-gray-900 dark:text-white"},"อัพเดทสถานะอัตโนมัติ",-1)),e("p",Ar,[r(b)?(c(),m(G,{key:0},[T(" รีเฟรชทุก "+v(r(a))+" วินาที ",1),r(g)?(c(),m("span",Dr,"• อัพเดทล่าสุด: "+v(r($e)),1)):$("",!0)],64)):(c(),m(G,{key:1},[T("ปิดอยู่ - กดปุ่มรีเฟรชเพื่ออัพเดทข้อมูล")],64))])])]),e("div",Br,[e("button",{onClick:_e,disabled:r(E),class:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 rounded-lg border border-blue-300 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-gray-600 transition-all disabled:opacity-50"},[n(r(i),{icon:"fluent:arrow-clockwise-24-regular",class:_(["w-5 h-5",{"animate-spin":r(E)}])},null,8,["class"]),t[25]||(t[25]=e("span",{class:"hidden sm:inline"},"รีเฟรช",-1))],8,Tr),e("button",{onClick:we,class:_(["relative inline-flex h-8 w-14 items-center rounded-full transition-colors duration-300",r(b)?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"])},[e("span",{class:_(["inline-block h-6 w-6 transform rounded-full bg-white shadow-lg transition-transform duration-300",r(b)?"translate-x-7":"translate-x-1"])},null,2)],2),e("span",jr,v(r(b)?"เปิด":"ปิด"),1)])]),r(b)?(c(),m("div",Sr,[...t[26]||(t[26]=[e("span",{class:"relative flex h-3 w-3"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})],-1),e("span",null,"กำลังติดตามสถานะการมาเรียนแบบ Live",-1)])])):$("",!0)])):$("",!0),r(j)?(c(),H(Ie,{key:2})):x.isCourseAdmin&&r(se).length>0&&r(S).length>0?(c(),H(mt,{key:3,attendances:r(se),"group-members":r(S),"is-course-admin":x.isCourseAdmin,onCreate:t[0]||(t[0]=o=>U.value=!0),onViewDetails:fe,onEdit:xe,onDelete:me,onUpdateStatus:he},null,8,["attendances","group-members","is-course-admin"])):!x.isCourseAdmin&&r(ae).length>0?(c(),H(ur,{key:4,attendances:r(ae),loading:r(j),onReload:t[1]||(t[1]=o=>N())},null,8,["attendances","loading"])):(c(),m("div",Mr,[e("div",Ir,[n(r(i),{icon:"fluent:calendar-empty-24-regular",class:"w-20 h-20 text-blue-500 dark:text-blue-400"})]),t[28]||(t[28]=e("h3",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"}," ยังไม่มีการเช็คชื่อ ",-1)),e("p",Ur,v(x.isCourseAdmin?"เริ่มต้นสร้างการเช็คชื่อเพื่อติดตามการเข้าเรียนของนักเรียน":"รอผู้สอนสร้างการเช็คชื่อ คุณจะได้รับการแจ้งเตือนเมื่อมีการเช็คชื่อใหม่"),1),x.isCourseAdmin?(c(),m("button",{key:0,onClick:t[2]||(t[2]=o=>U.value=!0),class:"inline-flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl hover:scale-105"},[n(r(i),{icon:"fluent:add-circle-24-filled",class:"w-6 h-6"}),t[27]||(t[27]=e("span",null,"สร้างการเช็คชื่อแรก",-1))])):$("",!0)])),n(k,{show:r(U),onClose:t[8]||(t[8]=o=>U.value=!1)},{title:O(()=>[...t[29]||(t[29]=[T("สร้างการเช็คชื่อ",-1)])]),content:O(()=>[e("div",Er,[r(f)?(c(),m("div",Vr,[e("div",Lr,[e("div",Rr,[n(r(i),{icon:"fluent:people-team-24-filled",class:"w-6 h-6 text-white"})]),e("div",null,[t[30]||(t[30]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"กำลังสร้างการเช็คชื่อสำหรับ",-1)),e("p",Fr,v(r(h).find(o=>o.id===r(f))?.name||`กลุ่ม ${r(f)}`),1)])])])):$("",!0),e("div",null,[e("label",Nr,[n(r(i),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[31]||(t[31]=T(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>r(M).description=o),type:"text",placeholder:"ครั้งที่หรือสัปดาห์ที่",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).description]])]),e("div",Or,[e("div",null,[e("label",Pr,[n(r(i),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[32]||(t[32]=T(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>r(M).start_time=o),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).start_time]])]),e("div",null,[e("label",zr,[n(r(i),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[33]||(t[33]=T(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r(M).end_time=o),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).end_time]])])]),e("div",null,[e("label",Hr,[n(r(i),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[34]||(t[34]=T(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>r(M).late_time=o),type:"number",min:"0",placeholder:"15",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).late_time,void 0,{number:!0}]])])])]),footer:O(()=>[e("button",{onClick:t[7]||(t[7]=o=>U.value=!1),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"}," ยกเลิก "),e("button",{onClick:ge,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," สร้าง ")]),_:1},8,["show"]),n(k,{show:r(p),onClose:t[14]||(t[14]=o=>p.value=!1)},{title:O(()=>[e("div",Gr,[e("div",qr,[n(r(i),{icon:"fluent:edit-24-filled",class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),t[35]||(t[35]=e("div",null,[e("h3",{class:"text-lg font-bold"},"แก้ไขการเช็คชื่อ"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"อัพเดทข้อมูลการเช็คชื่อ")],-1))])]),content:O(()=>[r(d)?(c(),m("div",Yr,[e("div",null,[e("label",Wr,[n(r(i),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[36]||(t[36]=T(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>r(d).description=o),type:"text",placeholder:"เช่น บทที่ 1, สอบกลางภาค",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(d).description]])]),e("div",Jr,[e("div",null,[e("label",Kr,[n(r(i),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[37]||(t[37]=T(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>r(d).start_at=o),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(d).start_at]])]),e("div",null,[e("label",Qr,[n(r(i),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[38]||(t[38]=T(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>r(d).finish_at=o),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(d).finish_at]])])]),e("div",null,[e("label",Xr,[n(r(i),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[39]||(t[39]=T(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[12]||(t[12]=o=>r(d).late_time=o),type:"number",min:"0",placeholder:"จำนวนนาทีที่ถือว่าสาย",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(d).late_time,void 0,{number:!0}]])])])):$("",!0)]),footer:O(()=>[e("button",{onClick:t[13]||(t[13]=o=>p.value=!1),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," ยกเลิก "),e("button",{onClick:be,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[n(r(i),{icon:"fluent:save-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[40]||(t[40]=T(" บันทึกการเปลี่ยนแปลง ",-1))])]),_:1},8,["show"]),n(k,{show:r(y),onClose:t[21]||(t[21]=o=>y.value=!1),"max-width":"2xl"},{title:O(()=>[e("div",Zr,[e("div",es,[e("div",ts,[n(r(i),{icon:"fluent:calendar-checkmark-24-filled",class:"w-6 h-6 text-white"})]),e("div",null,[t[41]||(t[41]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"รายละเอียดการเช็คชื่อ",-1)),e("p",rs,v(ke(r(u)?.date||r(u)?.start_at)),1)])]),e("button",{onClick:t[15]||(t[15]=o=>y.value=!1),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"ปิด"},[n(r(i),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5 text-gray-500 dark:text-gray-400"})])])]),content:O(()=>[e("div",ss,[r(u)?(c(),m("div",as,[e("div",ls,[e("div",null,[e("label",os,[n(r(i),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[42]||(t[42]=T(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[16]||(t[16]=o=>r(u).description=o),disabled:!x.isCourseAdmin,type:"text",placeholder:"ครั้งที่หรือสัปดาห์ที่",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,ns),[[F,r(u).description]])]),e("div",null,[e("label",is,[n(r(i),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[43]||(t[43]=T(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[17]||(t[17]=o=>r(u).late_time=o),disabled:!x.isCourseAdmin,type:"number",min:"0",placeholder:"จำนวนนาทีที่ถือว่าสาย",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,ds),[[F,r(u).late_time,void 0,{number:!0}]])]),e("div",null,[e("label",us,[n(r(i),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[44]||(t[44]=T(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[18]||(t[18]=o=>r(u).start_at=o),disabled:!x.isCourseAdmin,type:"datetime-local",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,cs),[[F,r(u).start_at]])]),e("div",null,[e("label",gs,[n(r(i),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[45]||(t[45]=T(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[19]||(t[19]=o=>r(u).finish_at=o),disabled:!x.isCourseAdmin,type:"datetime-local",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,bs),[[F,r(u).finish_at]])])])])):$("",!0)])]),footer:O(()=>[e("div",ms,[e("button",{onClick:t[20]||(t[20]=o=>y.value=!1),class:"inline-flex items-center gap-2 px-5 py-2.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium"},[n(r(i),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5"}),t[46]||(t[46]=e("span",null,"ปิด",-1))]),x.isCourseAdmin?(c(),m("div",fs,[e("button",{onClick:ye,class:"inline-flex items-center gap-2 px-5 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg hover:shadow-xl"},[n(r(i),{icon:"fluent:delete-24-regular",class:"w-5 h-5"}),t[47]||(t[47]=e("span",null,"ลบการเช็คชื่อ",-1))]),e("button",{onClick:pe,class:"inline-flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-medium shadow-lg hover:shadow-xl"},[n(r(i),{icon:"fluent:save-24-filled",class:"w-5 h-5"}),t[48]||(t[48]=e("span",null,"บันทึกการเปลี่ยนแปลง",-1))])])):$("",!0)])]),_:1},8,["show"])])}}}),ps=ie(xs,[["__scopeId","data-v-3cbbea61"]]),$s=Q({__name:"attendances",setup(x){const C=le("course"),D=le("isCourseAdmin");return(A,h)=>(c(),m("div",null,[r(C)?.id?(c(),H(ps,{key:0,"course-id":r(C).id,"is-course-admin":r(D)},null,8,["course-id","is-course-admin"])):$("",!0)]))}});export{$s as default};
