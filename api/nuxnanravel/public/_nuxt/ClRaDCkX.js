import{z as h,an as f,A as b,ah as g,r as m,f as w,c as d,a as t,d as v,u as l,t as _,o as c}from"./DuB962GZ.js";const x={class:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-900 via-blue-900 to-black"},y={class:"text-center max-w-md px-4"},k={key:0,class:"space-y-4"},q={key:1,class:"bg-red-500/20 border border-red-500 rounded-lg p-6"},A={class:"text-red-200 mb-4"},P=h({__name:"callback",setup(C){const s=f(),n=b(),p=g(),i=m(!0),r=m(null);return w(async()=>{try{const o=s.query.token,e=s.query.error,a=s.query.error_description,S=s.query.provider,B=s.query.new_user==="1";if(e){const u={invalid_state:"Security validation failed. Please try again.",invalid_provider:"Invalid authentication provider.",invalid_request:a||"Invalid request.",server_error:a||"Server error occurred.",access_denied:"You denied access to your account.",missing_referral_code:a||"Referral code is required.",invalid_referral_code:a||"Invalid referral code."};r.value=u[e]||a||"Authentication failed.",i.value=!1,setTimeout(()=>{n.push("/auth?tab=login")},3e3);return}if(!o){r.value="No authentication token received.",i.value=!1,setTimeout(()=>{n.push("/auth?tab=login")},3e3);return}if(!await p.handleOAuthCallback(o))throw new Error("Failed to load user data");if(!p.user)throw new Error("User data not available");await new Promise(u=>setTimeout(u,100)),await n.push("/play/newsfeed")}catch(o){console.error("OAuth callback error:",o),r.value=o.message||"Failed to complete authentication.",i.value=!1,setTimeout(()=>{n.push("/auth?tab=login")},3e3)}}),(o,e)=>(c(),d("div",x,[t("div",y,[l(i)&&!l(r)?(c(),d("div",k,[...e[0]||(e[0]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500 mx-auto"},null,-1),t("p",{class:"text-white text-lg font-medium"},"Completing authentication...",-1),t("p",{class:"text-gray-400 text-sm"},"Please wait while we sign you in",-1)])])):v("",!0),l(r)?(c(),d("div",q,[e[1]||(e[1]=t("svg",{class:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e[2]||(e[2]=t("h2",{class:"text-xl font-bold text-white mb-2"},"Authentication Failed",-1)),t("p",A,_(l(r)),1),e[3]||(e[3]=t("p",{class:"text-sm text-gray-400"},"Redirecting to login page...",-1))])):v("",!0)])]))}});export{P as default};
