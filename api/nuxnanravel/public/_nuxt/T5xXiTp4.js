import{c as i,o as r,a as e,t as c,r as n,N as q,b as f,d as k,l as I,w as v,q as C,v as V,m as E,j as P,i as F,u as O,I as T,F as A,n as M}from"./DuB962GZ.js";import{r as U,a as $}from"./Czq9JhUr.js";import{S as j}from"./BQxta0Da.js";import W from"./DlGh3WWW.js";import{L as H}from"./CSoC-6qE.js";import"./fgoR5NrX.js";import"./CZOFP7UD.js";import"./Dz4Xxw99.js";import"./Dn9pp5cj.js";const J={class:"bg-white p-4 shadow rounded-lg mb-4"},K={class:"flex items-center"},Q=["src"],X={class:"font-bold"},Y={class:"mt-4"},Z={__name:"DonationCard",props:{donate:Object,isProcessing:Boolean},setup(d){return(s,l)=>(r(),i("div",J,[e("div",K,[e("img",{src:d.donate.donor?.avatar||"/storage/images/default_avatar.png",class:"w-12 h-12 rounded-full mr-4"},null,8,Q),e("div",null,[e("h4",X,c(d.donate.donor?.name||"Unknown Donor"),1),l[1]||(l[1]=e("p",{class:"text-sm text-gray-600"},"Donated Points",-1))])]),e("div",Y,[e("button",{class:"bg-blue-500 text-white px-4 py-2 rounded",onClick:l[0]||(l[0]=u=>s.$emit("getDonateRequest"))},"Receive Donation")])]))}},ee={class:"mt-2 md:mt-0 mb-4 flex justify-center bg-white p-2 rounded-lg border-t-4 border-blue-500"},te={key:1,class:"grid md:grid-cols-2 gap-4"},se={key:2,class:"flex justify-center items-center h-96"},oe={class:"relative w-[40rem] h-[22rem] z-30 bg-white rounded-lg mx-auto overflow-hidden"},ae={class:"flex items-center p-2 mb-4 bg-gray-300 rounded-md"},ne={class:"flex-shrink-0"},re=["src","alt"],le={class:"w-full ps-3"},ie={class:"flex flex-col mb-1 text-[40px] text-gray-700 dark:text-gray-400"},de={class:"font-bold text-blue-500"},ce={class:"font-semibold"},ue={class:"absolute top-[75%] left-[14rem] text-[60px] text-yellow-400/80"},me={class:"relative w-[40rem] h-[39rem] z-30 bg-white rounded-lg mx-auto overflow-hidden"},ge={class:"absolute top-[30%] left-[14rem] text-[60px] text-yellow-300/80"},ke={__name:"Donates",props:{donates:Object},setup(d){const s=d,l=n(!1),u=n(!1),m=n(),g=n(0),o=n(0),B=n(),h=n(),b=n(),w=q(()=>m.value>=0&&u.value),S=(a,t)=>{u.value=!0,m.value=5e3,g.value=0,o.value=t,B.value=a;try{G(a),_()}catch{}},G=async a=>{try{let t=await axios.get(`/donates/${a}/get-donate`);t.data.success?(h.value=t.data.donate,b.value=t.data.activity):y()}catch{y()}},L=a=>new Promise(t=>setTimeout(t,a)),_=()=>{m.value-=20.83,m.value>20.83?(g.value+=1,L(20.84).then(_)):(u.value=!1,R())},R=()=>{$().props.auth.user&&($().props.auth.user.pp+=240),s.donates.data[o.value].remaining_points=h.value.remaining_points,s.donates.data[o.value].remaining_points<240&&s.donates.data.splice(o.value,1),b.value=null,z()},z=()=>{j.fire({title:"รับการสนับสนุนสำเร็จ",text:"คุณได้รับการสนับสนุนเรียบร้อยแล้ว 240 แต้ม",icon:"success",showConfirmButton:!1,timer:1200})},y=()=>{j.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถรับการสนับสนุนได้",icon:"error",showConfirmButton:!1,timer:1200})},N=a=>{l.value=!0,U.visit(a)};return(a,t)=>{const p=E("ProgressBar");return r(),i("div",null,[f(W,{title:"ทุนสนับสนุนการเรียนรู้"},{coverProfileCard:v(()=>[...t[1]||(t[1]=[e("div",{class:"hidden md:flex items-center mx-auto mt-2 mb-4 shadow-lg bg-cover bg-no-repeat rounded-lg",style:{backgroundImage:"url(/storage/images/banner/banner-bg.png)"}},[e("img",{class:"section-banner-icon",src:"/storage/images/banner/badges-icon.png",alt:"forums-icon"}),e("p",{class:"text-white font-bold text-2xl"},"ทุนสนับสนุนการเรียนรู้")],-1),e("div",{class:""},null,-1)])]),leftSideWidget:v(()=>[...t[2]||(t[2]=[])]),rightSidebar:v(()=>[...t[3]||(t[3]=[])]),mainContent:v(()=>[l.value?(r(),P(H,{key:0})):k("",!0),e("div",ee,[e("button",{class:"flex items-center justify-center max-w-fit px-4 py-2 my-1 font-medium text-center text-white rounded-md bg-green-400",onClick:t[0]||(t[0]=F(x=>N("/supports/donates/create"),["prevent"]))},[f(O(T),{icon:"flat-color-icons:donate",class:"w-7 h-7"}),t[4]||(t[4]=e("span",null,"ให้การสนับสนุนทุนการเรียนรู้",-1))])]),d.donates.data.length?(r(),i("div",te,[(r(!0),i(A,null,M(s.donates.data,(x,D)=>(r(),P(Z,{key:D,donate:x,isProcessing:!1,onGetDonateRequest:fe=>S(x.id,D)},null,8,["donate","onGetDonateRequest"]))),128))])):(r(),i("div",se,[...t[5]||(t[5]=[e("p",{class:"text-2xl font-bold text-gray-400"},"No Donations",-1)])]))]),_:1}),s.donates.data[o.value].donor?(r(),i("div",{key:0,class:C([{hidden:!w.value},"fixed top-0 left-0 z-20 flex items-center justify-center w-full h-full modal bg-gray-900/100 modal-overlay"])},[e("div",oe,[e("figure",ae,[e("div",ne,[e("img",{class:"w-40 h-40 rounded-full border-4 border-yellow-400",src:s.donates.data[o.value].donor.avatar,alt:s.donates.data[o.value].donor.name+"photo"},null,8,re)]),e("div",le,[e("div",ie,[e("span",de,c(s.donates.data[o.value].donor.name),1),e("span",ce,c(s.donates.data[o.value].donor.personal_code),1)])])]),f(p,{mode:"indeterminate",style:{height:"16px"}}),t[6]||(t[6]=e("div",{class:"w-full flex justify-center"},[e("p",{class:"mt-4 text-[20px]"},"ให้การสนับสนุน แก่คุณ")],-1)),e("div",ue,c(g.value)+" แต้ม ",1)])],2)):k("",!0),I(e("div",{class:C([{hidden:!w.value},"fixed top-0 left-0 z-20 flex items-center justify-center w-full h-full modal bg-gray-900/100 modal-overlay"])},[e("div",me,[t[7]||(t[7]=e("img",{src:"/storage/images/donates/plearnd_poster.png",alt:"",srcset:"",class:"w-full"},null,-1)),f(p,{mode:"indeterminate",style:{height:"16px"}}),e("div",ge,c(g.value)+" แต้ม ",1)])],2),[[V,!s.donates.data[o.value].donor]])])}}};export{ke as default};
