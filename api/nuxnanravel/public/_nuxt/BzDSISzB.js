import{af as v,r as u,N as i}from"./DuB962GZ.js";const C=()=>{const o=v(),a=u(null),n=u(!1),l=u(null),s=u(!1),c=i(()=>!!a.value),f=i(()=>a.value?.profile_completion??null),p=i(()=>a.value?.profile_completion?.missing_fields??[]);return{profile:a,isLoading:n,error:l,isSaving:s,isProfileLoaded:c,profileCompletion:f,missingFields:p,fetchMyProfile:async()=>{n.value=!0,l.value=null;try{const r=await o.get("/api/profile/me");return r.success?(a.value=r.data,r.data):null}catch(r){return l.value=r.message||"ไม่สามารถโหลดโปรไฟล์ได้",console.error("Error fetching profile:",r),null}finally{n.value=!1}},fetchUserProfile:async r=>{n.value=!0,l.value=null;try{const e=await o.get(`/api/users/${r}/show`);return e.success?{profile:e.data,friendshipStatus:e.friendship_status,canViewFullProfile:e.can_view_full_profile,isOwnProfile:e.is_own_profile}:null}catch(e){return l.value=e.message||"ไม่สามารถโหลดโปรไฟล์ได้",console.error("Error fetching user profile:",e),null}finally{n.value=!1}},updateProfile:async r=>{s.value=!0,l.value=null;try{const e=await o.put("/api/profile/update",r);return e.success?(a.value=e.data,e.data):null}catch(e){throw l.value=e.message||"ไม่สามารถอัพเดทโปรไฟล์ได้",console.error("Error updating profile:",e),e}finally{s.value=!1}},updateAvatar:async r=>{s.value=!0,l.value=null;try{const e=new FormData;e.append("avatar",r);const t=await o.call("/api/profile/avatar",{method:"POST",body:e});return t.success&&a.value?(a.value.avatar=t.avatar,t.avatar):null}catch(e){throw l.value=e.message||"ไม่สามารถอัพโหลดรูปโปรไฟล์ได้",console.error("Error updating avatar:",e),e}finally{s.value=!1}},updateCover:async r=>{s.value=!0,l.value=null;try{const e=new FormData;e.append("cover",r);const t=await o.call("/api/profile/cover",{method:"POST",body:e});return t.success&&a.value?(a.value.cover_image=t.cover_image,t.cover_image):null}catch(e){throw l.value=e.message||"ไม่สามารถอัพโหลดรูปปกได้",console.error("Error updating cover:",e),e}finally{s.value=!1}},fetchProfileCompletion:async()=>{try{const r=await o.get("/api/profile/completion");return r.success?(a.value&&(a.value.profile_completion=r.data),r.data):null}catch(r){return console.error("Error fetching profile completion:",r),null}},updatePrivacy:async r=>{s.value=!0,l.value=null;try{return(await o.put("/api/profile/privacy",{privacy_settings:r})).success&&a.value?(a.value.privacy_settings=r,!0):!1}catch(e){return l.value=e.message||"ไม่สามารถอัพเดทการตั้งค่าได้",console.error("Error updating privacy:",e),!1}finally{s.value=!1}},fetchStats:async r=>{try{const e=r?`/api/users/${r}/stats`:"/api/profile/stats",t=await o.get(e);return t.success?t.data:null}catch(e){return console.error("Error fetching stats:",e),null}},clearProfile:()=>{a.value=null,l.value=null}}};export{C as u};
