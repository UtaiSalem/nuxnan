import{_ as re}from"./CehGOp-7.js";import{z as H,N as V,c as d,o as a,a as e,t as o,q as x,u as s,b,e as m,I as u,ae as A,_ as oe,x as ae,af as de,r as k,a4 as G,f as le,d as p,F as C,n as j,l as R,y as Q,ay as ne,j as W,w as F,p as ie,Y}from"./DuB962GZ.js";import"./CouwXKwP.js";const ge={class:"flex items-start gap-3"},ce=["src","alt"],ue={class:"flex-1 min-w-0"},xe={class:"font-medium text-gray-900 dark:text-white truncate"},be={class:"text-sm text-gray-500 dark:text-gray-400 truncate"},ye={class:"mt-1"},pe={class:"text-xs text-gray-400 mt-1"},_e={class:"relative w-16 h-16 flex-shrink-0"},he={class:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36"},me=["stroke-dasharray"],ve={class:"absolute inset-0 flex flex-col items-center justify-center"},fe={class:"text-[10px] text-gray-400"},ke={class:"mt-4 space-y-3"},we={class:"flex items-center justify-between mb-1"},$e={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},Ce={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},ze={class:"flex items-center justify-between mb-1"},je={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},Be={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},qe={class:"flex items-center justify-between mb-1"},Me={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},De={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Pe={class:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 grid grid-cols-3 gap-2 text-center"},Ve={class:"text-xs text-gray-400"},Ae={class:"text-lg font-semibold text-blue-600 dark:text-blue-400"},Ee=H({__name:"ProgressCard",props:{member:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["view-details"],setup(i,{emit:v}){const f=i,c=v,z=V(()=>{if(f.member.overall_progress!==void 0)return f.member.overall_progress;const n=f.member.lessons_progress||0,g=f.member.assignments_progress||0,E=f.member.quizzes_progress||0;return Math.round((n*40+g*30+E*30)/100)}),w=n=>n>=80?"bg-green-500":n>=60?"bg-blue-500":n>=40?"bg-yellow-500":"bg-red-500",_=n=>n>=80?"text-green-600 dark:text-green-400":n>=60?"text-blue-600 dark:text-blue-400":n>=40?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",q=n=>n?new Date(n).toLocaleDateString("th-TH",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"ยังไม่มีกิจกรรม",M=V(()=>{const n=z.value;return n>=80?{text:"ดีเยี่ยม",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300 border-green-200 dark:border-green-800"}:n>=50?{text:"ปกติ",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 border-blue-200 dark:border-blue-800"}:{text:"ต้องปรับปรุง",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 border-red-200 dark:border-red-800"}});return(n,g)=>(a(),d("div",{class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:g[0]||(g[0]=E=>c("view-details",i.member))},[e("div",ge,[e("img",{src:i.member.user?.avatar||"/images/default-avatar.png",alt:i.member.user?.name,class:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 dark:border-gray-600"},null,8,ce),e("div",ue,[e("h4",xe,o(i.member.user?.name),1),e("p",be," @"+o(i.member.user?.username),1),e("div",ye,[e("span",{class:x(["inline-flex items-center px-2 py-0.5 rounded textxs font-medium border",s(M).color])},o(s(M).text),3)]),e("p",pe," เข้าใช้งานล่าสุด: "+o(q(i.member.last_activity)),1)]),e("div",_e,[(a(),d("svg",he,[g[1]||(g[1]=e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3",class:"text-gray-200 dark:text-gray-700"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round",class:x(_(s(z))),"stroke-dasharray":`${s(z)*.97} 100`},null,10,me)])),e("div",ve,[e("span",{class:x(["text-sm font-bold",_(s(z))])},o(i.member.scores?.grade_name||"-"),3),e("span",fe,o(s(z))+"%",1)])])]),e("div",ke,[e("div",null,[e("div",we,[e("span",$e,[b(s(u),{icon:"fluent:book-24-regular",class:"w-4 h-4"}),g[2]||(g[2]=m(" บทเรียน ",-1))]),e("span",{class:x(["text-sm font-medium",_(i.member.lessons_progress||0)])},o(i.member.lessons_completed||0)+"/"+o(i.member.total_lessons||0),3)]),e("div",Ce,[e("div",{class:x(["h-full rounded-full transition-all duration-500",w(i.member.lessons_progress||0)]),style:A({width:`${i.member.lessons_progress||0}%`})},null,6)])]),e("div",null,[e("div",ze,[e("span",je,[b(s(u),{icon:"fluent:document-text-24-regular",class:"w-4 h-4"}),g[3]||(g[3]=m(" งานที่มอบหมาย ",-1))]),e("span",{class:x(["text-sm font-medium",_(i.member.assignments_progress||0)])},o(i.member.assignments_completed||0)+"/"+o(i.member.total_assignments||0),3)]),e("div",Be,[e("div",{class:x(["h-full rounded-full transition-all duration-500",w(i.member.assignments_progress||0)]),style:A({width:`${i.member.assignments_progress||0}%`})},null,6)])]),e("div",null,[e("div",qe,[e("span",Me,[b(s(u),{icon:"fluent:quiz-new-24-regular",class:"w-4 h-4"}),g[4]||(g[4]=m(" แบบทดสอบ ",-1))]),e("span",{class:x(["text-sm font-medium",_(i.member.quizzes_progress||0)])},o(i.member.quizzes_completed||0)+"/"+o(i.member.total_quizzes||0),3)]),e("div",De,[e("div",{class:x(["h-full rounded-full transition-all duration-500",w(i.member.quizzes_progress||0)]),style:A({width:`${i.member.quizzes_progress||0}%`})},null,6)])])]),e("div",Pe,[e("div",null,[e("div",{class:x(["text-lg font-semibold",_(i.member.attendance_rate||0)])},o(i.member.attendance_rate||0)+"% ",3),e("p",Ve,"เข้าเรียน ("+o(i.member.attendance_present||0)+"/"+o(i.member.total_attendance||0)+")",1)]),e("div",null,[e("div",Ae,o(i.member.scores?.total_score||0),1),g[5]||(g[5]=e("p",{class:"text-xs text-gray-400"},"คะแนนรวม",-1))]),e("div",null,[e("div",{class:x(["text-lg font-semibold",_(s(z))])},o(i.member.scores?.grade_name||"-"),3),g[6]||(g[6]=e("p",{class:"text-xs text-gray-400"},"เกรด",-1))])])]))}}),Te={},Ie={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 animate-pulse"};function Se(i,v){return a(),d("div",Ie,[...v[0]||(v[0]=[ae('<div class="flex items-start gap-3"><div class="w-12 h-12 rounded-full bg-gray-300 dark:bg-gray-600"></div><div class="flex-1 min-w-0 space-y-2"><div class="h-4 w-3/4 rounded bg-gray-300 dark:bg-gray-600"></div><div class="h-3 w-1/2 rounded bg-gray-300 dark:bg-gray-600"></div><div class="h-2 w-2/3 rounded bg-gray-200 dark:bg-gray-700 mt-1"></div></div><div class="w-16 h-16 rounded-full bg-gray-200 dark:bg-gray-700 flex-shrink-0"></div></div><div class="mt-4 space-y-3"><div><div class="flex justify-between mb-1"><div class="h-3 w-16 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div><div><div class="flex justify-between mb-1"><div class="h-3 w-20 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div><div><div class="flex justify-between mb-1"><div class="h-3 w-16 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div></div><div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 grid grid-cols-3 gap-2"><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-12 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-14 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-12 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div></div>',3)])])}const We=oe(Te,[["render",Se]]),Ue={class:"space-y-6"},Ne={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4"},Le={class:"text-sm text-gray-500 dark:text-gray-400"},Re={key:0,class:"space-y-4"},Fe={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},He={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},Oe={class:"flex items-center gap-3"},Ge={class:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},Qe={class:"text-xl font-bold text-gray-900 dark:text-white"},Ye={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},Je={class:"flex items-center gap-3"},Ke={class:"p-2 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg"},Xe={class:"text-xl font-bold text-gray-900 dark:text-white"},Ze={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},et={class:"flex items-center gap-3"},tt={class:"p-2 bg-green-50 dark:bg-green-900/20 rounded-lg"},st={class:"text-xl font-bold text-gray-900 dark:text-white"},rt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},ot={class:"flex items-center gap-3"},at={class:"p-2 bg-teal-50 dark:bg-teal-900/20 rounded-lg"},dt={class:"text-xl font-bold text-gray-900 dark:text-white"},lt={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},nt={class:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700"},it={class:"font-semibold text-gray-800 dark:text-gray-200 mb-6 flex items-center gap-2"},gt={class:"flex items-end justify-between h-40 gap-2 px-2"},ct={class:"absolute -top-8 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity"},ut={key:0,class:"absolute bottom-0 left-0 right-0 bg-blue-500/20 h-full w-full"},xt={class:"text-sm font-medium text-gray-600 dark:text-gray-400"},bt={class:"bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col"},yt={class:"font-semibold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2"},pt={class:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar"},_t=["onClick"],ht={class:"relative"},mt=["src"],vt={key:0,class:"absolute -top-1 -right-1 w-5 h-5 bg-yellow-400 rounded-full flex items-center justify-center text-[10px] font-bold text-white shadow-sm border border-white"},ft={class:"flex-1 min-w-0"},kt={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},wt={class:"text-xs text-gray-500 truncate"},$t={class:"text-sm font-bold text-green-600"},Ct={key:0,class:"bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-800/30 rounded-xl p-4 flex items-start gap-4"},zt={class:"p-2 bg-red-100 dark:bg-red-900/30 rounded-full shrink-0"},jt={class:"flex-1"},Bt={class:"font-bold text-red-700 dark:text-red-400 text-sm"},qt={class:"flex flex-wrap gap-2"},Mt=["onClick"],Dt=["src"],Pt={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Vt={class:"text-xs text-red-500 font-bold"},At={key:0,class:"px-2 py-1 text-xs text-red-600 font-medium"},Et={key:1,class:"mb-4"},Tt={class:"flex flex-wrap items-center border-b bg-gray-50 dark:bg-gray-800 rounded-t-lg"},It={class:"mr-1"},St=["onClick"],Wt={key:0,class:"mr-1"},Ut={class:"flex flex-col sm:flex-row gap-3"},Nt={class:"relative flex-1"},Lt={class:"flex gap-2"},Rt={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 mr-2"},Ft={key:2,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},Ht={key:3,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},Ot={key:4,class:"overflow-x-auto bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},Gt={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},Qt={class:"px-4 py-3"},Yt={class:"px-4 py-3 font-medium text-gray-900 dark:text-white whitespace-nowrap"},Jt={class:"flex items-center gap-3"},Kt=["src"],Xt={class:"flex flex-col"},Zt={class:"text-xs text-gray-400"},es={class:"px-4 py-3 text-center"},ts={class:"flex flex-col items-center"},ss={class:"text-xs text-gray-400"},rs={class:"text-xs text-gray-400"},os={class:"px-4 py-3 text-center"},as={class:"px-4 py-3 text-center"},ds={class:"px-6 py-4"},ls={key:0,class:"flex items-center gap-1"},ns=["onUpdate:modelValue"],is=["onClick"],gs={key:1,class:"text-orange-600 font-medium"},cs={class:"px-4 py-3 text-center font-bold text-blue-700 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400"},us={class:"text-xs text-gray-400 font-normal"},xs={class:"px-4 py-3 text-center"},bs={key:0,class:"flex items-center justify-center gap-1"},ys=["onUpdate:modelValue"],ps=["onClick"],_s={key:1,class:"font-medium"},hs={class:"px-4 py-3 text-center"},ms={key:0,class:"bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300"},vs={key:1,class:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-red-900 dark:text-red-300"},fs={class:"px-4 py-3 text-center"},ks=["onClick"],ws={key:5,class:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6"},$s={class:"text-sm text-gray-500 dark:text-gray-400"},Cs={class:"flex gap-2"},zs=["disabled"],js={class:"flex items-center gap-1"},Bs=["onClick"],qs={key:1,class:"px-2"},Ms=["disabled"],Ds={key:6,class:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl"},Ps={class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"},Vs={class:"mt-2 text-gray-500 dark:text-gray-400"},As={key:0,class:"space-y-6 max-h-[70vh] overflow-y-auto pr-2"},Es={class:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-xl"},Ts={class:"text-center"},Is={class:"relative w-16 h-16 mx-auto"},Ss={class:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36"},Ws=["stroke-dasharray"],Us={class:"absolute inset-0 flex items-center justify-center"},Ns={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Ls={class:"text-center"},Rs={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},Fs={class:"text-2xl font-bold text-green-600 dark:text-green-400"},Hs={class:"text-xs text-gray-500 mt-2"},Os={class:"text-center"},Gs={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},Qs={class:"text-xl font-bold text-orange-600 dark:text-orange-400"},Ys={class:"text-xs text-gray-500 mt-2"},Js={class:"text-center"},Ks={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},Xs={class:"text-xl font-bold text-purple-600 dark:text-purple-400"},Zs={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},er={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},tr={class:"flex items-center justify-between mb-2"},sr={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},rr={class:"text-sm font-bold text-blue-600 dark:text-blue-400"},or={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},ar={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},dr={class:"flex items-center justify-between mb-2"},lr={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},nr={class:"text-sm font-bold text-orange-600 dark:text-orange-400"},ir={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},gr={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},cr={class:"flex items-center justify-between mb-2"},ur={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},xr={class:"text-sm font-bold text-purple-600 dark:text-purple-400"},br={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},yr={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},pr={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},_r={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},hr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},mr={class:"text-lg font-bold text-gray-900 dark:text-white"},vr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},fr={class:"text-lg font-bold text-gray-900 dark:text-white"},kr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},wr={class:"text-lg font-bold text-gray-900 dark:text-white"},$r={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},Cr={class:"text-lg font-bold text-gray-900 dark:text-white"},zr={class:"mt-3 flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},jr={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},Br={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},qr={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},Mr={key:0,class:"space-y-2"},Dr={class:"text-sm text-gray-700 dark:text-gray-300"},Pr={key:1,class:"text-sm text-gray-500 text-center py-4"},Vr={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Ar={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},Er={key:0,class:"space-y-2"},Tr={class:"text-sm text-gray-700 dark:text-gray-300"},Ir={class:"flex items-center gap-2"},Sr={key:0,class:"text-sm font-bold text-green-600 dark:text-green-400"},Wr={key:1,class:"text-sm text-gray-500 text-center py-4"},Ur={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Nr={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},Lr={key:0,class:"space-y-2"},Rr={class:"flex-1"},Fr={class:"text-sm text-gray-700 dark:text-gray-300"},Hr={key:0,class:"text-xs text-gray-400 ml-2"},Or={class:"flex items-center gap-2"},Gr={key:1,class:"text-sm text-gray-500 text-center py-4"},Qr={key:1,class:"flex flex-col items-center justify-center py-12"},Yr=H({__name:"ProgressList",props:{courseId:{},isCourseAdmin:{type:Boolean,default:!1}},setup(i){const v=i,f=de(),c=k([]),z=k(!0),w=k(""),_=k("progress"),q=k("desc"),M=k(!1),n=k(null),g=k(null),E=k([]),B=k("all"),D=k("grid"),h=k({current_page:1,last_page:1,total:0,per_page:20,from:0,to:0}),T=k({avg:0,min:0,max:0,completed:0,total:0}),I=async(l=1)=>{z.value=!0;try{const r={page:l,per_page:h.value.per_page,sort:_.value,order:q.value};B.value!=="all"&&(r.group_id=B.value),w.value&&(r.search=w.value);const y=await f.get(`/api/courses/${v.courseId}/progress`,{params:r});y.courseMembersProgress?c.value=y.courseMembersProgress.map(t=>({lessons_completed:t.lessons_completed,total_lessons:t.total_lessons,lessons_progress:t.lessons_progress,assignments_completed:t.assignments_completed,total_assignments:t.total_assignments,assignments_progress:t.assignments_progress,quizzes_completed:t.quizzes_completed,total_quizzes:t.total_quizzes,quizzes_progress:t.quizzes_progress,attendance_present:t.attendance_present,total_attendance:t.total_attendance,attendance_rate:t.attendance_rate,overall_progress:t.overall_progress,...t.progress,...t.member,scores:{...t.scores,original_bonus:t.scores?.bonus_points||0,original_edited_grade:t.scores?.edited_grade}})):c.value=[],E.value=y.groups||[],y.pagination&&(h.value=y.pagination),y.stats&&(T.value={...T.value,...y.stats})}catch(r){console.error("Error fetching progress:",r)}finally{z.value=!1}};G(B,()=>{I(1)});let O;G(w,l=>{clearTimeout(O),O=setTimeout(()=>{I(1)},500)});const N=l=>{l>=1&&l<=h.value.last_page&&I(l)},U=async l=>{n.value=l,M.value=!0;try{const r=await f.get(`/api/courses/${v.courseId}/members/${l.id}/progress`);g.value=r}catch(r){console.error("Error fetching member details:",r),g.value=null}},J=async()=>{try{const l=await f.get(`/api/courses/${v.courseId}/progress/export`,{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([l])),y=document.createElement("a");y.href=r,y.setAttribute("download",`course-progress-${v.courseId}.xlsx`),document.body.appendChild(y),y.click(),y.remove()}catch(l){console.error("Error exporting progress:",l)}},K=async l=>{const r=l.scores?.bonus_points||0,y=l.scores?.original_bonus||0;if(r!==y){if(r<0){l.scores.bonus_points=y;return}try{const t=await f.patch(`/api/courses/${v.courseId}/members/${l.id}/bonus-points`,{bonus_points:r}),$=(l.scores.bonus_points||0)-(l.scores.original_bonus||0);l.scores.total_score=(l.scores.total_score||0)+$,l.scores.original_bonus=l.scores.bonus_points,l.scores.grade_progress=t.grade_progress,l.scores.grade_name=t.grade_name}catch(t){console.error("Error updating bonus points:",t)}}},X=async l=>{try{const r=await f.patch(`/api/courses/${v.courseId}/members/${l.id}/edited-grade`,{edited_grade:l.scores.edited_grade});l.scores.original_edited_grade=l.scores.edited_grade,l.scores.grade_progress=r.edited_grade??l.scores.calculated_grade??r.grade_progress,l.scores.edited_grade=r.edited_grade,l.scores.grade_name=r.grade_name}catch(r){console.error("Error updating edited grade:",r)}},L=l=>{_.value===l?q.value=q.value==="asc"?"desc":"asc":(_.value=l,q.value="desc"),I(1)},Z=V(()=>{const l={A:0,"B+":0,B:0,"C+":0,C:0,"D+":0,D:0,F:0};return c.value.forEach(r=>{const y=r.scores?.grade_name||"F";l.hasOwnProperty(y)&&l[y]++}),l}),ee=V(()=>[...c.value].sort((l,r)=>(r.overall_progress||0)-(l.overall_progress||0)).slice(0,5)),S=V(()=>c.value.filter(l=>(l.overall_progress||0)<50)),te=V(()=>{if(c.value.length===0)return 0;const l=c.value.reduce((r,y)=>r+(y.overall_progress||0),0);return Math.round(l/c.value.length)}),se=V(()=>{if(c.value.length===0)return 0;const l=c.value.filter(r=>(r.overall_progress||0)>=50).length;return Math.round(l/c.value.length*100)});return le(()=>{I()}),(l,r)=>{const y=re;return a(),d("div",Ue,[e("div",Ne,[e("div",null,[r[12]||(r[12]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," ความคืบหน้าของผู้เรียน ",-1)),e("p",Le," ทั้งหมด "+o(s(c).length)+" คน ",1)]),i.isCourseAdmin?(a(),d("button",{key:0,onClick:J,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},[b(s(u),{icon:"fluent:arrow-download-24-regular",class:"w-5 h-5"}),r[13]||(r[13]=e("span",null,"ส่งออก Excel",-1))])):p("",!0)]),s(c).length>0?(a(),d("div",Re,[e("div",Fe,[e("div",He,[e("div",Oe,[e("div",Ge,[b(s(u),{icon:"fluent:people-community-24-filled",class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),e("div",null,[r[14]||(r[14]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ผู้เรียนทั้งหมด",-1)),e("div",Qe,o(s(T).total),1)])])]),e("div",Ye,[e("div",Je,[e("div",Ke,[b(s(u),{icon:"fluent:data-trending-24-filled",class:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})]),e("div",null,[r[15]||(r[15]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ความคืบหน้าเฉลี่ย",-1)),e("div",Xe,o(s(te))+"%",1)])])]),e("div",Ze,[e("div",et,[e("div",tt,[b(s(u),{icon:"fluent:checkmark-starburst-24-filled",class:"w-6 h-6 text-green-600 dark:text-green-400"})]),e("div",null,[r[16]||(r[16]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ผ่านเกณฑ์ (>50%)",-1)),e("div",st,o(s(se))+"%",1)])])]),e("div",rt,[e("div",ot,[e("div",at,[b(s(u),{icon:"fluent:trophy-24-filled",class:"w-6 h-6 text-teal-600 dark:text-teal-400"})]),e("div",null,[r[17]||(r[17]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"เรียนจบแล้ว",-1)),e("div",dt,o(s(T).completed),1)])])])]),e("div",lt,[e("div",nt,[e("h4",it,[b(s(u),{icon:"fluent:chart-person-24-regular",class:"w-5 h-5"}),r[18]||(r[18]=m(" การกระจายเกรด (Grade Distribution) ",-1))]),e("div",gt,[(a(!0),d(C,null,j(s(Z),(t,$)=>(a(),d("div",{key:$,class:"flex-1 flex flex-col items-center justify-end h-full gap-2 group relative"},[e("div",ct,o(t)+" คน ",1),e("div",{class:"w-full max-w-[40px] bg-blue-100 dark:bg-blue-900/30 rounded-t-md relative overflow-hidden transition-all duration-500 hover:bg-blue-200 dark:hover:bg-blue-800/50",style:A({height:`${Math.max(t/s(c).length*100,4)}%`})},[t>0?(a(),d("div",ut)):p("",!0)],4),e("div",xt,o($),1)]))),128))])]),e("div",bt,[e("h4",yt,[b(s(u),{icon:"fluent:ribbon-star-24-filled",class:"w-5 h-5 text-yellow-500"}),r[19]||(r[19]=m(" Top Performers ",-1))]),e("div",pt,[(a(!0),d(C,null,j(s(ee),(t,$)=>(a(),d("div",{key:t.id,class:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:P=>U(t)},[e("div",ht,[e("img",{src:t.user?.avatar||"/images/default-avatar.png",class:"w-10 h-10 rounded-full object-cover border border-gray-200"},null,8,mt),$<3?(a(),d("div",vt,o($+1),1)):p("",!0)]),e("div",ft,[e("p",kt,o(t.user?.name),1),e("p",wt,o(t.scores?.grade_name||"-")+" • "+o(t.overall_progress||0)+"%",1)]),e("div",$t,o(t.scores?.total_score||0),1)],8,_t))),128))])])]),s(S).length>0?(a(),d("div",Ct,[e("div",zt,[b(s(u),{icon:"fluent:alert-24-filled",class:"w-6 h-6 text-red-600 dark:text-red-400"})]),e("div",jt,[e("h4",Bt,"ต้องการความช่วยเหลือ ("+o(s(S).length)+" คน)",1),r[20]||(r[20]=e("p",{class:"text-xs text-red-600/80 dark:text-red-400/80 mt-1 mb-2"},"นักเรียนกลุ่มนี้มีความคืบหน้าน้อยกว่า 50% หรือคะแนนต่ำกว่าเกณฑ์",-1)),e("div",qt,[(a(!0),d(C,null,j(s(S).slice(0,5),t=>(a(),d("div",{key:t.id,class:"flex items-center gap-1.5 bg-white dark:bg-gray-800 px-2 py-1 rounded-md border border-red-100 dark:border-red-900/30 shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:$=>U(t)},[e("img",{src:t.user?.avatar||"/images/default-avatar.png",class:"w-5 h-5 rounded-full"},null,8,Dt),e("span",Pt,o(t.user?.name),1),e("span",Vt,"("+o(t.overall_progress)+"%)",1)],8,Mt))),128)),s(S).length>5?(a(),d("div",At," + อีก "+o(s(S).length-5)+" คน ",1)):p("",!0)])])])):p("",!0)])):p("",!0),i.isCourseAdmin&&(s(E).length>0||s(c).some(t=>!t.group_id))?(a(),d("div",Et,[e("ul",Tt,[e("li",It,[e("button",{onClick:r[0]||(r[0]=t=>B.value="all"),class:x(["px-4 py-2 text-sm font-medium rounded-t-lg",s(B)==="all"?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])}," ทั้งหมด ("+o(s(c).length)+") ",3)]),(a(!0),d(C,null,j(s(E),t=>(a(),d("li",{key:t.id,class:"mr-1"},[e("button",{onClick:$=>B.value=t.id,class:x(["px-4 py-2 text-sm font-medium rounded-t-lg",s(B)===t.id?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])},o(t.name),11,St)]))),128)),s(c).some(t=>!t.group_id)?(a(),d("li",Wt,[e("button",{onClick:r[1]||(r[1]=t=>B.value="ungrouped"),class:x(["px-4 py-2 text-sm font-medium rounded-t-lg",s(B)==="ungrouped"?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])}," ไม่มีกลุ่ม ",2)])):p("",!0)])])):p("",!0),e("div",Ut,[e("div",Nt,[b(s(u),{icon:"fluent:search-24-regular",class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),R(e("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>ne(w)?w.value=t:null),type:"text",placeholder:"ค้นหาผู้เรียน...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[Q,s(w)]])]),e("div",Lt,[e("div",Rt,[e("button",{onClick:r[3]||(r[3]=t=>D.value="grid"),class:x(["p-1.5 rounded-md transition-colors",s(D)==="grid"?"bg-white dark:bg-gray-600 shadow text-blue-600":"text-gray-500 hover:text-gray-700"])},[b(s(u),{icon:"fluent:grid-24-regular",class:"w-5 h-5"})],2),e("button",{onClick:r[4]||(r[4]=t=>D.value="table"),class:x(["p-1.5 rounded-md transition-colors",s(D)==="table"?"bg-white dark:bg-gray-600 shadow text-blue-600":"text-gray-500 hover:text-gray-700"])},[b(s(u),{icon:"fluent:table-24-regular",class:"w-5 h-5"})],2)]),e("button",{onClick:r[5]||(r[5]=t=>L("name")),class:x(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",s(_)==="name"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[r[21]||(r[21]=m(" ชื่อ ",-1)),s(_)==="name"?(a(),W(s(u),{key:0,icon:s(q)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):p("",!0)],2),e("button",{onClick:r[6]||(r[6]=t=>L("progress")),class:x(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",s(_)==="progress"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[r[22]||(r[22]=m(" ความคืบหน้า ",-1)),s(_)==="progress"?(a(),W(s(u),{key:0,icon:s(q)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):p("",!0)],2),e("button",{onClick:r[7]||(r[7]=t=>L("last_activity")),class:x(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",s(_)==="last_activity"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[r[23]||(r[23]=m(" ล่าสุด ",-1)),s(_)==="last_activity"?(a(),W(s(u),{key:0,icon:s(q)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):p("",!0)],2)])]),s(z)?(a(),d("div",Ft,[(a(),d(C,null,j(6,t=>b(We,{key:t})),64))])):s(c).length>0&&s(D)==="grid"?(a(),d("div",Ht,[(a(!0),d(C,null,j(s(c),t=>(a(),W(Ee,{key:t.id,member:t,"is-course-admin":i.isCourseAdmin,onViewDetails:U},null,8,["member","is-course-admin"]))),128))])):s(c).length>0&&s(D)==="table"?(a(),d("div",Ot,[e("table",Gt,[r[27]||(r[27]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-300"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 min-w-[50px]"},"#"),e("th",{scope:"col",class:"px-4 py-3 min-w-[200px]"},"สมาชิก"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"บทเรียน"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"งาน"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"ทดสอบ"),e("th",{scope:"col",class:"px-6 py-3 min-w-[120px]"}," พิเศษ "),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"}," รวม "),e("th",{scope:"col",class:"px-4 py-3 text-center"},"เกรด"),e("th",{scope:"col",class:"px-4 py-3 text-center min-w-[120px]"},"เกรดแก้"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"สถานะ"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"จัดการ")])],-1)),e("tbody",null,[(a(!0),d(C,null,j(s(c),(t,$)=>(a(),d("tr",{key:t.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",Qt,o($+1),1),e("td",Yt,[e("div",Jt,[e("img",{src:t.user?.avatar||"https://ui-avatars.com/api/?name="+t.user?.name,class:"w-8 h-8 rounded-full",alt:""},null,8,Kt),e("div",Xt,[e("span",null,o(t.user?.name),1),e("span",Zt,o(t.member_code||"-"),1)])])]),e("td",es,[e("div",ts,[e("span",ss,"งาน: "+o(t.scores?.lesson_assignments||0),1),e("span",rs,"สอบ: "+o(t.scores?.lesson_quizzes||0),1)])]),e("td",os,o(t.scores?.course_assignments||0),1),e("td",as,o(t.scores?.course_quizzes||0),1),e("td",ds,[i.isCourseAdmin?(a(),d("div",ls,[R(e("input",{type:"number","onUpdate:modelValue":P=>t.scores.bonus_points=P,class:"w-16 px-2 py-1 text-sm border rounded focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",min:"0"},null,8,ns),[[Q,t.scores.bonus_points,void 0,{number:!0}]]),t.scores.bonus_points!==t.scores.original_bonus?(a(),d("button",{key:0,onClick:P=>K(t),class:"p-1 text-green-600 hover:bg-green-100 rounded dark:hover:bg-green-900/30",title:"บันทึก"},[...r[24]||(r[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)])],8,is)):p("",!0)])):(a(),d("span",gs,o(t.scores?.bonus_points||0),1))]),e("td",cs,o(t.scores?.total_score||0),1),e("td",{class:x(["px-4 py-3 text-center font-bold text-lg",{"text-green-600 dark:text-green-400":(t.scores?.grade_progress||0)>=2,"text-red-600 dark:text-red-400":(t.scores?.grade_progress||0)<1}])},[m(o(t.scores?.grade_name||"-")+" ",1),e("span",us,"("+o(t.scores?.grade_progress||0)+")",1)],2),e("td",xs,[i.isCourseAdmin?(a(),d("div",bs,[R(e("select",{"onUpdate:modelValue":P=>t.scores.edited_grade=P,class:"w-20 px-2 py-1 text-sm border rounded focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[...r[25]||(r[25]=[e("option",{value:null},"-",-1),e("option",{value:1},"1 (D)",-1),e("option",{value:1.5},"1.5 (D+)",-1),e("option",{value:2},"2 (C)",-1),e("option",{value:2.5},"2.5 (C+)",-1),e("option",{value:3},"3 (B)",-1),e("option",{value:3.5},"3.5 (B+)",-1),e("option",{value:4},"4 (A)",-1)])],8,ys),[[ie,t.scores.edited_grade,void 0,{number:!0}]]),t.scores.edited_grade!==t.scores.original_edited_grade?(a(),d("button",{key:0,onClick:P=>X(t),class:"p-1 text-blue-600 hover:bg-blue-100 rounded dark:hover:bg-blue-900/30",title:"บันทึกเกรดแก้"},[...r[26]||(r[26]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)])],8,ps)):p("",!0)])):(a(),d("span",_s,o(t.scores?.edited_grade||"-"),1))]),e("td",hs,[t.course_member_status===1?(a(),d("span",ms,"ปกติ")):(a(),d("span",vs,"พัก"))]),e("td",fs,[e("button",{onClick:P=>U(t),class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-xs"}," รายละเอียด ",8,ks)])]))),128))])])])):p("",!0),s(c).length>0?(a(),d("div",ws,[e("span",$s," แสดง "+o(s(h).from)+"-"+o(s(h).to)+" จากทั้งหมด "+o(s(h).total)+" รายการ ",1),e("div",Cs,[e("button",{onClick:r[8]||(r[8]=t=>N(s(h).current_page-1)),disabled:s(h).current_page===1,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-600 dark:hover:bg-gray-700"}," ก่อนหน้า ",8,zs),e("div",js,[(a(!0),d(C,null,j(s(h).last_page,t=>(a(),d(C,{key:t},[Math.abs(t-s(h).current_page)<=2||t===1||t===s(h).last_page?(a(),d("button",{key:0,onClick:$=>N(t),class:x(["px-3 py-1 text-sm border rounded-lg",t===s(h).current_page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700"])},o(t),11,Bs)):Math.abs(t-s(h).current_page)===3?(a(),d("span",qs,"...")):p("",!0)],64))),128))]),e("button",{onClick:r[9]||(r[9]=t=>N(s(h).current_page+1)),disabled:s(h).current_page===s(h).last_page,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-600 dark:hover:bg-gray-700"}," ถัดไป ",8,Ms)])])):(a(),d("div",Ds,[b(s(u),{icon:"fluent:data-area-24-regular",class:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),e("h3",Ps,o(s(w)?"ไม่พบผู้เรียน":"ยังไม่มีข้อมูลความคืบหน้า"),1),e("p",Vs,o(s(w)?"ลองค้นหาด้วยคำอื่น":"ยังไม่มีผู้เรียนในคอร์สนี้"),1)])),b(y,{show:s(M),onClose:r[11]||(r[11]=t=>M.value=!1),"max-width":"2xl"},{title:F(()=>[m(" รายละเอียดความคืบหน้า - "+o(s(n)?.user?.name),1)]),content:F(()=>[s(g)?(a(),d("div",As,[e("div",Es,[e("div",Ts,[e("div",Is,[(a(),d("svg",Ss,[r[28]||(r[28]=e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3",class:"text-gray-200 dark:text-gray-600"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round",class:"text-blue-500","stroke-dasharray":`${s(n)?.overall_progress||0} 100`},null,8,Ws)])),e("div",Us,[e("span",Ns,o(s(n)?.overall_progress||0)+"%",1)])]),r[29]||(r[29]=e("p",{class:"text-xs text-gray-500 mt-2"},"ความคืบหน้า",-1))]),e("div",Ls,[e("div",Rs,[e("span",Fs,o(s(n)?.scores?.grade_name||"-"),1)]),e("p",Hs,"เกรด ("+o(s(n)?.scores?.grade_progress||0)+")",1)]),e("div",Os,[e("div",Gs,[e("span",Qs,o(s(n)?.attendance_rate||0)+"%",1)]),e("p",Ys,"เข้าเรียน ("+o(s(n)?.attendance_present||0)+"/"+o(s(n)?.total_attendance||0)+")",1)]),e("div",Js,[e("div",Ks,[e("span",Xs,o(s(n)?.scores?.total_score||0),1)]),r[30]||(r[30]=e("p",{class:"text-xs text-gray-500 mt-2"},"คะแนนรวม",-1))])]),e("div",Zs,[e("div",er,[e("div",tr,[e("span",sr,[b(s(u),{icon:"fluent:book-24-regular",class:"w-4 h-4 text-blue-500"}),r[31]||(r[31]=m(" บทเรียน ",-1))]),e("span",rr,o(s(n)?.lessons_completed||0)+"/"+o(s(n)?.total_lessons||0),1)]),e("div",or,[e("div",{class:"h-full rounded-full bg-blue-500 transition-all duration-500",style:A({width:`${s(n)?.lessons_progress||0}%`})},null,4)])]),e("div",ar,[e("div",dr,[e("span",lr,[b(s(u),{icon:"fluent:document-text-24-regular",class:"w-4 h-4 text-orange-500"}),r[32]||(r[32]=m(" งาน ",-1))]),e("span",nr,o(s(n)?.assignments_completed||0)+"/"+o(s(n)?.total_assignments||0),1)]),e("div",ir,[e("div",{class:"h-full rounded-full bg-orange-500 transition-all duration-500",style:A({width:`${s(n)?.assignments_progress||0}%`})},null,4)])]),e("div",gr,[e("div",cr,[e("span",ur,[b(s(u),{icon:"fluent:quiz-new-24-regular",class:"w-4 h-4 text-purple-500"}),r[33]||(r[33]=m(" ทดสอบ ",-1))]),e("span",xr,o(s(n)?.quizzes_completed||0)+"/"+o(s(n)?.total_quizzes||0),1)]),e("div",br,[e("div",{class:"h-full rounded-full bg-purple-500 transition-all duration-500",style:A({width:`${s(n)?.quizzes_progress||0}%`})},null,4)])])]),e("div",yr,[e("h4",pr,[b(s(u),{icon:"fluent:chart-multiple-24-regular",class:"w-5 h-5 text-blue-500"}),r[34]||(r[34]=m(" รายละเอียดคะแนน ",-1))]),e("div",_r,[e("div",hr,[e("div",mr,o(s(n)?.scores?.lesson_assignments||0),1),r[35]||(r[35]=e("p",{class:"text-xs text-gray-500"},"งานบทเรียน",-1))]),e("div",vr,[e("div",fr,o(s(n)?.scores?.lesson_quizzes||0),1),r[36]||(r[36]=e("p",{class:"text-xs text-gray-500"},"ทดสอบบทเรียน",-1))]),e("div",kr,[e("div",wr,o(s(n)?.scores?.course_assignments||0),1),r[37]||(r[37]=e("p",{class:"text-xs text-gray-500"},"งานรายวิชา",-1))]),e("div",$r,[e("div",Cr,o(s(n)?.scores?.course_quizzes||0),1),r[38]||(r[38]=e("p",{class:"text-xs text-gray-500"},"ทดสอบรายวิชา",-1))])]),e("div",zr,[r[39]||(r[39]=e("span",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"คะแนนพิเศษ (Bonus)",-1)),e("span",jr,"+"+o(s(n)?.scores?.bonus_points||0),1)])]),e("div",Br,[e("h4",qr,[b(s(u),{icon:"fluent:book-24-regular",class:"w-5 h-5 text-blue-500"}),r[40]||(r[40]=m(" บทเรียน ",-1))]),s(g).lessons&&s(g).lessons.length>0?(a(),d("div",Mr,[(a(!0),d(C,null,j(s(g).lessons,t=>(a(),d("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("span",Dr,o(t.title),1),e("span",{class:x(["text-xs px-2 py-1 rounded-full",t.completed?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"])},o(t.completed?"เรียนจบแล้ว":"ยังไม่เริ่ม"),3)]))),128))])):(a(),d("p",Pr,"ไม่มีข้อมูลบทเรียน"))]),e("div",Vr,[e("h4",Ar,[b(s(u),{icon:"fluent:document-text-24-regular",class:"w-5 h-5 text-orange-500"}),r[41]||(r[41]=m(" งานที่มอบหมาย ",-1))]),s(g).assignments&&s(g).assignments.length>0?(a(),d("div",Er,[(a(!0),d(C,null,j(s(g).assignments,t=>(a(),d("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("span",Tr,o(t.title),1),e("div",Ir,[t.graded?(a(),d("span",Sr,o(t.score)+"/"+o(t.max_score),1)):p("",!0),e("span",{class:x(["text-xs px-2 py-1 rounded-full whitespace-nowrap",t.status==="graded"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":t.status==="in_review"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":t.status==="submitted"?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400"])},o(t.status==="graded"?"ตรวจแล้ว":t.status==="in_review"?"กำลังตรวจ":t.status==="submitted"?"รอตรวจ":"ยังไม่ส่ง"),3)])]))),128))])):(a(),d("p",Wr,"ไม่มีข้อมูลงานที่มอบหมาย"))]),e("div",Ur,[e("h4",Nr,[b(s(u),{icon:"fluent:quiz-new-24-regular",class:"w-5 h-5 text-purple-500"}),r[42]||(r[42]=m(" แบบทดสอบ ",-1))]),s(g).quizzes&&s(g).quizzes.length>0?(a(),d("div",Lr,[(a(!0),d(C,null,j(s(g).quizzes,t=>(a(),d("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("div",Rr,[e("span",Fr,o(t.title),1),t.attempt_count>0?(a(),d("span",Hr," (ทำ "+o(t.attempt_count)+" ครั้ง) ",1)):p("",!0)]),e("div",Or,[t.completed?(a(),d("span",{key:0,class:x(["text-sm font-bold",t.passed===!1?"text-red-500":"text-green-600 dark:text-green-400"])},o(t.score)+"/"+o(t.max_score),3)):p("",!0),e("span",{class:x(["text-xs px-2 py-1 rounded-full whitespace-nowrap",t.completed?t.passed===!1?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"])},o(t.completed?t.passed===!1?"ไม่ผ่าน":"ผ่าน":"ยังไม่ได้ทำ"),3)])]))),128))])):(a(),d("p",Gr,"ไม่มีข้อมูลแบบทดสอบ"))])])):(a(),d("div",Qr,[...r[43]||(r[43]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-500"},"กำลังโหลดข้อมูล...",-1)])]))]),footer:F(()=>[e("button",{onClick:r[10]||(r[10]=t=>M.value=!1),class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600"}," ปิด ")]),_:1},8,["show"])])}}}),Zr=H({__name:"progress",setup(i){const v=Y("course"),f=Y("isCourseAdmin");return(c,z)=>(a(),d("div",null,[s(v)?.id?(a(),W(Yr,{key:0,"course-id":s(v).id,"is-course-admin":s(f)},null,8,["course-id","is-course-admin"])):p("",!0)]))}});export{Zr as default};
