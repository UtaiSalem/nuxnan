import{_ as X}from"./D1c4_Teu.js";import{_ as Z}from"./fgoR5NrX.js";import{z as P,az as ee,a4 as C,N as j,af as te,r as b,c as l,d as h,u as t,a as e,b as i,e as m,ay as se,j as S,t as c,F as I,n as L,w as re,q as M,Y as D,Q as z,o as n,I as o}from"./DuB962GZ.js";const ae={key:0,class:"space-y-6"},oe={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ie={class:"lg:col-span-2 space-y-6"},ne={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},le={class:"flex items-center justify-between mb-4"},de={class:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2"},ce={key:0,class:"text-gray-600 dark:text-gray-400 leading-relaxed prose dark:prose-invert max-w-none"},ue=["innerHTML"],ge={key:1,class:"text-gray-400 italic"},me={key:1,class:"space-y-4"},pe={class:"flex items-center justify-end gap-3"},ye=["disabled"],fe=["disabled"],xe={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},be={class:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2"},he={class:"flex items-center gap-4"},_e=["src","alt"],ve={class:"flex-1"},ke={class:"font-semibold text-gray-900 dark:text-white text-lg"},we={class:"text-gray-500 dark:text-gray-400 text-sm"},Ce={class:"px-4 py-2 border border-blue-500 text-blue-500 rounded-lg font-medium hover:bg-blue-500 hover:text-white transition-colors"},je={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6"},De={class:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2"},Ae={class:"space-y-2"},$e=["onClick"],Se={class:"font-medium text-gray-900 dark:text-white"},Be={class:"flex items-center gap-3 text-gray-500 text-sm"},Ne={key:0,class:"divide-y divide-gray-200 dark:divide-gray-600"},Ee={class:"flex items-center gap-3"},Te={class:"text-gray-700 dark:text-gray-300 text-sm"},Ve={class:"text-gray-500 text-sm"},Fe={class:"space-y-6"},Ie={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 sticky top-24"},Le={class:"relative aspect-video bg-gray-200 dark:bg-gray-700 rounded-lg overflow-hidden mb-4"},Me=["src","alt"],ze={class:"absolute inset-0 flex items-center justify-center bg-black/30"},He={class:"w-14 h-14 bg-blue-500 rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors shadow-lg"},Re={key:0,class:"text-center mb-4"},We={class:"text-3xl font-bold text-gray-900 dark:text-white"},Ue={class:"space-y-3 mb-6"},qe=["disabled"],Oe={class:"space-y-3 text-sm"},Qe={class:"flex items-center justify-between text-gray-600 dark:text-gray-400"},Ye={class:"flex items-center gap-2"},Ge={class:"font-medium text-gray-900 dark:text-white"},Je={class:"flex items-center justify-between text-gray-600 dark:text-gray-400"},Ke={class:"flex items-center gap-2"},Xe={class:"font-medium text-gray-900 dark:text-white"},Ze={key:0,class:"flex items-center justify-between text-gray-600 dark:text-gray-400"},Pe={class:"flex items-center gap-2"},et={class:"font-medium text-gray-900 dark:text-white"},tt={class:"flex items-center justify-between text-gray-600 dark:text-gray-400"},st={class:"flex items-center gap-2"},rt={class:"font-medium text-gray-900 dark:text-white"},at={class:"flex items-center justify-between text-gray-600 dark:text-gray-400"},ot={class:"flex items-center gap-2"},it={class:"font-medium text-gray-900 dark:text-white"},nt={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},lt={class:"space-y-2 text-sm text-gray-600 dark:text-gray-400"},dt={class:"flex items-center gap-2"},ct={class:"flex items-center gap-2"},ut={class:"flex items-center gap-2"},yt=P({__name:"index",props:{course:{},academy:{},isCourseAdmin:{type:Boolean}},setup(H){const y=H,B=D("course"),N=D("academy"),E=D("isCourseAdmin"),T=D("refreshCourse"),u=ee();C([()=>y.course,B],([r,s])=>{const d=r||s;d&&u.setCourse(d)},{immediate:!0}),C([()=>y.academy,N],([r,s])=>{const d=r||s;d&&u.setAcademy(d)},{immediate:!0}),C([()=>y.isCourseAdmin,E],([r,s])=>{const d=r||s||!1;u.setIsCourseAdmin(d)},{immediate:!0});const a=j(()=>y.course||B?.value||u.currentCourse);j(()=>y.academy||N?.value||u.academy);const R=j(()=>y.isCourseAdmin||E?.value||u.isCourseAdmin),V=te(),w=b(!1),_=b(!1),v=b([0]),f=b(!1),g=b(""),k=b(!1);C(()=>a.value?.description,r=>{r&&!f.value&&(g.value=r)},{immediate:!0});const W=()=>{g.value=a.value?.description||"",f.value=!0},U=()=>{g.value=a.value?.description||"",f.value=!1},q=async()=>{if(a.value){k.value=!0;try{(await V.put(`/api/courses/${a.value.id}`,{description:g.value})).success&&(f.value=!1,u.updateCourse({description:g.value}),T&&T())}catch(r){alert(r.data?.msg||"ไม่สามารถบันทึกได้")}finally{k.value=!1}}},A=j(()=>a.value?.lessons?.length?a.value.lessons.map((r,s)=>({id:r.id,title:`${s+1}. ${r.name}`,videos:r.topics_count||0,items:r.topics?.map(d=>({id:d.id,title:d.name,duration:d.duration||"15min",type:d.is_preview?"video":"locked"}))||[]})):[]),O=r=>{const s=v.value.indexOf(r);s>-1?v.value.splice(s,1):v.value.push(r)},Q=async()=>{if(a.value){w.value=!0;try{const r=await V.post(`/api/courses/${a.value.id}/members`);r.success&&(a.value.isMember=!0,a.value.member_status=r.memberStatus,u.updateCourse({isMember:!0,member_status:r.memberStatus}))}catch(r){alert(r.data?.msg||"ไม่สามารถสมัครเรียนได้")}finally{w.value=!1}}},Y=()=>{_.value=!_.value},G=r=>r?r.startsWith("http")?r:`${z().public.apiBase}/storage/images/courses/covers/${r}`:`${z().public.apiBase}/storage/images/courses/covers/default_cover.jpg`,F=r=>r?new Date(r).toLocaleDateString("th-TH",{year:"numeric",month:"short",day:"numeric"}):"-",J=r=>new Intl.NumberFormat("th-TH",{minimumFractionDigits:0,maximumFractionDigits:0}).format(r||0);return(r,s)=>{const d=X,K=Z;return t(a)?(n(),l("div",ae,[e("div",oe,[e("div",ie,[e("div",ne,[e("div",le,[e("h3",de,[i(t(o),{icon:"fluent:text-description-24-regular",class:"w-5 h-5 text-blue-500"}),s[1]||(s[1]=m(" รายละเอียดรายวิชา ",-1))]),t(R)&&!t(f)?(n(),l("button",{key:0,onClick:W,class:"flex items-center gap-1 px-3 py-1.5 text-sm text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors"},[i(t(o),{icon:"fluent:edit-24-regular",class:"w-4 h-4"}),s[2]||(s[2]=m(" แก้ไข ",-1))])):h("",!0)]),t(f)?(n(),l("div",me,[i(d,{modelValue:t(g),"onUpdate:modelValue":s[0]||(s[0]=p=>se(g)?g.value=p:null),placeholder:"เขียนรายละเอียดรายวิชาที่นี่...","min-height":"250px"},null,8,["modelValue"]),e("div",pe,[e("button",{onClick:U,disabled:t(k),class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors disabled:opacity-50"}," ยกเลิก ",8,ye),e("button",{onClick:q,disabled:t(k),class:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50"},[t(k)?(n(),S(t(o),{key:0,icon:"svg-spinners:ring-resize",class:"w-4 h-4"})):(n(),S(t(o),{key:1,icon:"fluent:save-24-regular",class:"w-4 h-4"})),s[3]||(s[3]=m(" บันทึก ",-1))],8,fe)])])):(n(),l("div",ce,[t(a).description?(n(),l("div",{key:0,innerHTML:t(a).description},null,8,ue)):(n(),l("p",ge,"ไม่มีรายละเอียด"))]))]),e("div",xe,[e("h3",be,[i(t(o),{icon:"fluent:person-24-regular",class:"w-5 h-5 text-blue-500"}),s[4]||(s[4]=m(" ผู้สอน ",-1))]),e("div",he,[e("img",{src:t(a).user?.avatar||"/images/default-avatar.png",alt:t(a).user?.name,class:"w-16 h-16 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700"},null,8,_e),e("div",ve,[e("p",ke,c(t(a).user?.name||"ผู้สอน"),1),e("p",we,c(t(a).user?.bio||"ไม่มีข้อมูล"),1)]),e("button",Ce,[i(t(o),{icon:"fluent:person-add-24-regular",class:"w-5 h-5"})])])]),t(A).length>0?(n(),l("div",je,[e("h3",De,[i(t(o),{icon:"fluent:book-24-regular",class:"w-5 h-5 text-blue-500"}),s[5]||(s[5]=m(" เนื้อหาบทเรียน ",-1))]),e("div",Ae,[(n(!0),l(I,null,L(t(A),(p,$)=>(n(),l("div",{key:p.id,class:"border border-gray-200 dark:border-gray-600 rounded-lg overflow-hidden"},[e("button",{onClick:x=>O($),class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-700/50 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[e("span",Se,c(p.title),1),e("div",Be,[e("span",null,c(p.videos)+" หัวข้อ",1),i(t(o),{icon:t(v).includes($)?"fluent:chevron-up-24-regular":"fluent:chevron-down-24-regular",class:"w-5 h-5"},null,8,["icon"])])],8,$e),t(v).includes($)&&p.items.length>0?(n(),l("div",Ne,[(n(!0),l(I,null,L(p.items,x=>(n(),l("div",{key:x.id,class:"px-4 py-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors"},[e("div",Ee,[i(t(o),{icon:x.type==="locked"?"fluent:lock-closed-24-regular":"fluent:play-circle-24-regular",class:M(["w-5 h-5",x.type==="locked"?"text-gray-400":"text-blue-500"])},null,8,["icon","class"]),e("span",Te,c(x.title),1)]),e("span",Ve,c(x.duration),1)]))),128))])):h("",!0)]))),128))])])):h("",!0)]),e("div",Fe,[e("div",Ie,[e("div",Le,[e("img",{src:G(t(a).cover),alt:t(a).name,class:"w-full h-full object-cover"},null,8,Me),e("div",ze,[e("button",He,[i(t(o),{icon:"fluent:play-24-filled",class:"w-7 h-7 text-white ml-1"})])])]),t(a).price?(n(),l("div",Re,[e("span",We," ฿"+c(J(t(a).price)),1)])):h("",!0),e("div",Ue,[t(a).isMember?(n(),S(K,{key:1,to:`/courses/${t(a).id}/lessons`,class:"w-full py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition-colors flex items-center justify-center gap-2"},{default:re(()=>[i(t(o),{icon:"fluent:play-24-filled",class:"w-5 h-5"}),s[6]||(s[6]=m(" เข้าเรียน ",-1))]),_:1},8,["to"])):(n(),l("button",{key:0,onClick:Q,disabled:t(w),class:"w-full py-3 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition-colors flex items-center justify-center gap-2 disabled:opacity-50"},[i(t(o),{icon:"fluent:add-24-regular",class:"w-5 h-5"}),m(" "+c(t(w)?"กำลังสมัคร...":"สมัครเรียน"),1)],8,qe)),e("button",{onClick:Y,class:M(["w-full py-3 rounded-lg font-medium flex items-center justify-center gap-2 transition-colors",t(_)?"bg-red-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[i(t(o),{icon:t(_)?"fluent:heart-24-filled":"fluent:heart-24-regular",class:"w-5 h-5"},null,8,["icon"]),m(" "+c(t(_)?"เพิ่มในรายการโปรดแล้ว":"เพิ่มในรายการโปรด"),1)],2)]),e("div",Oe,[e("div",Qe,[e("div",Ye,[i(t(o),{icon:"fluent:people-24-regular",class:"w-5 h-5"}),s[7]||(s[7]=e("span",null,"ผู้เรียน",-1))]),e("span",Ge,c(t(a).enrolled_students||0)+" คน",1)]),e("div",Je,[e("div",Ke,[i(t(o),{icon:"fluent:book-24-regular",class:"w-5 h-5"}),s[8]||(s[8]=e("span",null,"บทเรียน",-1))]),e("span",Xe,c(t(a).lessons_count||t(A).length)+" บท",1)]),t(a).duration?(n(),l("div",Ze,[e("div",Pe,[i(t(o),{icon:"fluent:clock-24-regular",class:"w-5 h-5"}),s[9]||(s[9]=e("span",null,"ระยะเวลา",-1))]),e("span",et,c(t(a).duration),1)])):h("",!0),e("div",tt,[e("div",st,[i(t(o),{icon:"fluent:calendar-24-regular",class:"w-5 h-5"}),s[10]||(s[10]=e("span",null,"เริ่มเรียน",-1))]),e("span",rt,c(F(t(a).start_date)),1)]),e("div",at,[e("div",ot,[i(t(o),{icon:"fluent:calendar-checkmark-24-regular",class:"w-5 h-5"}),s[11]||(s[11]=e("span",null,"สิ้นสุด",-1))]),e("span",it,c(F(t(a).end_date)),1)])]),e("div",nt,[s[15]||(s[15]=e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"สิ่งที่จะได้รับ",-1)),e("ul",lt,[e("li",dt,[i(t(o),{icon:"fluent:checkmark-circle-24-filled",class:"w-5 h-5 text-green-500"}),s[12]||(s[12]=e("span",null,"เข้าถึงเนื้อหาได้ตลอดชีพ",-1))]),e("li",ct,[i(t(o),{icon:"fluent:checkmark-circle-24-filled",class:"w-5 h-5 text-green-500"}),s[13]||(s[13]=e("span",null,"ใบประกาศนียบัตร",-1))]),e("li",ut,[i(t(o),{icon:"fluent:checkmark-circle-24-filled",class:"w-5 h-5 text-green-500"}),s[14]||(s[14]=e("span",null,"รองรับทุกอุปกรณ์",-1))])])])])])])])):h("",!0)}}});export{yt as default};
