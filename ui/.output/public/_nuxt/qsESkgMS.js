import{_ as $}from"./BP2gnDQ3.js";import{q as C,a9 as j,y as B,o as t,c as s,a as e,F as p,k as f,g as A,w as F,u as l,t as x,b as _,I as b,p as L,r as g,a6 as V,l as W,d as w,T as I}from"./Brb_7992.js";const S={class:"bg-white dark:bg-vikinger-dark-200 rounded-xl p-4 shadow-sm mb-6"},T={key:0,class:"space-y-3"},q={key:1,class:"space-y-3"},z={class:"relative shrink-0 w-12 h-12"},D=["src","alt"],E={class:"flex-1 min-w-0"},P={class:"text-sm font-medium text-gray-900 dark:text-white truncate group-hover:text-vikinger-purple transition-colors"},U={class:"flex items-center gap-2 mt-1"},G={class:"text-xs text-gray-500 dark:text-gray-400"},H={class:"flex items-center justify-center text-gray-400 group-hover:text-vikinger-purple group-hover:translate-x-1 transition-all"},J={key:2,class:"text-center py-4 text-gray-500 dark:text-gray-400 text-sm"},ie=C({__name:"RecentlyViewedCoursesWidget",setup(M){const k=j(),h=L(),u=g([]),n=g(!0),v=async()=>{n.value=!0;try{const d=await k.get("/api/me/recent-courses");d.success&&(u.value=d.courses.slice(0,5))}catch(d){console.error("Failed to fetch recent courses",d)}finally{n.value=!1}};return B(()=>{v()}),(d,c)=>{const m=$;return t(),s("div",S,[c[2]||(c[2]=e("h3",{class:"font-semibold text-gray-900 dark:text-white mb-4"},"เข้าชมล่าสุด",-1)),n.value?(t(),s("div",T,[(t(),s(p,null,f(3,a=>e("div",{key:a,class:"flex gap-3 animate-pulse"},[...c[0]||(c[0]=[e("div",{class:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-lg shrink-0"},null,-1),e("div",{class:"flex-1 space-y-2 py-1"},[e("div",{class:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e("div",{class:"h-2 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})],-1)])])),64))])):u.value.length>0?(t(),s("div",q,[(t(!0),s(p,null,f(u.value,a=>(t(),A(m,{key:a.id,to:`/courses/${a.id}`,class:"flex gap-3 group hover:bg-gray-50 dark:hover:bg-vikinger-dark-100 p-2 -mx-2 rounded-lg transition-colors"},{default:F(()=>[e("div",z,[e("img",{src:a.cover?a.cover:`${l(h).public.apiBase}/storage/images/courses/covers/default_cover.jpg`,alt:a.name,class:"w-full h-full object-cover rounded-lg shadow-sm"},null,8,D)]),e("div",E,[e("h4",P,x(a.name),1),e("div",U,[e("span",G,x(a.code?a.code:"Course"),1)])]),e("div",H,[_(l(b),{icon:"fluent:chevron-right-20-regular",class:"w-5 h-5"})])]),_:2},1032,["to"]))),128))])):(t(),s("div",J,[_(l(b),{icon:"fluent:history-20-regular",class:"w-8 h-8 mx-auto mb-2 opacity-50"}),c[1]||(c[1]=e("p",null,"ยังไม่มีรายการที่ดูเร็วๆ นี้",-1))]))])}}}),K={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden"},O={class:"divide-y divide-gray-100 dark:divide-gray-700"},Q={class:"relative shrink-0 w-12 h-12"},X=["src","alt"],Y={key:0,class:"absolute -top-1 -right-1 w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center"},Z={class:"flex-1 min-w-0"},ee={class:"text-sm font-semibold text-gray-800 dark:text-white line-clamp-1 group-hover:text-blue-500 transition-colors"},te={class:"flex items-center gap-2 mt-1"},se={key:0,class:"px-2 py-0.5 text-[10px] font-bold uppercase tracking-wider rounded-full bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400"},re={key:0,class:"p-2 text-center"},ae={key:2,class:"p-8 text-center text-gray-500"},le=C({__name:"MemberedCoursesWidget",setup(M){const k=j(),{user:h}=V(W()),u=L(),n=g([]),v=g(!0),d=g(1),c=g(!1),m=async(i=!1)=>{if(h.value)try{const o=await k.get(`/api/courses/users/${h.value.id}/membered`,{params:{page:d.value,per_page:5}});if(o.success){const y=o.courses||[];i?n.value=[...n.value,...y]:n.value=y;const r=o.pagination;c.value=r.current_page<r.last_page}}catch(o){console.error("Failed to fetch membered courses:",o)}finally{v.value=!1}},a=()=>{d.value++,m(!0)},N=i=>i.cover?i.cover.startsWith("http")?i.cover:`${u.public.apiBase}/storage/images/courses/covers/${i.cover}`:`${u.public.apiBase}/storage/images/courses/covers/default_cover.jpg`,R=i=>i>=80?"text-green-500":i>=50?"text-blue-500":"text-orange-500";return B(()=>{m()}),(i,o)=>{const y=$;return t(),s("div",K,[o[2]||(o[2]=e("div",{class:"p-4 border-b border-gray-100 dark:border-gray-700 flex items-center justify-between"},[e("h3",{class:"font-bold text-gray-800 dark:text-white"},"รายวิชาที่เป็นสมาชิก")],-1)),e("div",O,[l(v)&&l(n).length===0?(t(),s(p,{key:0},f(3,r=>e("div",{key:r,class:"p-4 flex gap-3 animate-pulse"},[...o[0]||(o[0]=[e("div",{class:"w-12 h-12 bg-gray-200 dark:bg-gray-700 rounded-lg shrink-0"},null,-1),e("div",{class:"flex-1 space-y-2"},[e("div",{class:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e("div",{class:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})],-1)])])),64)):l(n).length>0?(t(),s(p,{key:1},[(t(!0),s(p,null,f(l(n),r=>(t(),A(y,{key:r.id,to:`/courses/${r.id}`,class:"p-4 flex items-center gap-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors group"},{default:F(()=>[e("div",Q,[e("img",{src:N(r),alt:r.name,class:"w-full h-full object-cover rounded-lg shadow-sm"},null,8,X),r.isCourseAdmin?(t(),s("div",Y,[_(l(b),{icon:"fluent:shield-checkmark-16-filled",class:"w-3 h-3 text-white"})])):w("",!0)]),e("div",Z,[e("h4",ee,x(r.name),1),e("div",te,[r.isCourseAdmin?(t(),s("span",se," Admin ")):(t(),s("span",{key:1,class:I(["text-xs font-medium",R(r.auth_progress||0)])},x(r.auth_progress.toFixed(0)||0)+"% Completed ",3))])])]),_:2},1032,["to"]))),128)),l(c)?(t(),s("div",re,[e("button",{onClick:a,class:"text-xs text-blue-500 hover:underline py-2"}," โหลดเพิ่มเติม ")])):w("",!0)],64)):(t(),s("div",ae,[_(l(b),{icon:"fluent:hat-graduation-24-regular",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),o[1]||(o[1]=e("p",{class:"text-sm"},"คุณยังไม่ได้เป็นสมาชิกรายวิชาใด",-1))]))])])}}});export{ie as _,le as a};
