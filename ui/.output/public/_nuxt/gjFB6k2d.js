import{_ as $}from"./0NabHjdI.js";import{q as A,p as F,v as z,r as v,V as D,c as l,a as e,d as i,b as p,w,u as m,t as n,$ as d,e as u,aa as y,T as b,ab as _,F as h,k as V,ai as U,g as C,j as I,o,I as c,aH as L}from"./DvtEeXFW.js";const O={class:"space-y-6 max-w-2xl mx-auto"},P={class:"flex items-center gap-4"},R={key:0,class:"p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-xl"},q={class:"flex items-center gap-2 text-green-700 dark:text-green-400"},E={key:1,class:"p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-xl"},H={class:"flex items-center gap-2 text-red-700 dark:text-red-400"},G={key:0,class:"mt-1 text-sm text-red-500"},J={key:0,class:"mt-1 text-sm text-red-500"},K={key:0,class:"mt-1 text-sm text-red-500"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},W={key:0,class:"mt-1 text-sm text-red-500"},X={key:0,class:"mt-1 text-sm text-red-500"},Y={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Z=["value"],ee=["value"],re={class:"space-y-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},ae={class:"flex items-center gap-3 cursor-pointer"},te={class:"flex items-center gap-3 cursor-pointer"},se={class:"flex flex-col sm:flex-row gap-3 pt-4"},oe=["disabled"],ue=A({__name:"create",setup(le){const B=F().public.apiBase,S=z(),x=v(!1),a=v({}),f=v(""),t=D({name:"",email:"",username:"",password:"",password_confirmation:"",role:"user",is_super_admin:!1,is_plearnd_admin:!1,status:"active"}),T=[{value:"user",label:"ผู้ใช้ทั่วไป"},{value:"instructor",label:"ผู้สอน"},{value:"admin",label:"ผู้ดูแล"}],j=[{value:"active",label:"ใช้งาน"},{value:"inactive",label:"ไม่ใช้งาน"},{value:"suspended",label:"ระงับการใช้งาน"}],M=()=>(a.value={},t.name||(a.value.name="กรุณากรอกชื่อ"),t.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(a.value.email="รูปแบบอีเมลไม่ถูกต้อง"):a.value.email="กรุณากรอกอีเมล",t.username||(a.value.username="กรุณากรอก Username"),t.password?t.password.length<8&&(a.value.password="รหัสผ่านต้องมีอย่างน้อย 8 ตัวอักษร"):a.value.password="กรุณากรอกรหัสผ่าน",t.password!==t.password_confirmation&&(a.value.password_confirmation="รหัสผ่านไม่ตรงกัน"),Object.keys(a.value).length===0),N=async()=>{if(M()){x.value=!0,f.value="";try{const g=L("token");(await $fetch(`${B}/api/admin/users`,{method:"POST",headers:{Authorization:`Bearer ${g.value}`,"Content-Type":"application/json"},body:t})).success&&(f.value="สร้างผู้ใช้สำเร็จ",setTimeout(()=>{S.push("/nuxnan-admin/users")},1500))}catch(g){g.data?.errors?a.value=g.data.errors:a.value.general=g.data?.message||"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง"}finally{x.value=!1}}};return(g,r)=>{const k=$;return o(),l("div",O,[e("div",P,[p(k,{to:"/nuxnan-admin/users",class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors"},{default:w(()=>[p(m(c),{icon:"fluent:arrow-left-24-regular",class:"w-5 h-5"})]),_:1}),r[9]||(r[9]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"เพิ่มผู้ใช้ใหม่"),e("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"กรอกข้อมูลเพื่อสร้างผู้ใช้ใหม่")],-1))]),f.value?(o(),l("div",R,[e("div",q,[p(m(c),{icon:"fluent:checkmark-circle-24-filled",class:"w-5 h-5"}),e("span",null,n(f.value),1)])])):i("",!0),a.value.general?(o(),l("div",E,[e("div",H,[p(m(c),{icon:"fluent:error-circle-24-filled",class:"w-5 h-5"}),e("span",null,n(a.value.general),1)])])):i("",!0),e("form",{onSubmit:I(N,["prevent"]),class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 space-y-6"},[e("div",null,[r[10]||(r[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" ชื่อ "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":r[0]||(r[0]=s=>t.name=s),type:"text",class:b(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":a.value.name}]),placeholder:"กรอกชื่อผู้ใช้"},null,2),[[y,t.name]]),a.value.name?(o(),l("p",G,n(a.value.name),1)):i("",!0)]),e("div",null,[r[11]||(r[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" อีเมล "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":r[1]||(r[1]=s=>t.email=s),type:"email",class:b(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":a.value.email}]),placeholder:"example@email.com"},null,2),[[y,t.email]]),a.value.email?(o(),l("p",J,n(a.value.email),1)):i("",!0)]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" Username "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":r[2]||(r[2]=s=>t.username=s),type:"text",class:b(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":a.value.username}]),placeholder:"username"},null,2),[[y,t.username]]),a.value.username?(o(),l("p",K,n(a.value.username),1)):i("",!0)]),e("div",Q,[e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" รหัสผ่าน "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":r[3]||(r[3]=s=>t.password=s),type:"password",class:b(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":a.value.password}]),placeholder:"••••••••"},null,2),[[y,t.password]]),a.value.password?(o(),l("p",W,n(a.value.password),1)):i("",!0)]),e("div",null,[r[14]||(r[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[u(" ยืนยันรหัสผ่าน "),e("span",{class:"text-red-500"},"*")],-1)),d(e("input",{"onUpdate:modelValue":r[4]||(r[4]=s=>t.password_confirmation=s),type:"password",class:b(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":a.value.password_confirmation}]),placeholder:"••••••••"},null,2),[[y,t.password_confirmation]]),a.value.password_confirmation?(o(),l("p",X,n(a.value.password_confirmation),1)):i("",!0)])]),e("div",Y,[e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," บทบาท ",-1)),d(e("select",{"onUpdate:modelValue":r[5]||(r[5]=s=>t.role=s),class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"},[(o(),l(h,null,V(T,s=>e("option",{key:s.value,value:s.value},n(s.label),9,Z)),64))],512),[[_,t.role]])]),e("div",null,[r[16]||(r[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," สถานะ ",-1)),d(e("select",{"onUpdate:modelValue":r[6]||(r[6]=s=>t.status=s),class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"},[(o(),l(h,null,V(j,s=>e("option",{key:s.value,value:s.value},n(s.label),9,ee)),64))],512),[[_,t.status]])])]),e("div",re,[r[19]||(r[19]=e("h3",{class:"font-medium text-gray-700 dark:text-gray-300"},"สิทธิ์ผู้ดูแล",-1)),e("label",ae,[d(e("input",{"onUpdate:modelValue":r[7]||(r[7]=s=>t.is_super_admin=s),type:"checkbox",class:"w-5 h-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[U,t.is_super_admin]]),r[17]||(r[17]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Super Admin",-1))]),e("label",te,[d(e("input",{"onUpdate:modelValue":r[8]||(r[8]=s=>t.is_plearnd_admin=s),type:"checkbox",class:"w-5 h-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[U,t.is_plearnd_admin]]),r[18]||(r[18]=e("span",{class:"text-gray-700 dark:text-gray-300"},"Plearnd Admin",-1))])]),e("div",se,[e("button",{type:"submit",disabled:x.value,class:"flex-1 inline-flex justify-center items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 rounded-xl text-white font-medium transition-colors"},[x.value?(o(),C(m(c),{key:0,icon:"fluent:spinner-ios-20-regular",class:"w-5 h-5 animate-spin"})):(o(),C(m(c),{key:1,icon:"fluent:save-24-regular",class:"w-5 h-5"})),u(" "+n(x.value?"กำลังบันทึก...":"บันทึก"),1)],8,oe),p(k,{to:"/nuxnan-admin/users",class:"flex-1 inline-flex justify-center items-center gap-2 px-6 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-gray-700 dark:text-gray-300 font-medium transition-colors"},{default:w(()=>[p(m(c),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5"}),r[20]||(r[20]=u(" ยกเลิก ",-1))]),_:1})])],32)])}}});export{ue as default};
