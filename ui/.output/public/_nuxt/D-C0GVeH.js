import{q as O,y as G,c as r,a as t,t as c,b as n,u as i,e as p,T as A,F as J,k as K,g as R,$ as S,aa as F,d as y,a4 as M,p as Q,r as u,aH as B,o,I as d}from"./Brb_7992.js";const X={class:"space-y-6"},Y={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Z={class:"text-gray-500 dark:text-gray-400 mt-1"},q={class:"bg-white dark:bg-gray-800 rounded-2xl p-1 shadow-sm border border-gray-100 dark:border-gray-700"},ee={class:"flex"},te={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},se={key:0,class:"p-8 text-center"},ae={key:1,class:"p-8 text-center"},oe={class:"text-gray-500 mt-2"},re={key:2,class:"divide-y divide-gray-100 dark:divide-gray-700"},le={class:"flex flex-col sm:flex-row sm:items-center gap-4"},ne={class:"flex items-center gap-3 flex-1"},ie={class:"w-10 h-10 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0"},de={class:"min-w-0"},ue={class:"font-medium text-gray-800 dark:text-white truncate"},ce={class:"text-sm text-gray-500 truncate"},ge={key:0,class:"text-xs text-gray-400 flex items-center gap-1"},pe={class:"text-right whitespace-nowrap"},ve={class:"text-lg font-bold text-gray-800 dark:text-white"},xe={class:"text-sm text-gray-500"},ye={key:0,class:"text-xs text-gray-400"},fe=["onClick"],me={class:"w-12 h-16 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 relative"},he=["src"],be={class:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center"},we={class:"flex gap-2"},ke=["onClick"],_e=["onClick"],$e={key:0,class:"sm:hidden mt-3"},Ce=["onClick"],je={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},ze={class:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl transform transition-all scale-100"},Te={class:"text-gray-600 dark:text-gray-300 mb-4"},Be={class:"font-bold text-green-600"},Pe={key:0,class:"mb-4"},Re={class:"flex gap-3"},Se=["disabled"],Fe={key:0,class:"flex items-center justify-center gap-2"},Me={key:1},De={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},Ve={class:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl transform transition-all scale-100"},Ae={class:"flex items-center gap-3 mb-4 text-red-600"},Ne={class:"w-10 h-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center"},Ue={class:"text-lg font-bold text-gray-900 dark:text-white"},Ee={class:"mb-4"},He={class:"mb-6"},Le={class:"flex gap-3"},Ie=["disabled"],We={key:0,class:"flex items-center justify-center gap-2"},Oe={key:1},Ge={key:0,class:"fixed inset-0 z-[70] flex items-center justify-center p-4"},Je={class:"relative w-full max-w-3xl max-h-[90vh] flex flex-col items-center justify-center"},Ke={class:"bg-transparent rounded-2xl overflow-hidden shadow-2xl max-w-full"},Qe={key:0,class:"relative group"},Xe=["src"],Ye={class:"absolute bottom-0 inset-x-0 p-4 bg-gradient-to-t from-black/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex justify-center gap-4"},Ze=["href"],qe=["href"],et={key:1,class:"bg-white dark:bg-gray-800 p-12 rounded-xl text-center min-w-[300px]"},tt={class:"w-20 h-20 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center mx-auto mb-4"},rt=O({__name:"pending",setup(st){const f=Q().public.apiBase,l=u("withdrawals"),h=u([]),b=u([]),P=u(!0),j=u(0),z=u(0),w=u(!1),k=u(!1),_=u(!1),g=u(null),$=u(""),v=u(!1),m=u(""),x=u(""),N=async()=>{try{const a=B("token"),e=await $fetch(`${f}/api/nuxnan-admin/wallet/withdrawals/pending`,{headers:{Authorization:`Bearer ${a.value}`}});e.success&&(h.value=e.data.withdrawals||e.data.data||e.data,j.value=e.data.total||h.value.length)}catch(a){console.error("Failed to fetch pending withdrawals:",a),h.value=[],j.value=0}},U=async()=>{try{const a=B("token"),e=await $fetch(`${f}/api/nuxnan-admin/wallet/deposit-requests/pending`,{headers:{Authorization:`Bearer ${a.value}`}});e.success&&(b.value=e.data.deposit_requests||e.data.data||e.data,z.value=e.data.total||b.value.length)}catch(a){console.error("Failed to fetch pending deposits:",a),b.value=[],z.value=0}},T=async()=>{P.value=!0,await Promise.all([N(),U()]),P.value=!1},E=a=>{g.value=a,w.value=!0},H=a=>{g.value=a,m.value="",k.value=!0},D=a=>{$.value=a.slip_url||a.transfer_slip,_.value=!0},L=async()=>{if(g.value){v.value=!0;try{const a=B("token"),e=l.value==="withdrawals"?`${f}/api/nuxnan-admin/wallet/withdrawals/${g.value.id}/approve`:`${f}/api/nuxnan-admin/wallet/deposit-requests/${g.value.id}/approve`,s=l.value==="deposits"?{admin_note:x.value}:{};await $fetch(e,{method:"POST",headers:{Authorization:`Bearer ${a.value}`,"Content-Type":"application/json"},body:s}),w.value=!1,g.value=null,x.value="",T()}catch(a){console.error("Failed to approve:",a)}finally{v.value=!1}}},I=async()=>{if(g.value){v.value=!0;try{const a=B("token"),e=l.value==="withdrawals"?`${f}/api/nuxnan-admin/wallet/withdrawals/${g.value.id}/reject`:`${f}/api/nuxnan-admin/wallet/deposit-requests/${g.value.id}/reject`;await $fetch(e,{method:"POST",headers:{Authorization:`Bearer ${a.value}`,"Content-Type":"application/json"},body:{reason:m.value,admin_note:x.value}}),k.value=!1,g.value=null,m.value="",x.value="",T()}catch(a){console.error("Failed to reject:",a)}finally{v.value=!1}}},V=a=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(a),W=a=>new Date(a).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return G(()=>{T()}),(a,e)=>(o(),r("div",X,[t("div",Y,[t("div",null,[e[14]||(e[14]=t("h1",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"รายการรอดำเนินการ",-1)),t("p",Z," รายการที่รอการอนุมัติทั้งหมด "+c((j.value+z.value).toLocaleString())+" รายการ ",1)]),t("button",{onClick:T,class:"px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-gray-700 dark:text-gray-300 transition-colors inline-flex items-center gap-2"},[n(i(d),{icon:"fluent:arrow-sync-24-regular",class:"w-5 h-5"}),e[15]||(e[15]=p(" รีเฟรช ",-1))])]),t("div",q,[t("div",ee,[t("button",{onClick:e[0]||(e[0]=s=>l.value="withdrawals"),class:A(["flex-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors",l.value==="withdrawals"?"bg-indigo-600 text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"])}," ถอนเงิน ("+c(j.value)+") ",3),t("button",{onClick:e[1]||(e[1]=s=>l.value="deposits"),class:A(["flex-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors",l.value==="deposits"?"bg-indigo-600 text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"])}," เติมเงิน ("+c(z.value)+") ",3)])]),t("div",te,[P.value?(o(),r("div",se,[n(i(d),{icon:"fluent:spinner-ios-20-regular",class:"w-8 h-8 text-indigo-600 animate-spin mx-auto"}),e[16]||(e[16]=t("p",{class:"text-gray-500 mt-2"},"กำลังโหลดข้อมูล...",-1))])):(l.value==="withdrawals"?h.value:b.value).length===0?(o(),r("div",ae,[n(i(d),{icon:"fluent:checkmark-circle-24-regular",class:"w-12 h-12 text-green-400 mx-auto"}),t("p",oe,c(l.value==="withdrawals"?"ไม่มีคำขอถอนเงินรอดำเนินการ":"ไม่มีคำขอเติมเงินรอดำเนินการ"),1)])):(o(),r("div",re,[(o(!0),r(J,null,K(l.value==="withdrawals"?h.value:b.value,s=>(o(),r("div",{key:s.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[t("div",le,[t("div",ne,[t("div",ie,[n(i(d),{icon:"fluent:person-24-regular",class:"w-5 h-5 text-gray-500"})]),t("div",de,[t("p",ue,c(s.user?.name||"Unknown"),1),t("p",ce,c(s.user?.email||"-"),1),l.value==="deposits"&&s.payment_method?(o(),r("p",ge,[n(i(d),{icon:"fluent:payment-24-regular",class:"w-3 h-3"}),p(" "+c(s.payment_method_label||s.payment_method),1)])):y("",!0)])]),t("div",pe,[t("p",ve,c(V(s.amount)),1),t("p",xe,c(W(s.created_at)),1),l.value==="deposits"&&s.reference_number?(o(),r("p",ye," Ref: "+c(s.reference_number),1)):y("",!0)]),l.value==="deposits"&&(s.slip_url||s.transfer_slip)?(o(),r("div",{key:0,class:"hidden sm:block relative group cursor-pointer",onClick:C=>D(s)},[t("div",me,[t("img",{src:s.slip_url||s.transfer_slip,class:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110",alt:"Slip",onError:e[2]||(e[2]=C=>C.target.src="https://placehold.co/48x64?text=Error")},null,40,he),t("div",be,[n(i(d),{icon:"fluent:zoom-in-24-filled",class:"w-5 h-5 text-white opacity-0 group-hover:opacity-100 transition-opacity"})])])],8,fe)):y("",!0),t("div",we,[t("button",{onClick:C=>E(s),class:"w-9 h-9 sm:w-auto sm:px-4 sm:py-2 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-colors inline-flex items-center justify-center gap-2",title:"อนุมัติ"},[n(i(d),{icon:"fluent:checkmark-24-regular",class:"w-5 h-5"}),e[17]||(e[17]=t("span",{class:"hidden sm:inline"},"อนุมัติ",-1))],8,ke),t("button",{onClick:C=>H(s),class:"w-9 h-9 sm:w-auto sm:px-4 sm:py-2 bg-red-600 hover:bg-red-700 text-white rounded-xl transition-colors inline-flex items-center justify-center gap-2",title:"ปฏิเสธ"},[n(i(d),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5"}),e[18]||(e[18]=t("span",{class:"hidden sm:inline"},"ปฏิเสธ",-1))],8,_e)])]),l.value==="deposits"&&(s.slip_url||s.transfer_slip)?(o(),r("div",$e,[t("button",{onClick:C=>D(s),class:"flex items-center gap-2 text-xs text-blue-600 font-medium"},[n(i(d),{icon:"fluent:image-24-regular",class:"w-4 h-4"}),e[19]||(e[19]=p(" ดูรูปหลักฐานการโอนเงิน ",-1))],8,Ce)])):y("",!0)]))),128))]))]),(o(),R(M,{to:"body"},[w.value?(o(),r("div",je,[t("div",{class:"absolute inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity",onClick:e[3]||(e[3]=s=>w.value=!1)}),t("div",ze,[e[23]||(e[23]=t("h3",{class:"text-lg font-bold text-gray-800 dark:text-white mb-4"},"ยืนยันการอนุมัติ",-1)),t("p",Te,[p(" คุณต้องการอนุมัติ"+c(l.value==="withdrawals"?"การถอนเงิน":"คำขอเติมเงิน")+" ",1),t("span",Be,c(V(g.value?.amount||0)),1),e[20]||(e[20]=p(" ใช่หรือไม่? ",-1))]),l.value==="deposits"?(o(),r("div",Pe,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," หมายเหตุ (ไม่บังคับ) ",-1)),S(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>x.value=s),rows:"2",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",placeholder:"เพิ่มหมายเหตุ..."},null,512),[[F,x.value]])])):y("",!0),t("div",Re,[t("button",{onClick:L,disabled:v.value,class:"flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 disabled:bg-green-400 text-white rounded-xl transition-colors font-medium shadow-sm shadow-green-600/30"},[v.value?(o(),r("span",Fe,[n(i(d),{icon:"svg-spinners:ring-resize",class:"w-5 h-5"}),e[22]||(e[22]=p(" กำลังดำเนินการ ",-1))])):(o(),r("span",Me,"ยืนยันอนุมัติ"))],8,Se),t("button",{onClick:e[5]||(e[5]=s=>w.value=!1),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-xl transition-colors font-medium"}," ยกเลิก ")])])])):y("",!0)])),(o(),R(M,{to:"body"},[k.value?(o(),r("div",De,[t("div",{class:"absolute inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity",onClick:e[6]||(e[6]=s=>k.value=!1)}),t("div",Ve,[t("div",Ae,[t("div",Ne,[n(i(d),{icon:"fluent:warning-24-filled",class:"w-6 h-6"})]),t("h3",Ue,"ปฏิเสธ"+c(l.value==="withdrawals"?"คำขอถอนเงิน":"คำขอเติมเงิน"),1)]),t("div",Ee,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[p(" เหตุผล "),t("span",{class:"text-red-500"},"*")],-1)),S(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=s=>m.value=s),rows:"3",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:"ระบุเหตุผลในการปฏิเสธ...",autofocus:""},null,512),[[F,m.value]])]),t("div",He,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," หมายเหตุ (ไม่บังคับ) ",-1)),S(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>x.value=s),rows:"2",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",placeholder:"เพิ่มหมายเหตุ..."},null,512),[[F,x.value]])]),t("div",Le,[t("button",{onClick:I,disabled:v.value||!m.value.trim(),class:"flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-300 disabled:text-gray-500 text-white rounded-xl transition-colors font-medium shadow-sm shadow-red-600/30"},[v.value?(o(),r("span",We,[n(i(d),{icon:"svg-spinners:ring-resize",class:"w-5 h-5"}),e[26]||(e[26]=p(" กำลังดำเนินการ ",-1))])):(o(),r("span",Oe,"ยืนยันปฏิเสธ"))],8,Ie),t("button",{onClick:e[9]||(e[9]=s=>k.value=!1),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-xl transition-colors font-medium"}," ยกเลิก ")])])])):y("",!0)])),(o(),R(M,{to:"body"},[_.value?(o(),r("div",Ge,[t("div",{class:"absolute inset-0 bg-gray-900/80 backdrop-blur-md transition-all duration-300",onClick:e[10]||(e[10]=s=>_.value=!1)}),t("div",Je,[t("button",{onClick:e[11]||(e[11]=s=>_.value=!1),class:"absolute -top-12 right-0 p-2 text-white/70 hover:text-white bg-white/10 hover:bg-white/20 rounded-full transition-colors backdrop-blur-sm"},[n(i(d),{icon:"fluent:dismiss-24-filled",class:"w-6 h-6"})]),t("div",Ke,[$.value?(o(),r("div",Qe,[t("img",{src:$.value,alt:"หลักฐานการโอนเงิน",class:"max-w-full max-h-[85vh] object-contain rounded-xl",onError:e[12]||(e[12]=s=>console.error("Failed to load slip image"))},null,40,Xe),t("div",Ye,[t("a",{href:$.value,target:"_blank",download:"",class:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg backdrop-blur-sm text-sm font-medium flex items-center gap-2 transition-colors"},[n(i(d),{icon:"fluent:arrow-download-24-regular",class:"w-5 h-5"}),e[27]||(e[27]=p(" ดาวน์โหลด ",-1))],8,Ze),t("a",{href:$.value,target:"_blank",class:"px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg backdrop-blur-sm text-sm font-medium flex items-center gap-2 transition-colors"},[n(i(d),{icon:"fluent:open-24-regular",class:"w-5 h-5"}),e[28]||(e[28]=p(" เปิดแท็บใหม่ ",-1))],8,qe)])])):(o(),r("div",et,[t("div",tt,[n(i(d),{icon:"fluent:image-off-24-filled",class:"w-10 h-10 text-gray-400"})]),e[29]||(e[29]=t("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-1"},"ไม่พบหลักฐานการโอนเงิน",-1)),e[30]||(e[30]=t("p",{class:"text-gray-500 text-sm"},"ไฟล์อาจถูกลบหรือลิงก์ไม่ถูกต้อง",-1)),t("button",{onClick:e[13]||(e[13]=s=>_.value=!1),class:"mt-6 px-6 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg text-sm font-medium transition-colors"}," ปิดหน้าต่าง ")]))])])])):y("",!0)]))]))}});export{rt as default};
