import{q as j,a9 as B,r as v,W as N,c as l,o as i,a as e,d as m,h as O,T as _,t as u,$ as A,aa as F,aj as q,_ as D,b as z}from"./cTealXVQ.js";import{u as E}from"./CYLt1a9j.js";import{j as K}from"./DJsVOgax.js";import"./Cpj98o6Y.js";const L={class:"coupon-redemption"},M={class:"redemption-methods"},W={class:"method-selector"},H={key:0,class:"scan-section"},G={key:0,class:"scanner-overlay"},J={key:1,class:"scan-line"},P={key:1,class:"code-section"},X={class:"code-input-container"},Y=["disabled"],Z=["disabled"],ee={key:0,class:"spinner"},se={key:1},ae={key:0,class:"result-section"},te={class:"result-icon"},ne={class:"result-content"},oe={class:"result-title"},le={class:"result-message"},ie={key:0,class:"result-details"},ce={class:"detail-item"},de={class:"detail-value"},ue={class:"detail-item"},re={class:"detail-value"},ve={class:"detail-item"},pe={class:"detail-label"},fe={class:"detail-value"},me=j({__name:"CouponRedemption",setup(S){const C=B(),n=E(),p=v("code"),c=v(""),f=v(!1),d=v(!1),t=v(null),o=v(null),b=v(null);let w=null,g=null;async function $(){d.value?h():I()}async function I(){if(!(!o.value||!b.value))try{const a=await navigator.mediaDevices.getUserMedia({video:{facing:"environment"}});o.value&&(o.value.srcObject=a,d.value=!0,await Q(),T())}catch(a){n.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ: "+a.message)}}async function Q(){w=!0}function T(){if(!o.value||!b.value||!w)return;const a=o.value,s=b.value,r=s.getContext("2d");if(!r)return;function R(){if(!d.value)return;s.width=a.videoWidth,s.height=a.videoHeight,r.drawImage(a,0,0,s.width,s.height);const y=r.getImageData(0,0,s.width,s.height),k=K(y.data,y.width,y.height);if(k&&k.data){h(),c.value=k.data,n.success("‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö QR Code!");return}g=requestAnimationFrame(R)}R()}function h(){d.value=!1,g!==null&&(cancelAnimationFrame(g),g=null),o.value&&o.value.srcObject&&(o.value.srcObject.getTracks().forEach(s=>s.stop()),o.value.srcObject=null)}async function U(){try{const a=await navigator.clipboard.readText();a&&(c.value=a.toUpperCase().trim(),n.success("‡∏ß‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß"))}catch{n.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÑ‡∏î‡πâ")}}async function x(){if(!(!c.value||f.value)){f.value=!0,t.value=null;try{const a=await C.post("/api/coupons/redeem",{coupon_code:c.value.toUpperCase().trim()});t.value=a,a.success?(n.success(`‡∏£‡∏±‡∏ö${a.type==="points"?"‡πÅ‡∏ï‡πâ‡∏°":"‡πÄ‡∏á‡∏¥‡∏ô"}‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`),c.value=""):n.error(a.message||"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ")}catch(a){t.value={success:!1,message:a.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà"},n.error(t.value.message)}finally{f.value=!1}}}function V(){t.value=null,c.value=""}return N(()=>{h()}),(a,s)=>(i(),l("div",L,[s[8]||(s[8]=e("h2",{class:"page-title"},"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á",-1)),e("div",M,[e("div",W,[e("button",{onClick:s[0]||(s[0]=r=>p.value="scan"),class:_([{active:p.value==="scan"},"method-btn"])},[...s[3]||(s[3]=[e("span",{class:"btn-icon"},"üì∑",-1),e("span",null,"‡∏™‡πÅ‡∏Å‡∏ô QR Code",-1)])],2),e("button",{onClick:s[1]||(s[1]=r=>p.value="code"),class:_([{active:p.value==="code"},"method-btn"])},[...s[4]||(s[4]=[e("span",{class:"btn-icon"},"‚å®Ô∏è",-1),e("span",null,"‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™",-1)])],2)]),p.value==="scan"?(i(),l("div",H,[e("div",{class:_(["scanner-container",{scanning:d.value}])},[e("video",{ref_key:"videoRef",ref:o,class:"scanner-video",autoplay:"",playsinline:""},null,512),e("canvas",{ref_key:"canvasRef",ref:b,class:"scanner-canvas"},null,512),d.value?m("",!0):(i(),l("div",G,[...s[5]||(s[5]=[e("div",{class:"scan-icon"},"üì∑",-1),e("p",{class:"scan-text"},"‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô QR Code",-1)])])),d.value?(i(),l("div",J)):m("",!0)],2),e("button",{onClick:$,class:_(["scan-toggle-btn",{scanning:d.value}])},u(d.value?"‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πÅ‡∏Å‡∏ô":"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô"),3)])):m("",!0),p.value==="code"?(i(),l("div",P,[e("div",X,[A(e("input",{"onUpdate:modelValue":s[2]||(s[2]=r=>c.value=r),type:"text",placeholder:"‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á 12 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£",maxlength:"12",class:"code-input",onKeyup:q(x,["enter"]),disabled:f.value},null,40,Y),[[F,c.value]]),e("button",{onClick:U,class:"paste-btn",title:"‡∏ß‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î"}," üìã ")]),e("button",{onClick:x,disabled:!c.value||f.value,class:"redeem-btn"},[f.value?(i(),l("span",ee)):(i(),l("span",se,"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"))],8,Z)])):m("",!0)]),t.value?(i(),l("div",ae,[e("div",{class:_(["result-card",t.value.success?"success":"error"])},[e("div",te,u(t.value.success?"‚úÖ":"‚ùå"),1),e("div",ne,[e("h3",oe,u(t.value.success?"‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!":"‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"),1),e("p",le,u(t.value.message),1),t.value.success?(i(),l("div",ie,[e("div",ce,[s[6]||(s[6]=e("span",{class:"detail-label"},"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:",-1)),e("span",de,u(t.value.type==="points"?"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÅ‡∏ï‡πâ‡∏°":"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏á‡∏¥‡∏ô"),1)]),e("div",ue,[s[7]||(s[7]=e("span",{class:"detail-label"},"‡∏à‡∏≥‡∏ô‡∏ß‡∏ô:",-1)),e("span",re,u(t.value.amount),1)]),e("div",ve,[e("span",pe,"‡∏¢‡∏≠‡∏î"+u(t.value.type==="points"?"‡πÅ‡∏ï‡πâ‡∏°":"‡πÄ‡∏á‡∏¥‡∏ô")+"‡πÉ‡∏´‡∏°‡πà:",1),e("span",fe,u(t.value.new_balance),1)])])):m("",!0)]),e("button",{onClick:V,class:"reset-btn"}," ‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å ")],2)])):m("",!0),s[9]||(s[9]=O('<div class="info-section" data-v-017f28ba><div class="info-card" data-v-017f28ba><span class="info-icon" data-v-017f28ba>‚ÑπÔ∏è</span><div class="info-content" data-v-017f28ba><h4 data-v-017f28ba>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h4><ul class="info-list" data-v-017f28ba><li data-v-017f28ba>‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</li><li data-v-017f28ba>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ</li><li data-v-017f28ba>‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ</li><li data-v-017f28ba>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</li></ul></div></div></div>',1))]))}}),_e=D(me,[["__scopeId","data-v-017f28ba"]]),be={class:"redeem-page"},ge=j({__name:"redeem",setup(S){return(C,n)=>(i(),l("div",be,[n[0]||(n[0]=e("div",{class:"page-header"},[e("h1",{class:"page-title"},"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"),e("p",{class:"page-subtitle"}," ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πâ‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏á‡∏¥‡∏ô ")],-1)),z(_e)]))}}),we=D(ge,[["__scopeId","data-v-9d94e175"]]);export{we as default};
