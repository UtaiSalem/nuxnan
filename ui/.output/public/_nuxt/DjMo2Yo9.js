import{y as X,a3 as Z,c as r,a as e,t as d,e as h,d as g,F as V,k as P,$ as c,aa as f,ai as ee,ab as q,h as te,r as v,ae as I,o as i,T as k}from"./Brb_7992.js";import{a as C}from"./Dnk_-Q5K.js";import{S as m}from"./BQxta0Da.js";import{useStudentRoutes as se}from"./DOMrm-Is.js";import"./BB7BZ0Dd.js";const le={class:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-gray-200 overflow-hidden"},oe={class:"bg-gradient-to-r from-blue-500 to-cyan-600 px-4 py-3 sm:px-6 sm:py-4"},ae={class:"flex items-center justify-between"},ne={class:"flex items-center"},re={class:"ml-2 sm:ml-3 min-w-0 flex-1"},ie={class:"text-base sm:text-lg font-semibold text-white truncate"},de={key:0,class:"p-4 bg-red-50 border-l-4 border-red-400"},ue={class:"flex"},ce={class:"ml-3"},me={class:"text-sm text-red-700"},pe={class:"overflow-hidden"},xe={class:"hidden md:block overflow-x-auto"},fe={class:"min-w-full divide-y divide-gray-200"},ge={class:"bg-white divide-y divide-gray-200"},ve={class:"px-4 py-3 whitespace-nowrap"},ye={class:"flex items-center"},be=["onUpdate:modelValue","onInput","readonly"],_e={key:0,class:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},we={class:"px-4 py-3 whitespace-nowrap"},he={class:"text-sm text-gray-900"},ke={class:"px-4 py-3 whitespace-nowrap"},Ce={class:"text-sm text-gray-900"},Be={class:"px-4 py-3 whitespace-nowrap"},Me={class:"text-sm text-gray-900"},Se={class:"px-4 py-3 whitespace-nowrap"},je={class:"text-sm text-gray-900"},Te={class:"px-4 py-3 whitespace-nowrap"},Fe={class:"text-sm text-gray-900"},Ve={class:"px-4 py-3 whitespace-nowrap"},Ie={class:"text-sm text-gray-900"},Ae={class:"px-4 py-3 whitespace-nowrap"},De={class:"px-4 py-3 whitespace-nowrap text-center"},Le={class:"flex items-center justify-center space-x-2"},Ne=["onClick","disabled"],Re=["onClick","disabled"],Ue=["onClick","disabled"],$e={key:1,class:"text-xs text-gray-400",title:"ข้อมูลประวัติ (ดูเท่านั้น)"},ze={key:0},Ee={class:"md:hidden space-y-4 p-4"},He={class:"p-4 space-y-3"},Pe={class:"flex items-center space-x-3"},qe={class:"flex-1 text-sm text-gray-900"},Ye={class:"flex items-center space-x-3"},Oe={class:"flex-1 text-sm text-gray-900"},Ge={class:"grid grid-cols-2 gap-3"},Je={class:"flex items-center space-x-2"},Ke={class:"flex-1 text-sm text-gray-900"},Qe={class:"flex items-center space-x-2"},We={class:"flex-1 text-sm text-gray-900"},Xe={class:"flex items-center space-x-3"},Ze={class:"flex-1 text-sm text-gray-900"},et={class:"flex items-center space-x-3"},tt={class:"flex-1 text-sm text-gray-900"},st={class:"flex items-center space-x-3"},lt={class:"flex items-center justify-between pt-2 border-t border-gray-200"},ot={class:"flex space-x-2"},at=["onClick","disabled"],nt=["onClick","disabled"],rt=["onClick","disabled"],it={key:0,class:"text-center py-8"},dt={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},ut={class:"relative min-h-screen flex items-center justify-center p-4"},ct={class:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},mt={class:"flex items-center justify-between p-6 border-b border-gray-200"},pt={class:"text-lg font-semibold text-gray-900"},xt={class:"p-6 space-y-6"},ft={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},gt={class:"flex items-center"},vt={class:"flex items-center"},yt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_t={class:"md:col-span-2"},wt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ht={key:0},kt={class:"flex items-center justify-end gap-3 p-6 border-t border-gray-200"},Ct=["disabled"],Bt={key:0,class:"flex items-center"},Mt={key:1},At={__name:"AcademicInfoCard",props:{student:{type:Object,required:!0},isLoading:{type:Boolean,default:!1},context:{type:String,default:"student"}},emits:["save","update"],setup(Y,{emit:O}){const p=Y,b=O,{academicInfoRoutes:St}=se(p.context),j=v(null),x=v([]),u=v(!1),B=v(!1),y=v("add"),M=v(null),A=v(-1),D=v(null),L=v(null),o=v({academic_year:"",class_level:"",education_level:2,class_section:"",school_name:"โรงเรียนจริยธรรมศึกษามูลนิธิ",school_address:"หมู่ 8 ตำบลสะกอม อำเภอจะนะ",school_province:"สงขลา",enrollment_date:"",graduation_date:"",status:"studying",transfer_reason:"",notes:"",isCurrent:!1});X(async()=>{try{p.student?.id?await N():console.warn("AcademicInfoCard: No student ID provided")}catch(l){l.message.includes("CSRF")||l.message.includes("token")?l.value="ไม่พบ CSRF token กรุณาโหลดหน้าใหม่":l.value="ไม่สามารถโหลดข้อมูลได้: "+l.message}}),Z(()=>o.value.class_level,(l,t)=>{if(l&&l!==t){const s=J(l);o.value.education_level!==s&&(o.value.education_level=s)}});const N=async()=>{if(!p.student?.id){console.warn("AcademicInfoCard: Cannot load academic info - no student ID");return}try{const t=(await C.get(route("homevisit.student.academic-info.index",p.student.id))).data;if(t.success&&t.data&&t.data.length>0){x.value=t.data.map(a=>({id:a.id,academic_year:a.academic_year||R(),class_level:a.current_grade||"",education_level:a.education_level||"",class_section:a.current_class||"",student_number:G(p.student.student_id),enrollment_date:_(a.enrollment_date)||_(p.student.enrollment_date),graduation_date:_(a.graduation_date),school_name:a.school_name||"โรงเรียนจริยธรรมศึกษามูลนิธิ",school_address:a.school_address||"หมู่ 8 ตำบลสะกอม อำเภอจะนะ",school_province:a.school_province||"สงขลา",status:a.study_status||"studying",isCurrent:a.is_current||!1,transfer_reason:a.transfer_reason||"",notes:a.notes||"",isFromAPI:!0}));const s=t.data.find(a=>a.is_current)||t.data[0];j.value=s}else x.value=[]}catch(l){throw l}},R=()=>{const l=new Date,t=l.getFullYear()+543;return l.getMonth()<4?String(t-1):String(t)},G=l=>{if(!l)return"";const t=l.toString();if(t.length>=2){const s=t.slice(-2);return parseInt(s).toString()}return t},_=l=>{if(!l)return"";try{const t=new Date(l);if(isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${n}`}catch{return""}},U=async l=>{const t=x.value[l];if(!t)return;if(t.isNew||!t.id){x.value.splice(l,1);return}if((await m.fire({title:"ยืนยันการลบ",text:"คุณต้องการลบข้อมูลประวัติการศึกษานี้หรือไม่?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"})).isConfirmed){u.value=!0,D.value=null;try{const n=(await C.delete(route("homevisit.student.academic-info.destroy",[p.student.id,t.id]))).data;if(n.success)x.value.splice(l,1),j.value=null,await m.fire({title:"ลบสำเร็จ!",text:"ลบข้อมูลประวัติการศึกษาเรียบร้อยแล้ว",icon:"success",timer:2e3,showConfirmButton:!1}),b("save",{success:!0,type:"academic_info_deleted",data:t});else throw new Error(n.message||"เกิดข้อผิดพลาดในการลบข้อมูล")}catch(a){a.message.includes("CSRF")||a.message.includes("token")?await m.fire({title:"CSRF Token หมดอายุ!",text:"กรุณาโหลดหน้าเว็บใหม่แล้วลองอีกครั้ง",icon:"warning",confirmButtonText:"ตกลง"}):await m.fire({title:"เกิดข้อผิดพลาด!",text:a.message,icon:"error",confirmButtonText:"ตกลง"}),b("save",{success:!1,type:"academic_info_deleted",message:a.message})}finally{u.value=!1}}},$=async(l,t)=>{if(l.id){u.value=!0,D.value=null;try{const a=(await C.put(route("homevisit.student.academic-info.set-current",[p.student.id,l.id]))).data;if(a.success)x.value.forEach(n=>n.isCurrent=!1),l.isCurrent=!0,j.value=a.data,await m.fire({title:"สำเร็จ!",text:"ตั้งค่าเป็นข้อมูลปัจจุบันเรียบร้อยแล้ว",icon:"success",timer:2e3,showConfirmButton:!1}),b("save",{success:!0,type:"academic_info_set_current",data:a.data});else throw new Error(a.message||"เกิดข้อผิดพลาดในการตั้งค่า")}catch(s){s.message.includes("CSRF")||s.message.includes("token")?await m.fire({title:"CSRF Token หมดอายุ!",text:"กรุณาโหลดหน้าเว็บใหม่แล้วลองอีกครั้ง",icon:"warning",confirmButtonText:"โหลดหน้าใหม่"}).then(()=>window.location.reload()):await m.fire({title:"เกิดข้อผิดพลาด!",text:s.message,icon:"error",confirmButtonText:"ตกลง"}),b("save",{success:!1,type:"academic_info_set_current",message:s.message})}finally{u.value=!1}}},z=l=>({studying:"กำลังศึกษา",graduated:"จบการศึกษา",transferred:"ย้ายโรงเรียน",dropped:"ออกจากระบบ"})[l]||l,E=l=>({0:"อนุบาล",1:"ประถม",2:"มัธยม"})[l]||"ไม่ระบุ",J=l=>{if(!l)return 2;const t=l.toString().toLowerCase();return t.includes("อ.")||t.includes("ก.")?0:t.includes("ป.")?1:(t.includes("ม."),2)},K=()=>{y.value="add",M.value=null,A.value=-1,T(),B.value=!0},H=async(l,t)=>{y.value="edit",M.value=l,A.value=t,T(),await I(),Q(l),B.value=!0,await I();const s=l.class_level||l.current_grade||"";s&&(o.value.class_level=s)},S=()=>{B.value=!1,T()},T=()=>{o.value={academic_year:R(),class_level:"",education_level:2,class_section:"",school_name:"โรงเรียนจริยธรรมศึกษามูลนิธิ",school_address:"หมู่ 8 ตำบลสะกอม อำเภอจะนะ",school_province:"สงขลา",enrollment_date:_(p.student.enrollment_date)||"",graduation_date:"",status:"studying",transfer_reason:"",notes:"",isCurrent:x.value.length===0}},Q=l=>{const t=l.class_level||l.current_grade||"";Object.assign(o.value,{academic_year:l.academic_year||"",class_level:t,education_level:l.education_level||"",class_section:l.class_section||"",school_name:l.school_name||"",school_address:l.school_address||"",school_province:l.school_province||"",enrollment_date:l.enrollment_date||_(p.student.enrollment_date)||"",graduation_date:l.graduation_date||"",status:l.status||"studying",transfer_reason:l.transfer_reason||"",notes:l.notes||"",isCurrent:l.isCurrent||!1})},W=async()=>{if(!o.value.class_level||!o.value.class_section){await m.fire({title:"ข้อมูลไม่ครบถ้วน",text:"กรุณากรอกระดับชั้นและห้องเรียน",icon:"warning",confirmButtonText:"ตกลง"});return}u.value=!0;try{const l=o.value.enrollment_date||null,t=o.value.graduation_date||null;if(l&&t&&new Date(t)<new Date(l)){await m.fire({title:"ข้อมูลไม่ถูกต้อง",text:"วันที่จบการศึกษาต้องไม่เก่ากว่าวันที่เข้าเรียน",icon:"warning",confirmButtonText:"ตกลง"});return}const s={current_grade:o.value.class_level||null,education_level:o.value.education_level?parseInt(o.value.education_level):null,current_class:o.value.class_section||null,academic_year:o.value.academic_year?String(o.value.academic_year):null,semester:1,school_name:o.value.school_name||null,school_address:o.value.school_address||null,school_province:o.value.school_province||null,enrollment_date:l,graduation_date:t,study_status:o.value.status||"studying",is_current:!!o.value.isCurrent,transfer_reason:o.value.transfer_reason||null,notes:o.value.notes||null};let a,n;y.value==="edit"&&M.value?.id?(n=route("homevisit.student.academic-info.update",[p.student.id,M.value.id]),a=await C.put(n,s)):(n=route("homevisit.student.academic-info.store",p.student.id),a=await C.post(n,s));const w=a.data;if(w.success)await N(),S(),b("save",{success:!0,type:y.value==="add"?"academic_info_added":"academic_info_updated",data:w.data}),await I(),await m.fire({title:"สำเร็จ!",text:y.value==="add"?"เพิ่มข้อมูลประวัติการศึกษาเรียบร้อยแล้ว":"อัปเดตข้อมูลประวัติการศึกษาเรียบร้อยแล้ว",icon:"success",timer:2e3,showConfirmButton:!1});else throw new Error(w.message||"เกิดข้อผิดพลาดในการบันทึกข้อมูล")}catch(l){let t="เกิดข้อผิดพลาดในการบันทึกข้อมูล";if(l.response){const{status:s,data:a}=l.response;if(s===422)if(a.errors){const n=[];Object.entries(a.errors).forEach(([w,F])=>{n.push(`${w}: ${Array.isArray(F)?F.join(", "):F}`)}),t=`Validation Errors:
${n.join(`
`)}`}else a.message?t=a.message:t="ข้อมูลที่กรอกไม่ถูกต้อง กรุณาตรวจสอบและลองใหม่อีกครั้ง";else if(s===419){await m.fire({title:"CSRF Token หมดอายุ!",text:"กรุณาโหลดหน้าเว็บใหม่แล้วลองอีกครั้ง",icon:"warning",confirmButtonText:"โหลดหน้าใหม่",cancelButtonText:"ยกเลิก",showCancelButton:!0}).then(n=>{n.isConfirmed&&window.location.reload()});return}else a.message&&(t=a.message)}else if(l.message.includes("CSRF")||l.message.includes("token")){await m.fire({title:"CSRF Token หมดอายุ!",text:"กรุณาโหลดหน้าเว็บใหม่แล้วลองอีกครั้ง",icon:"warning",confirmButtonText:"ตกลง"});return}else l.message&&(t=l.message);await m.fire({title:"เกิดข้อผิดพลาด!",text:t,icon:"error",confirmButtonText:"ตกลง"}),b("save",{success:!1,type:y.value==="add"?"academic_info_added":"academic_info_updated",message:l.message})}finally{u.value=!1}};return(l,t)=>(i(),r("div",le,[e("div",oe,[e("div",ae,[e("div",ne,[t[14]||(t[14]=e("div",{class:"w-7 h-7 sm:w-8 sm:h-8 bg-white bg-opacity-20 rounded-lg flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-4 h-4 sm:w-5 sm:h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})])],-1)),e("div",re,[e("h3",ie," ประวัติการศึกษา ("+d(x.value.length)+" รายการ) ",1),t[13]||(t[13]=e("p",{class:"text-blue-100 text-xs sm:text-sm"},"ข้อมูลประวัติการศึกษาของนักเรียน",-1))])]),e("button",{onClick:K,class:"inline-flex items-center px-3 py-1.5 sm:px-4 sm:py-2 bg-white bg-opacity-20 hover:bg-opacity-30 text-white text-xs sm:text-sm font-medium rounded-lg transition-all duration-200"},[...t[15]||(t[15]=[e("svg",{class:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),h(" เพิ่มข้อมูล ",-1)])])])]),L.value&&!u.value?(i(),r("div",de,[e("div",ue,[t[16]||(t[16]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",ce,[e("p",me,d(L.value),1)])])])):g("",!0),e("div",pe,[e("div",xe,[e("table",fe,[t[22]||(t[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ปีการศึกษา"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ระดับการศึกษา"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ระดับชั้น"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"ห้อง"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"วันที่เข้าศึกษา"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"โรงเรียน"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"จังหวัด"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"สถานะ"),e("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-20"},"จัดการ")])],-1)),e("tbody",ge,[(i(!0),r(V,null,P(x.value,(s,a)=>(i(),r("tr",{key:s.id||a,class:k({"bg-blue-50":s.isNew,"bg-green-50":s.isCurrent,"bg-gray-50":s.isFromAPI&&!s.isCurrent,"hover:bg-gray-50":!s.isNew&&!s.isCurrent})},[e("td",ve,[e("div",ye,[c(e("input",{"onUpdate:modelValue":n=>s.academic_year=n,onInput:n=>l.updateRecord(s,a),type:"text",readonly:s.isFromAPI&&!s.isCurrent,class:k(["w-full border-0 bg-transparent focus:ring-2 focus:ring-blue-500 focus:border-blue-500 rounded px-2 py-1 text-sm placeholder-gray-400",s.isFromAPI&&!s.isCurrent?"text-gray-600 cursor-default":""]),placeholder:"2567"},null,42,be),[[f,s.academic_year]]),s.isCurrent?(i(),r("span",_e," ปัจจุบัน ")):g("",!0)])]),e("td",we,[e("span",he,d(E(s.education_level)),1)]),e("td",ke,[e("span",Ce,d(s.class_level||"-"),1)]),e("td",Be,[e("span",Me,d(s.class_section||"-"),1)]),e("td",Se,[e("span",je,d(s.enrollment_date||"-"),1)]),e("td",Te,[e("span",Fe,d(s.school_name||"-"),1)]),e("td",Ve,[e("span",Ie,d(s.school_province||"-"),1)]),e("td",Ae,[e("span",{class:k(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",{"bg-green-100 text-green-800":s.status==="studying","bg-blue-100 text-blue-800":s.status==="graduated","bg-yellow-100 text-yellow-800":s.status==="transferred","bg-red-100 text-red-800":s.status==="dropped","bg-gray-100 text-gray-800":!s.status}])},d(z(s.status)||"-"),3)]),e("td",De,[e("div",Le,[s.isNew?g("",!0):(i(),r("button",{key:0,onClick:n=>H(s,a),disabled:u.value,class:"text-blue-600 hover:text-blue-800 disabled:opacity-50",title:"แก้ไข"},[...t[17]||(t[17]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ne)),s.isCurrent||s.isNew?(i(),r("button",{key:1,onClick:n=>U(a),disabled:u.value,class:"text-red-600 hover:text-red-800 disabled:opacity-50",title:"ลบ"},[...t[18]||(t[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Re)):(i(),r(V,{key:2},[s.isFromAPI?(i(),r("button",{key:0,onClick:n=>$(s),disabled:u.value,class:"text-blue-600 hover:text-blue-800 disabled:opacity-50 mr-2",title:"ตั้งเป็นปัจจุบัน"},[...t[19]||(t[19]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 713.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1)])],8,Ue)):(i(),r("span",$e,[...t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])]))],64))])])],2))),128)),x.value.length===0?(i(),r("tr",ze,[...t[21]||(t[21]=[e("td",{colspan:"10",class:"px-4 py-8 text-center text-gray-500"},[e("div",{class:"flex flex-col items-center"},[e("svg",{class:"w-12 h-12 text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})]),e("p",{class:"text-sm"},"ยังไม่มีข้อมูลประวัติการศึกษา"),e("p",{class:"text-xs text-gray-400 mt-1"},'คลิกปุ่ม "เพิ่มข้อมูล" เพื่อเริ่มต้น')])],-1)])])):g("",!0)])])]),e("div",Ee,[(i(!0),r(V,null,P(x.value,(s,a)=>(i(),r("div",{key:s.id||a,class:k(["bg-white rounded-lg border",s.isNew?"border-blue-300 bg-blue-50":"border-gray-200"])},[e("div",He,[e("div",Pe,[t[23]||(t[23]=e("label",{class:"text-xs font-medium text-gray-500 w-20"},"ปีการศึกษา:",-1)),e("span",qe,d(s.academic_year||"-"),1)]),e("div",Ye,[t[24]||(t[24]=e("label",{class:"text-xs font-medium text-gray-500 w-20"},"ระดับการศึกษา:",-1)),e("span",Oe,d(E(s.education_level)),1)]),e("div",Ge,[e("div",Je,[t[25]||(t[25]=e("label",{class:"text-xs font-medium text-gray-500"},"ระดับชั้น:",-1)),e("span",Ke,d(s.class_level||"-"),1)]),e("div",Qe,[t[26]||(t[26]=e("label",{class:"text-xs font-medium text-gray-500"},"ห้อง:",-1)),e("span",We,d(s.class_section||"-"),1)])]),e("div",Xe,[t[27]||(t[27]=e("label",{class:"text-xs font-medium text-gray-500 w-20"},"โรงเรียน:",-1)),e("span",Ze,d(s.school_name||"-"),1)]),e("div",et,[t[28]||(t[28]=e("label",{class:"text-xs font-medium text-gray-500 w-20"},"จังหวัด:",-1)),e("span",tt,d(s.school_province||"-"),1)]),e("div",st,[t[29]||(t[29]=e("label",{class:"text-xs font-medium text-gray-500 w-20"},"สถานะ:",-1)),e("span",{class:k(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",{"bg-green-100 text-green-800":s.status==="studying","bg-blue-100 text-blue-800":s.status==="graduated","bg-yellow-100 text-yellow-800":s.status==="transferred","bg-red-100 text-red-800":s.status==="dropped","bg-gray-100 text-gray-800":!s.status}])},d(z(s.status)||"-"),3)]),e("div",lt,[t[33]||(t[33]=e("div",{class:"flex items-center space-x-2"},null,-1)),e("div",ot,[s.isNew?g("",!0):(i(),r("button",{key:0,onClick:n=>H(s,a),disabled:u.value,class:"inline-flex items-center px-3 py-1.5 bg-blue-600 text-white text-xs font-medium rounded-md hover:bg-blue-700 disabled:opacity-50"},[...t[30]||(t[30]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),h(" แก้ไข ",-1)])],8,at)),!s.isCurrent&&!s.isNew?(i(),r("button",{key:1,onClick:n=>$(s),disabled:u.value,class:"inline-flex items-center px-3 py-1.5 bg-orange-600 text-white text-xs font-medium rounded-md hover:bg-orange-700 disabled:opacity-50"},[...t[31]||(t[31]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 713.138-3.138z"})],-1),h(" ตั้งปัจจุบัน ",-1)])],8,nt)):g("",!0),s.isCurrent?(i(),r("button",{key:2,onClick:n=>U(a),disabled:u.value,class:"inline-flex items-center px-3 py-1.5 bg-red-600 text-white text-xs font-medium rounded-md hover:bg-red-700 disabled:opacity-50"},[...t[32]||(t[32]=[e("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),h(" ลบ ",-1)])],8,rt)):g("",!0)])])])],2))),128)),x.value.length===0?(i(),r("div",it,[...t[34]||(t[34]=[e("svg",{class:"w-12 h-12 text-gray-300 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1),e("p",{class:"text-sm text-gray-500"},"ยังไม่มีข้อมูลประวัติการศึกษา",-1),e("p",{class:"text-xs text-gray-400 mt-1"},'คลิกปุ่ม "เพิ่มข้อมูล" เพื่อเริ่มต้น',-1)])])):g("",!0)])]),B.value?(i(),r("div",dt,[e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:S}),e("div",ut,[e("div",ct,[e("div",mt,[e("h3",pt,d(y.value==="add"?"เพิ่มประวัติการศึกษา":"แก้ไขประวัติการศึกษา"),1),e("button",{onClick:S,class:"text-gray-400 hover:text-gray-600 transition-colors"},[...t[35]||(t[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",xt,[e("div",ft,[e("div",null,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ปีการศึกษา",-1)),c(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.academic_year=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"2567"},null,512),[[f,o.value.academic_year]])]),e("div",gt,[e("label",vt,[c(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.isCurrent=s),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[ee,o.value.isCurrent]]),t[37]||(t[37]=e("span",{class:"ml-2 text-sm text-gray-700"},"ประวัติปัจจุบัน",-1))])])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ระดับการศึกษา *",-1)),c(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.education_level=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},[...t[38]||(t[38]=[e("option",{value:""},"เลือกระดับการศึกษา",-1),e("option",{value:0},"อนุบาล",-1),e("option",{value:1},"ประถมศึกษา",-1),e("option",{value:2},"มัธยมศึกษา",-1)])],512),[[q,o.value.education_level]])]),e("div",yt,[e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ระดับชั้น *",-1)),c(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.class_level=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"เช่น 1, 2",required:""},null,512),[[f,o.value.class_level]])]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ห้อง *",-1)),c(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.class_section=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"1, 2, 3...",required:""},null,512),[[f,o.value.class_section]])])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ชื่อโรงเรียน",-1)),c(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.school_name=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"โรงเรียนจริยธรรมศึกษามูลนิธิ"},null,512),[[f,o.value.school_name]])]),e("div",bt,[e("div",_t,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ที่อยู่โรงเรียน",-1)),c(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.school_address=s),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"หมู่ 8 ตำบลสะกอม อำเภอจะนะ"},null,512),[[f,o.value.school_address]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"จังหวัด",-1)),c(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.value.school_province=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"สงขลา"},null,512),[[f,o.value.school_province]])])]),e("div",wt,[e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"วันที่เข้าเรียน",-1)),c(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>o.value.enrollment_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,o.value.enrollment_date]])]),e("div",null,[t[46]||(t[46]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"วันที่จบการศึกษา",-1)),c(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>o.value.graduation_date=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,o.value.graduation_date]])])]),e("div",null,[t[48]||(t[48]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"สถานะการศึกษา",-1)),c(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>o.value.status=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[...t[47]||(t[47]=[te('<option value="studying">กำลังศึกษา</option><option value="graduated">จบการศึกษา</option><option value="transferred">ย้ายโรงเรียน</option><option value="dropped">ออกจากระบบ</option><option value="suspended">พักการเรียน</option>',5)])],512),[[q,o.value.status]])]),o.value.status==="transferred"?(i(),r("div",ht,[t[49]||(t[49]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"เหตุผลการย้าย",-1)),c(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=s=>o.value.transfer_reason=s),rows:"2",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"ระบุเหตุผลการย้ายโรงเรียน"},null,512),[[f,o.value.transfer_reason]])])):g("",!0),e("div",null,[t[50]||(t[50]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"หมายเหตุ",-1)),c(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=s=>o.value.notes=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400",placeholder:"หมายเหตุเพิ่มเติม"},null,512),[[f,o.value.notes]])])]),e("div",kt,[e("button",{onClick:S,type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," ยกเลิก "),e("button",{onClick:W,disabled:u.value,type:"button",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[u.value?(i(),r("span",Bt,[...t[51]||(t[51]=[e("svg",{class:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),h(" กำลังบันทึก... ",-1)])])):(i(),r("span",Mt,d(y.value==="add"?"เพิ่มข้อมูล":"บันทึกการแก้ไข"),1))],8,Ct)])])])])):g("",!0)]))}};export{At as default};
