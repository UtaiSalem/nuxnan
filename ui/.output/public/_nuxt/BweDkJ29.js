import{_ as L,r as d,V as F,n as D,c as C,a as e,b as m,h as M,u as i,g as h,d as j,t as o,w as T,o as u,I as x,e as q,j as H,$ as f,aa as p}from"./DvtEeXFW.js";import{_ as Y}from"./C9jVIhCz.js";import{j as z}from"./unovbEJl.js";import{S as r}from"./BQxta0Da.js";import{G,V as K,Y as W}from"./Ch2gumr2.js";const J={class:"flex justify-center items-center font-sarabun"},Q={class:"h-[20%] bg-gradient-to-br from-gray-50 to-gray-200 relative",style:{background:"linear-gradient(135deg, transparent 40%, #4a90e2 0%)"}},X={class:"flex p-[3%] gap-[3%] h-[80%]"},Z={class:"w-[30%] h-[75%] rounded-xl overflow-hidden flex-shrink-0"},tt={key:0,class:"w-full h-full relative"},et=["src"],st={key:1,class:"w-full h-full flex items-center justify-center bg-gray-300 cursor-pointer"},nt={class:"flex-1 pt-0.5 relative"},at={class:"flex items-baseline"},lt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},ot={class:"flex items-baseline -mt-3 sm:-mt-4 md:-mt-5"},it={class:"flex-1 text-[1.8vw] sm:text-sm font-normal text-gray-800"},rt={class:"flex items-baseline mt-0.5"},dt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},mt={class:"flex items-baseline mt-0.5"},ut={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},xt={class:"flex items-baseline mt-0.5"},ft={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},pt={class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},gt={class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},ct={class:"flex items-baseline mt-0.5"},bt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},vt={class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},yt={class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},wt={class:"flex items-baseline mt-0.5"},_t={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},ht={class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},It={class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},kt={class:"absolute bottom-[5%] right-[3%] w-[15%] aspect-square"},St={class:"w-full h-full bg-white flex items-center justify-center rounded-lg shadow-md"},Dt={class:"fixed inset-0 flex items-center justify-center p-4"},Ct={class:"mb-4"},Tt={class:"mb-4"},Ut={class:"mb-4"},$t={class:"mb-4"},jt={class:"mb-4"},Nt={class:"mb-6"},Vt={class:"flex justify-end gap-2"},Bt=["disabled"],Ot={__name:"StudentCard",props:{studentInfo:{type:Object,required:!0}},emits:["update","upload-image"],setup(U,{emit:Pt}){const n=U,I=d(!1),y=d(!1),w=d(!1),g=d(!1),s=F({id:n.studentInfo.id,student_number:n.studentInfo.student_number,title_name:n.studentInfo.title_name||"",first_name_thai:n.studentInfo.first_name_thai||"",last_name_thai:n.studentInfo.last_name_thai||"",full_name_thai:n.studentInfo.full_name_thai||((n.studentInfo.title_name||"")+" "+(n.studentInfo.first_name_thai||"")+" "+(n.studentInfo.last_name_thai||"")).trim(),first_name_english:n.studentInfo.first_name_english||"",level:n.studentInfo.class_level<4?"มัธยมศึกษาตอนต้น":"มัธยมศึกษาตอนปลาย",birth_date:n.studentInfo.birth_date,national_id:n.studentInfo.national_id}),N=D(()=>{if(!s.national_id)return"";const l=String(s.national_id);return l.length!==13?l:l.replace(/\D/g,"").replace(/(\d)(\d{4})(\d{5})(\d{2})(\d{1})/,"$1-$2-$3-$4-$5")}),V=D(()=>s.full_name_thai&&s.full_name_thai.trim()?s.full_name_thai.trim():[s.title_name?.trim(),s.first_name_thai?.trim(),s.last_name_thai?.trim()].filter(t=>t&&t!=="").join(" ")),k=d(null),c=d(null),_=d(n.studentInfo.profile_image||null),$=D(()=>c.value?c.value:_.value?`/storage/images/students/${n.studentInfo.class_level}/${n.studentInfo.class_section}/${_.value}`:null),B=l=>{const t=l.target.files[0];if(!t)return;const a=new FileReader;a.onload=b=>{c.value=b.target.result,I.value=!0,O(n.studentInfo.id,n.studentInfo.student_number,t)},a.readAsDataURL(t)},O=async(l,t,a)=>{if(!a||!t)return;const b=new FormData;b.append("photo",a),b.append("_method","patch");try{const v=await axios.post(`/student-card/admin/upload-photo/${l}`,b,{headers:{"Content-Type":"multipart/form-data"}});v.data.success?r.fire({icon:"success",title:"อัพโหลดรูปภาพสำเร็จ",text:v.data.message,confirmButtonText:"ตกลง"}):r.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:v.data.message||"ไม่สามารถอัพโหลดรูปภาพได้",confirmButtonText:"ตกลง"})}catch(v){console.error("Upload failed:",v),r.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพโหลดรูปภาพได้",confirmButtonText:"ตกลง"})}finally{I.value=!1,k.value.value=""}},S=()=>{k.value.click()},P=async()=>{try{w.value=!0;const l={national_id:s.national_id,student_number:s.student_number,title_name:s.title_name,first_name_thai:s.first_name_thai,last_name_thai:s.last_name_thai,first_name_english:s.first_name_english,birth_date:s.birth_date};(await axios.put(`/student-card/update/${s.id}`,l,{headers:{"Content-Type":"application/json"}})).data.success&&(r.fire({title:"บันทึกข้อมูลสำเร็จ",icon:"success",confirmButtonText:"ตกลง"}),g.value=!1)}catch{r.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถบันทึกข้อมูลได้",icon:"error",confirmButtonText:"ตกลง"})}finally{w.value=!1}},R=async()=>{if((await r.fire({title:"ลบรูปภาพ",text:"คุณต้องการลบรูปภาพนี้หรือไม่?",icon:"warning",showCancelButton:!0,confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"})).isConfirmed)try{y.value=!0;const t=await axios.delete(`/student-card/${n.studentInfo.id}/photo`);t.data.success?(c.value=null,_.value=null,r.fire("ลบสำเร็จ","","success")):r.fire("เกิดข้อผิดพลาด",t.data.message||"","error")}catch{r.fire("เกิดข้อผิดพลาด","ไม่สามารถลบรูปภาพได้","error")}finally{y.value=!1}},A=d(null),E=l=>l?l=="เด็กหญิง"||l=="นางสาว"?"Ms.":l=="เด็กชาย"||l=="นาย"?"Mr.":"":"";return(l,t)=>(u(),C("div",J,[e("div",{ref_key:"cardRef",ref:A,class:"student-card-container w-full max-w-[640px] aspect-[1.95/1.20] relative overflow-hidden rounded-2xl shadow-lg border border-gray-300"},[e("div",Q,[t[10]||(t[10]=M('<div class="absolute -left-2 md:-left-3 -top-[16px] sm:-top-[28px] md:-top-[22px] w-[22%] aspect-square rounded-full border-1 border-white flex items-center justify-center" data-v-f3147420><img src="'+Y+'" alt="School Logo" class="w-[56%] h-[56%] object-cover rounded-full" data-v-f3147420></div><div class="absolute left-[16%] top-[10%] sm:top-2" data-v-f3147420><div class="text-[3.8vw] md:text-[28px] font-semibold md:font-bold text-gray-800" data-v-f3147420> โรงเรียนจริยธรรมศึกษามูลนิธิ </div><div class="text-[2.4vw] sm:text-[2.5vw] md:text-[16px] -mt-1 sm:-mt-2.5 md:-mt-2 font-base text-gray-800 tracking-wider" data-v-f3147420> CHARIYATHAMSUKSA FOUNDATION SCHOOL </div><div class="text-[2.4vw] md:text-sm -mt-0.5 sm:-mt-2 md:-mt-1 text-gray-800" data-v-f3147420> 148 ม.8 ต.สะกอม อ.จะนะ จ.สงขลา 90130 โทร.081-5412281 </div></div>',2)),e("div",{onClick:t[0]||(t[0]=a=>g.value=!0),class:"absolute z-50 top-0 right-2 text-white bg-gray-200/60 p-2 text-center rounded-full shadow-md cursor-pointer"},[m(i(x),{icon:"dashicons:edit",width:"20",height:"20"})]),t[11]||(t[11]=e("div",{class:"absolute z-10 top-6 md:top-[52px] right-2 text-white bg-blue-700 px-2 py-1 text-end rounded-md"},[e("div",{class:"text-[1.8vw] sm:text-[14px] font-semibold"},"บัตรประจำตัวนักเรียน"),e("div",{class:"text-[1.4vw] sm:text-[10px] opacity-90"},"STUDENT CARD")],-1))]),e("div",X,[e("div",Z,[e("input",{type:"file",ref_key:"fileInput",ref:k,onChange:B,accept:"image/*",class:"hidden"},null,544),c.value||_.value?(u(),C("div",tt,[e("img",{src:$.value,alt:"Student Photo",class:"w-full h-full object-fill"},null,8,et),e("div",{class:"absolute bottom-2 right-2 bg-white p-1 rounded-full shadow-md cursor-pointer",onClick:S},[m(i(x),{icon:"heroicons:pencil-solid",class:"w-5 h-5 text-gray-600"})]),e("button",{class:"absolute bottom-2 right-2 bg-white p-1 rounded-full shadow-md cursor-pointer focus:outline-none focus:ring",onClick:S,"aria-label":"เปลี่ยนรูป"},[I.value?(u(),h(i(x),{key:0,icon:"eos-icons:bubble-loading",class:"w-5 h-5 text-gray-600"})):(u(),h(i(x),{key:1,icon:"heroicons:pencil-solid",class:"w-5 h-5 text-gray-600"}))]),e("button",{class:"absolute bottom-2 left-2 bg-red-500 p-1 rounded-full shadow-md cursor-pointer focus:outline-none focus:ring",onClick:R,"aria-label":"ลบรูป"},[y.value?(u(),h(i(x),{key:0,icon:"eos-icons:bubble-loading",class:"w-5 h-5 text-white"})):j("",!0),!y.value&&$.value?(u(),h(i(x),{key:1,icon:"heroicons:trash-solid",class:"w-5 h-5 text-white"})):j("",!0)])])):(u(),C("div",st,[m(i(x),{icon:"tabler:photo-plus",class:"w-10 h-10 text-gray-600/60",onClick:S})]))]),e("div",nt,[e("div",at,[t[12]||(t[12]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-md md:text-lg font-medium text-gray-700"},"ชื่อ",-1)),t[13]||(t[13]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",lt,o(V.value),1)]),t[32]||(t[32]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Name")],-1)),e("div",ot,[t[14]||(t[14]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},null,-1)),t[15]||(t[15]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",it,o(s.first_name_english?E(s.title_name):"")+" "+o(s.first_name_english),1)]),e("div",rt,[t[16]||(t[16]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"รหัสประจำตัว",-1)),t[17]||(t[17]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",dt,o(s.student_number),1)]),t[33]||(t[33]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Student ID")],-1)),e("div",mt,[t[18]||(t[18]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm font-medium text-gray-700"},"เลขบัตรประชาชน",-1)),t[19]||(t[19]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",ut,o(N.value),1)]),t[34]||(t[34]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"ID Card No.")],-1)),e("div",xt,[t[20]||(t[20]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"}," ระดับ ",-1)),t[21]||(t[21]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",ft,o(s.level),1)]),e("div",pt,[t[22]||(t[22]=e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Level",-1)),t[23]||(t[23]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",gt,o(U.studentInfo.class_level<4?"LOWER SECONDARY":"UPPER SECONDARY"),1)]),e("div",ct,[t[24]||(t[24]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"วันเกิด",-1)),t[25]||(t[25]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",bt,o(new Date(s.birth_date).toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"})),1)]),e("div",vt,[t[26]||(t[26]=e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Date of Birth",-1)),t[27]||(t[27]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",yt,o(new Date(s.birth_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})),1)]),e("div",wt,[t[28]||(t[28]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"วันหมดอายุ",-1)),t[29]||(t[29]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",_t,o(n.studentInfo.card_expiry_date?new Date(n.studentInfo.card_expiry_date).toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"}):"-"),1)]),e("div",ht,[t[30]||(t[30]=e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Expiry Date",-1)),t[31]||(t[31]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",It,o(n.studentInfo.card_expiry_date?new Date(n.studentInfo.card_expiry_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"}):"-"),1)])]),e("div",kt,[e("div",St,[m(i(z),{value:`${n.studentInfo.student_number}`,cornersSquareOptions:{type:"extra-rounded",color:"#000"},dotsOptions:{type:"dots",color:"#000"},cornersDotOptions:{type:"square",color:"#000"}},null,8,["value"])])]),t[35]||(t[35]=e("div",{class:"absolute bottom-0 left-0 w-full h-[2.5%] flex items-center justify-center rounded-b-2xl",style:{background:"linear-gradient(135deg, #4a90e2 72%, transparent 0%)"}},[e("span",{class:"text-white text-[1vw] text-sm font-medium tracking-wider"})],-1))]),m(i(W),{as:"div",onClose:t[9]||(t[9]=a=>g.value=!1),open:g.value,class:"relative z-50"},{default:T(()=>[t[44]||(t[44]=e("div",{class:"fixed inset-0 bg-black/30","aria-hidden":"true"},null,-1)),e("div",Dt,[m(i(G),{class:"w-full max-w-md bg-white rounded-lg p-6 shadow-xl"},{default:T(()=>[m(i(K),{class:"text-lg font-medium text-gray-900 mb-4"},{default:T(()=>[...t[36]||(t[36]=[q("แก้ไขข้อมูลนักเรียน",-1)])]),_:1}),e("form",{onSubmit:H(P,["prevent"])},[e("div",Ct,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"รหัสนักเรียน",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>s.student_number=a),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[p,s.student_number]])]),e("div",Tt,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700"},"คำนำหน้าชื่อ",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>s.title_name=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[p,s.title_name]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700"},"ชื่อ",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=a=>s.first_name_thai=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[p,s.first_name_thai]])]),e("div",Ut,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700"},"นามสกุล",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>s.last_name_thai=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[p,s.last_name_thai]])]),e("div",$t,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ชื่อ-นามสกุล (อังกฤษ)",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=a=>s.first_name_english=a),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[p,s.first_name_english]])]),e("div",jt,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"เลขประจำตัวประชาชน",-1)),f(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=a=>s.national_id=a),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[p,s.national_id]])]),e("div",Nt,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"วันเกิด",-1)),f(e("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=a=>s.birth_date=a),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[p,s.birth_date]])]),e("div",Vt,[e("button",{type:"button",onClick:t[8]||(t[8]=a=>g.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," ยกเลิก "),e("button",{type:"submit",disabled:w.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50"},o(w.value?"กำลังบันทึก...":"บันทึก"),9,Bt)])],32)]),_:1})])]),_:1},8,["open"])],512)]))}},Mt=L(Ot,[["__scopeId","data-v-f3147420"]]);export{Mt as default};
