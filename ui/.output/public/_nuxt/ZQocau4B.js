import{_ as B}from"./ChBnuzYQ.js";import{q as F,a9 as U,l as H,r as y,W as L,c as u,b as n,w as M,u as e,a as t,d as x,t as l,T as w,e as f,$ as Q,aa as K,aj as O,aF as W,g as T,o as i,I as o,_ as z}from"./cTealXVQ.js";import{u as G}from"./CYLt1a9j.js";const P={class:"container mx-auto px-4 py-6 max-w-lg"},J={key:0,class:"vikinger-card !p-0 overflow-hidden"},X={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-white/20 flex items-center justify-center"},Y={class:"text-2xl font-black text-white"},Z={class:"text-white/80 mt-1"},ee={key:0,class:"p-6"},te={class:"grid grid-cols-2 gap-4 mb-6"},re={class:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 text-center"},se={class:"text-lg font-bold text-gray-900 dark:text-white mt-1"},ae={class:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 text-center"},oe={class:"text-lg font-bold text-green-600 dark:text-green-400 mt-1"},ne={class:"bg-gradient-to-r from-vikinger-purple/10 to-vikinger-cyan/10 rounded-xl p-4 text-center mb-6"},le={class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider"},ie={class:"text-2xl font-black text-vikinger-purple dark:text-vikinger-cyan mt-1"},ce={class:"p-6 pt-0"},de={key:1,class:"vikinger-card !p-0 overflow-hidden"},ue={class:"bg-gradient-to-r from-vikinger-purple to-vikinger-cyan p-6"},ge={class:"text-2xl font-black text-white flex items-center gap-3"},pe={class:"p-6"},ye={class:"grid grid-cols-2 gap-3 mb-6"},xe={key:0,class:"mb-6"},ve={class:"relative aspect-square bg-gray-900 rounded-xl overflow-hidden"},be={key:1,class:"absolute inset-x-0 top-0 h-1 bg-vikinger-cyan animate-scan"},fe={key:2,class:"absolute inset-8 border-2 border-vikinger-cyan rounded-xl pointer-events-none"},me={key:1,class:"mb-6"},ke={class:"flex gap-2"},he=["disabled"],we=["disabled"],_e={class:"mt-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4"},Ce={class:"flex gap-3"},je=F({__name:"redeem",setup(Se){const A=U(),g=G(),q=H(),v=y("code"),c=y(""),p=y(!1),d=y(!1),a=y(null),b=y(null),j=y(null);let m=null,k=null;const R=async()=>{d.value?h():await I()},I=async()=>{try{m=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),b.value&&(b.value.srcObject=m,b.value.play(),d.value=!0,S())}catch(s){console.error("Camera error:",s),g.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ")}},h=()=>{m&&(m.getTracks().forEach(s=>s.stop()),m=null),k&&(cancelAnimationFrame(k),k=null),d.value=!1},S=()=>{if(!b.value||!j.value||!d.value)return;const s=b.value,r=j.value,_=r.getContext("2d");if(!_||s.readyState!==s.HAVE_ENOUGH_DATA){k=requestAnimationFrame(S);return}r.width=s.videoWidth,r.height=s.videoHeight,_.drawImage(s,0,0,r.width,r.height),k=requestAnimationFrame(S)},V=async()=>{try{const s=await navigator.clipboard.readText();c.value=s.replace(/\D/g,"").slice(0,8),g.success("‡∏ß‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏•‡πâ‡∏ß")}catch{g.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ß‡∏≤‡∏á‡πÑ‡∏î‡πâ")}},D=async()=>{if(!(!c.value||p.value)){p.value=!0;try{const s=await A.post("/api/coupons/redeem",{coupon_code:c.value.replace(/\D/g,"")});s.success?(a.value={success:!0,message:s.message,type:s.data.type,amount:s.data.amount,new_balance:s.data.new_balance},s.data.type==="points"&&q.setPoints(s.data.new_balance),g.success(s.message||"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!")):(a.value={success:!1,message:s.message||"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ"},g.error(s.message||"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ"))}catch(s){a.value={success:!1,message:s.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"},g.error(s.message||"‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î")}finally{p.value=!1,h()}}},E=()=>{a.value=null,c.value=""},$=async()=>{if(confirm("‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?"))try{const s=await A.post(`/api/coupons/${a.value?.coupon_id}/cancel`);s.success?(g.success("‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!"),a.value={success:!1,message:"‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß"}):g.error(s.message||"‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ")}catch(s){console.error("Error canceling coupon:",s),g.error("‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡πÑ‡∏î‡πâ")}},N=s=>s.toLocaleString();return L(()=>{h()}),(s,r)=>{const _=B;return i(),u("div",P,[n(_,{to:"/earn/coupons",class:"inline-flex items-center gap-2 text-gray-500 dark:text-gray-400 hover:text-vikinger-purple dark:hover:text-vikinger-cyan mb-6 transition-colors"},{default:M(()=>[n(e(o),{icon:"fluent:arrow-left-24-regular",class:"w-5 h-5"}),r[4]||(r[4]=f(" ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á ",-1))]),_:1}),e(a)?(i(),u("div",J,[t("div",{class:w(["p-6 text-center",e(a).success?"bg-gradient-to-r from-green-500 to-emerald-500":"bg-gradient-to-r from-red-500 to-rose-500"])},[t("div",X,[n(e(o),{icon:e(a).success?"fluent:checkmark-circle-24-filled":"fluent:dismiss-circle-24-filled",class:"w-10 h-10 text-white"},null,8,["icon"])]),t("h2",Y,l(e(a).success?"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!":"‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"),1),t("p",Z,l(e(a).message),1)],2),e(a).success?(i(),u("div",ee,[t("div",te,[t("div",re,[r[5]||(r[5]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó",-1)),t("p",se,l(e(a).type==="points"?"üéØ ‡πÅ‡∏ï‡πâ‡∏°":"üí∞ ‡πÄ‡∏á‡∏¥‡∏ô"),1)]),t("div",ae,[r[6]||(r[6]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö",-1)),t("p",oe," +"+l(e(a).type==="wallet"?"‡∏ø":"")+l(N(e(a).amount))+" "+l(e(a).type==="points"?"‡πÅ‡∏ï‡πâ‡∏°":""),1)])]),t("div",ne,[t("p",le," ‡∏¢‡∏≠‡∏î"+l(e(a).type==="points"?"‡πÅ‡∏ï‡πâ‡∏°":"‡πÄ‡∏á‡∏¥‡∏ô")+"‡πÉ‡∏´‡∏°‡πà ",1),t("p",ie,l(e(a).type==="wallet"?"‡∏ø":"")+l(N(e(a).new_balance))+" "+l(e(a).type==="points"?"‡πÅ‡∏ï‡πâ‡∏°":""),1)])])):x("",!0),t("div",ce,[t("button",{onClick:E,class:"w-full py-3 bg-gradient-to-r from-vikinger-purple to-vikinger-cyan text-white rounded-xl font-bold hover:opacity-90 transition-all flex items-center justify-center gap-2"},[n(e(o),{icon:"fluent:qr-code-24-regular",class:"w-5 h-5"}),r[7]||(r[7]=f(" ‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏≠‡∏µ‡∏Å ",-1))]),e(a)&&e(a).success?(i(),u("button",{key:0,onClick:$,class:"w-full mt-3 py-3 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-bold hover:bg-gray-300 dark:hover:bg-gray-600 transition-all flex items-center justify-center gap-2"},[n(e(o),{icon:"fluent:arrow-left-24-regular",class:"w-5 h-5"}),r[8]||(r[8]=f(" ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á ",-1))])):x("",!0)])])):(i(),u("div",de,[t("div",ue,[t("h1",ge,[n(e(o),{icon:"fluent:qr-code-24-filled",class:"w-8 h-8"}),r[9]||(r[9]=f(" ‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á ",-1))]),r[10]||(r[10]=t("p",{class:"text-white/80 mt-1"},"‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á",-1))]),t("div",pe,[t("div",ye,[t("button",{onClick:r[0]||(r[0]=C=>{v.value="scan",h()}),class:w(["p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2",e(v)==="scan"?"border-vikinger-purple bg-vikinger-purple/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[n(e(o),{icon:"fluent:camera-24-regular",class:"w-8 h-8 text-vikinger-purple"}),r[11]||(r[11]=t("span",{class:"font-bold text-gray-900 dark:text-white text-sm"},"‡∏™‡πÅ‡∏Å‡∏ô QR Code",-1))],2),t("button",{onClick:r[1]||(r[1]=C=>{v.value="code",h()}),class:w(["p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2",e(v)==="code"?"border-vikinger-cyan bg-vikinger-cyan/10":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"])},[n(e(o),{icon:"fluent:keyboard-24-regular",class:"w-8 h-8 text-vikinger-cyan"}),r[12]||(r[12]=t("span",{class:"font-bold text-gray-900 dark:text-white text-sm"},"‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™",-1))],2)]),e(v)==="scan"?(i(),u("div",xe,[t("div",ve,[t("video",{ref_key:"videoRef",ref:b,class:"w-full h-full object-cover",autoplay:"",playsinline:""},null,512),t("canvas",{ref_key:"canvasRef",ref:j,class:"hidden"},null,512),e(d)?x("",!0):(i(),u("div",{key:0,class:"absolute inset-0 bg-gray-900/80 flex flex-col items-center justify-center cursor-pointer",onClick:R},[n(e(o),{icon:"fluent:camera-24-regular",class:"w-16 h-16 text-gray-400 mb-4"}),r[13]||(r[13]=t("p",{class:"text-gray-400"},"‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô",-1))])),e(d)?(i(),u("div",be)):x("",!0),e(d)?(i(),u("div",fe,[...r[14]||(r[14]=[t("div",{class:"absolute -top-1 -left-1 w-8 h-8 border-t-4 border-l-4 border-vikinger-cyan rounded-tl-lg"},null,-1),t("div",{class:"absolute -top-1 -right-1 w-8 h-8 border-t-4 border-r-4 border-vikinger-cyan rounded-tr-lg"},null,-1),t("div",{class:"absolute -bottom-1 -left-1 w-8 h-8 border-b-4 border-l-4 border-vikinger-cyan rounded-bl-lg"},null,-1),t("div",{class:"absolute -bottom-1 -right-1 w-8 h-8 border-b-4 border-r-4 border-vikinger-cyan rounded-br-lg"},null,-1)])])):x("",!0)]),t("button",{onClick:R,class:w(["w-full mt-4 py-3 rounded-xl font-bold transition-all flex items-center justify-center gap-2",e(d)?"bg-red-500 text-white hover:bg-red-600":"bg-vikinger-purple text-white hover:opacity-90"])},[n(e(o),{icon:e(d)?"fluent:stop-24-regular":"fluent:camera-24-regular",class:"w-5 h-5"},null,8,["icon"]),f(" "+l(e(d)?"‡∏´‡∏¢‡∏∏‡∏î‡∏™‡πÅ‡∏Å‡∏ô":"‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô"),1)],2)])):x("",!0),e(v)==="code"?(i(),u("div",me,[r[15]||(r[15]=t("label",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 block"}," ‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á (8 ‡∏´‡∏•‡∏±‡∏Å) ",-1)),t("div",ke,[Q(t("input",{"onUpdate:modelValue":r[2]||(r[2]=C=>W(c)?c.value=C:null),type:"text",inputmode:"numeric",pattern:"[0-9]*",maxlength:"8",placeholder:"00000000",class:"flex-1 px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-lg font-mono font-bold tracking-widest focus:ring-2 focus:ring-vikinger-purple focus:border-transparent",onInput:r[3]||(r[3]=C=>c.value=e(c).replace(/\D/g,"")),onKeyup:O(D,["enter"]),disabled:e(p)},null,40,he),[[K,e(c)]]),t("button",{onClick:V,class:"px-4 py-3 bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-all",title:"‡∏ß‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î"},[n(e(o),{icon:"fluent:clipboard-paste-24-regular",class:"w-6 h-6"})])]),r[16]||(r[16]=t("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2"}," ‡∏õ‡πâ‡∏≠‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç 8 ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á ",-1))])):x("",!0),t("button",{onClick:D,disabled:!e(c)||e(p),class:w(["w-full py-4 rounded-xl font-bold text-lg transition-all flex items-center justify-center gap-2",e(c)&&!e(p)?"bg-gradient-to-r from-vikinger-purple to-vikinger-cyan text-white shadow-lg hover:opacity-90":"bg-gray-200 dark:bg-gray-700 text-gray-400 dark:text-gray-500 cursor-not-allowed"])},[e(p)?(i(),T(e(o),{key:0,icon:"fluent:spinner-ios-20-regular",class:"w-5 h-5 animate-spin"})):(i(),T(e(o),{key:1,icon:"fluent:gift-24-regular",class:"w-5 h-5"})),f(" "+l(e(p)?"‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...":"‡∏£‡∏±‡∏ö‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á"),1)],10,we),t("div",_e,[t("div",Ce,[n(e(o),{icon:"fluent:info-24-regular",class:"w-5 h-5 text-gray-500 flex-shrink-0 mt-0.5"}),r[17]||(r[17]=t("div",{class:"text-xs text-gray-500 dark:text-gray-400 space-y-1"},[t("p",null,"‚Ä¢ ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏û‡∏µ‡∏¢‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á"),t("p",null,"‚Ä¢ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡∏õ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ"),t("p",null,"‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô")],-1))])])])]))])}}}),Ne=z(je,[["__scopeId","data-v-0c6bd89b"]]);export{Ne as default};
