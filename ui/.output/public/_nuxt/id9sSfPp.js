import{_ as N}from"./0NabHjdI.js";import{q as P,p as E,r as n,z as A,c as g,a as e,g as H,b as s,t as o,w as k,$ as S,u as d,aa as K,aj as q,ab as Q,F as T,k as j,d as $,a1 as G,a4 as J,aH as L,o as i,e as O,I as c,T as M,_ as W}from"./DvtEeXFW.js";const X={class:"space-y-6"},Y={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Z={class:"text-gray-500 dark:text-gray-400 mt-1"},ee={class:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},te={class:"flex flex-col sm:flex-row gap-4"},ae={class:"flex-1 relative"},re=["value"],se={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},oe={key:0,class:"p-8 text-center"},le={key:1,class:"overflow-x-auto"},ne={class:"w-full"},de={class:"divide-y divide-gray-100 dark:divide-gray-700"},ie={class:"px-6 py-4 whitespace-nowrap"},ce={class:"flex items-center gap-3"},ue=["src","alt"],ge={class:"font-medium text-gray-800 dark:text-white"},xe={class:"text-sm text-gray-500"},pe={class:"px-6 py-4 whitespace-nowrap"},ye={class:"text-gray-600 dark:text-gray-300"},ve={class:"px-6 py-4 whitespace-nowrap"},be={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},fe={class:"text-gray-600 dark:text-gray-300"},me={class:"px-6 py-4 whitespace-nowrap text-right"},ke={class:"flex items-center justify-end gap-2"},_e=["onClick"],we={key:0,class:"p-8 text-center"},$e={key:2,class:"px-6 py-4 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between"},Ce={class:"text-sm text-gray-500"},Be={class:"flex items-center gap-2"},De=["disabled"],Se={class:"px-3 py-1.5 text-sm text-gray-600 dark:text-gray-300"},Te=["disabled"],je={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},Le={class:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md shadow-xl"},Me={class:"text-center"},Re={class:"w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-4"},Ue={class:"text-gray-500 dark:text-gray-400"},Ve={class:"flex gap-3 mt-6"},ze=P({__name:"index",setup(Fe){const C=E().public.apiBase,v=n([]),_=n(!0),b=n(""),h=n("all"),l=n(1),f=n(1),w=n(10),m=n(0),x=n(!1),p=n(null),R=[{value:"all",label:"ทั้งหมด"},{value:"user",label:"ผู้ใช้ทั่วไป"},{value:"instructor",label:"ผู้สอน"},{value:"admin",label:"ผู้ดูแล"}],y=async()=>{_.value=!0;try{const r=L("token"),t=new URLSearchParams({page:l.value.toString(),per_page:w.value.toString(),...b.value&&{search:b.value},...h.value!=="all"&&{role:h.value}}),u=await $fetch(`${C}/api/admin/users?${t}`,{headers:{Authorization:`Bearer ${r.value}`}});u.success&&(v.value=u.data.data||u.data,f.value=u.data.last_page||1,m.value=u.data.total||v.value.length)}catch(r){console.error("Failed to fetch users:",r)}finally{_.value=!1}},B=()=>{l.value=1,y()},U=()=>{l.value=1,y()},D=r=>{l.value=r,y()},V=r=>{p.value=r,x.value=!0},z=async()=>{if(p.value)try{const r=L("token");await $fetch(`${C}/api/admin/users/${p.value.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${r.value}`}}),x.value=!1,p.value=null,y()}catch(r){console.error("Failed to delete user:",r)}},F=r=>{const t={active:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",inactive:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",suspended:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};return t[r]||t.inactive},I=r=>{const t={admin:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",instructor:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",user:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"};return t[r]||t.user};return A(()=>{y()}),(r,t)=>{const u=N;return i(),g("div",X,[e("div",Y,[e("div",null,[t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"จัดการผู้ใช้",-1)),e("p",Z," ผู้ใช้งานทั้งหมด "+o(m.value.toLocaleString())+" คน ",1)]),s(u,{to:"/nuxnan-admin/users/create",class:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-xl text-white transition-colors"},{default:k(()=>[s(d(c),{icon:"fluent:person-add-24-regular",class:"w-5 h-5"}),t[7]||(t[7]=O(" เพิ่มผู้ใช้ใหม่ ",-1))]),_:1})]),e("div",ee,[e("div",te,[e("div",ae,[s(d(c),{icon:"fluent:search-24-regular",class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>b.value=a),type:"text",placeholder:"ค้นหาผู้ใช้...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",onKeyup:q(B,["enter"])},null,544),[[K,b.value]])]),S(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>h.value=a),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:U},[(i(),g(T,null,j(R,a=>e("option",{key:a.value,value:a.value},o(a.label),9,re)),64))],544),[[Q,h.value]]),e("button",{onClick:B,class:"px-4 py-2.5 bg-indigo-600 hover:bg-indigo-700 rounded-xl text-white transition-colors"}," ค้นหา ")])]),e("div",se,[_.value?(i(),g("div",oe,[s(d(c),{icon:"fluent:spinner-ios-20-regular",class:"w-8 h-8 text-indigo-600 animate-spin mx-auto"}),t[8]||(t[8]=e("p",{class:"text-gray-500 mt-2"},"กำลังโหลดข้อมูล...",-1))])):(i(),g("div",le,[e("table",ne,[t[9]||(t[9]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," ผู้ใช้ "),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," อีเมล "),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," บทบาท "),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," สถานะ "),e("th",{class:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," วันที่สมัคร "),e("th",{class:"px-6 py-4 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," จัดการ ")])],-1)),e("tbody",de,[(i(!0),g(T,null,j(v.value,a=>(i(),g("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors"},[e("td",ie,[e("div",ce,[e("img",{src:a.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.name)}&background=6366f1&color=fff`,alt:a.name,class:"w-10 h-10 rounded-full object-cover"},null,8,ue),e("div",null,[e("p",ge,o(a.name),1),e("p",xe,"ID: "+o(a.id),1)])])]),e("td",pe,[e("span",ye,o(a.email),1)]),e("td",ve,[e("span",{class:M([I(a.role),"px-2.5 py-1 rounded-full text-xs font-medium"])},o(a.role||"user"),3)]),e("td",be,[e("span",{class:M([F(a.status||"active"),"px-2.5 py-1 rounded-full text-xs font-medium"])},o(a.status||"active"),3)]),e("td",he,[e("span",fe,o(new Date(a.created_at).toLocaleDateString("th-TH")),1)]),e("td",me,[e("div",ke,[s(u,{to:`/nuxnan-admin/users/${a.id}`,class:"p-2 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-lg transition-colors"},{default:k(()=>[s(d(c),{icon:"fluent:eye-24-regular",class:"w-5 h-5"})]),_:1},8,["to"]),s(u,{to:`/nuxnan-admin/users/${a.id}/edit`,class:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg transition-colors"},{default:k(()=>[s(d(c),{icon:"fluent:edit-24-regular",class:"w-5 h-5"})]),_:1},8,["to"]),e("button",{onClick:Ne=>V(a),class:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors"},[s(d(c),{icon:"fluent:delete-24-regular",class:"w-5 h-5"})],8,_e)])])]))),128))])]),v.value.length===0?(i(),g("div",we,[s(d(c),{icon:"fluent:people-24-regular",class:"w-12 h-12 text-gray-300 mx-auto"}),t[10]||(t[10]=e("p",{class:"text-gray-500 mt-2"},"ไม่พบผู้ใช้งาน",-1))])):$("",!0)])),f.value>1?(i(),g("div",$e,[e("p",Ce," แสดง "+o((l.value-1)*w.value+1)+" - "+o(Math.min(l.value*w.value,m.value))+" จาก "+o(m.value)+" รายการ ",1),e("div",Be,[e("button",{disabled:l.value===1,onClick:t[2]||(t[2]=a=>D(l.value-1)),class:"p-2 rounded-lg border border-gray-200 dark:border-gray-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[s(d(c),{icon:"fluent:chevron-left-24-regular",class:"w-5 h-5"})],8,De),e("span",Se," หน้า "+o(l.value)+" / "+o(f.value),1),e("button",{disabled:l.value===f.value,onClick:t[3]||(t[3]=a=>D(l.value+1)),class:"p-2 rounded-lg border border-gray-200 dark:border-gray-600 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[s(d(c),{icon:"fluent:chevron-right-24-regular",class:"w-5 h-5"})],8,Te)])])):$("",!0)]),(i(),H(J,{to:"body"},[s(G,{name:"modal"},{default:k(()=>[x.value?(i(),g("div",je,[e("div",{class:"absolute inset-0 bg-black/50",onClick:t[4]||(t[4]=a=>x.value=!1)}),e("div",Le,[e("div",Me,[e("div",Re,[s(d(c),{icon:"fluent:warning-24-regular",class:"w-6 h-6 text-red-600 dark:text-red-400"})]),t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white mb-2"}," ยืนยันการลบผู้ใช้ ",-1)),e("p",Ue,' คุณต้องการลบผู้ใช้ "'+o(p.value?.name)+'" ใช่หรือไม่? การกระทำนี้ไม่สามารถย้อนกลับได้ ',1)]),e("div",Ve,[e("button",{onClick:t[5]||(t[5]=a=>x.value=!1),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," ยกเลิก "),e("button",{onClick:z,class:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors"}," ลบผู้ใช้ ")])])])):$("",!0)]),_:1})]))])}}}),Ae=W(ze,[["__scopeId","data-v-ad6b6d18"]]);export{Ae as default};
