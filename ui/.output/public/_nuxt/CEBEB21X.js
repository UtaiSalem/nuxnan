import T from"./BFyhvphK.js";import{_ as P}from"./D5g2IHVC.js";import{r as p,z,n as q,c as n,o as i,a as t,b as g,e as h,u as c,I as _,d as w,$ as d,aa as u,ab as f,F as V,k as C,t as k,w as A,ah as j,ai as U,j as E}from"./cTealXVQ.js";import"./Dtfmjnau.js";import"./ChBnuzYQ.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./CYLt1a9j.js";import"./srasqk13.js";import"./BZ03tRGr.js";const H={class:"bg-white dark:bg-gray-800 p-8 shadow-sm rounded-2xl border border-gray-100 dark:border-gray-700"},W={class:"mb-8 border-b border-gray-100 dark:border-gray-700 pb-4"},Z={class:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2"},G={class:"grid grid-cols-1 lg:grid-cols-12 gap-8"},J={class:"lg:col-span-4"},K=["src"],Q={class:"absolute inset-0 flex flex-col items-center justify-center bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity"},X={key:1,class:"absolute inset-0 flex flex-col items-center justify-center text-gray-400"},Y={class:"lg:col-span-8 space-y-4"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee=["value"],te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},re=["value"],le=["value"],ae={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-8"},se={class:"space-y-4"},de={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},ne={class:"relative inline-flex items-center cursor-pointer"},ie={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},ue={class:"relative inline-flex items-center cursor-pointer"},ge={class:"space-y-4"},pe={class:"flex items-center justify-between mb-2"},me={class:"relative inline-flex items-center cursor-pointer"},be={key:0,class:"space-y-3"},ye={class:"grid grid-cols-2 gap-3"},ce={class:"flex"},fe={class:"p-3 bg-emerald-50 rounded-lg text-emerald-800 text-sm flex justify-between font-bold"},ve={class:"pt-2"},xe={__name:"CourseSettings",props:{course:Object,isCourseAdmin:Boolean},emits:["update-course"],setup(m,{emit:b}){const v=m,s=b,r=p({academy_id:"",code:"",name:"",description:"",category:"",level:"",credit_units:0,hours_per_week:0,start_date:null,end_date:null,auto_accept_members:!1,tuition_fees:0,saleable:!1,price:0,discount:0,discount_type:"fixed",semester:"",academic_year:"",status:!0,cover:null}),o=p(null),y=p(null),O=p([null,null]),S=p([{name:"ภาษาไทย"},{name:"คณิตศาสตร์"},{name:"วิทยาศาสตร์"},{name:"สังคมศึกษา ศาสนา และวัฒนธรรม"},{name:"สุขศึกษาและพลศึกษา"},{name:"ศิลปะ"},{name:"การงานอาชีพและเทคโนโลยี"},{name:"ภาษาต่างประเทศ"}]),F=p([{level:"ชั้นประถมศึกษาปีที่ 1"},{level:"ชั้นประถมศึกษาปีที่ 2"},{level:"ชั้นประถมศึกษาปีที่ 3"},{level:"ชั้นประถมศึกษาปีที่ 4"},{level:"ชั้นประถมศึกษาปีที่ 5"},{level:"ชั้นประถมศึกษาปีที่ 6"},{level:"ชั้นมัธยมศึกษาปีที่ 1"},{level:"ชั้นมัธยมศึกษาปีที่ 2"},{level:"ชั้นมัธยมศึกษาปีที่ 3"},{level:"ชั้นมัธยมศึกษาปีที่ 4"},{level:"ชั้นมัธยมศึกษาปีที่ 5"},{level:"ชั้นมัธยมศึกษาปีที่ 6"}]),M=p([]);z(async()=>{$(),N()});function N(){if(!v.course)return;const a=v.course;r.value={academy_id:a.academy_id||"",code:a.code||"",name:a.name||"",description:a.description||"",category:a.category||"",level:a.level||"",credit_units:a.credit_units||0,hours_per_week:a.hours_per_week||0,auto_accept_members:a.course_settings?.auto_accept_members==1,tuition_fees:a.tuition_fees||0,saleable:a.saleable==1,price:a.price||0,discount:a.discount||0,discount_type:"fixed",semester:a.semester||"",academic_year:a.academic_year||"",status:a.status==1,cover:null},a.start_date&&(r.value.start_date=new Date(a.start_date)),a.end_date&&(r.value.end_date=new Date(a.end_date)),O.value=[r.value.start_date,r.value.end_date],a.cover_url?o.value=a.cover_url:a.cover&&(o.value=a.cover.startsWith("http")?a.cover:`/storage/images/courses/covers/${a.cover}`)}async function $(){try{const a=await axios.get("/academies/users/"+usePage().props.auth.user.id+"/my-academies");a.data.success&&(M.value=a.data.academies)}catch(a){console.error("Failed to fetch academies",a)}}const B=()=>{y.value.click()};function I(a){const e=a.target.files[0];e&&(r.value.cover=e,o.value=URL.createObjectURL(e))}function L(){s("update-course",r.value)}const R=q(()=>{if(!r.value.saleable)return 0;const a=Number(r.value.price)||0,e=Number(r.value.discount)||0;if(r.value.discount_type==="percent"){const x=a*e/100;return Math.max(0,a-x)}return Math.max(0,a-e)});return(a,e)=>{const x=P;return i(),n("div",H,[t("div",W,[t("h3",Z,[g(c(_),{icon:"mdi:cog",class:"text-violet-500"}),e[19]||(e[19]=h(" ตั้งค่ารายวิชา ",-1))]),e[20]||(e[20]=t("p",{class:"text-gray-500 dark:text-gray-400 text-sm mt-1"},"แก้ไขข้อมูลและรายละเอียดของรายวิชา",-1))]),t("form",{onSubmit:E(L,["prevent"]),class:"space-y-8"},[t("div",G,[t("div",J,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"รูปภาพปก",-1)),t("div",{class:"group relative aspect-video w-full rounded-xl overflow-hidden bg-gray-100 dark:bg-gray-900 border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-violet-500 transition-colors cursor-pointer",onClick:B},[o.value?(i(),n("img",{key:0,src:o.value,class:"w-full h-full object-cover"},null,8,K)):w("",!0),t("div",Q,[g(c(_),{icon:"heroicons:camera",class:"w-8 h-8 text-white mb-2"}),e[21]||(e[21]=t("span",{class:"text-white text-xs"},"เปลี่ยนรูป",-1))]),o.value?w("",!0):(i(),n("div",X,[g(c(_),{icon:"heroicons:photo",class:"w-10 h-10 mb-2"}),e[22]||(e[22]=t("span",{class:"text-xs"},"อัปโหลด",-1))])),t("input",{type:"file",class:"hidden",accept:"image/*",ref_key:"coverInput",ref:y,onChange:I},null,544)])]),t("div",Y,[t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[h("ชื่อรายวิชา "),t("span",{class:"text-red-500"},"*")],-1)),d(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>r.value.name=l),required:"",class:"block w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 focus:outline-none"},null,512),[[u,r.value.name]])]),t("div",D,[t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"รหัสวิชา",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=l=>r.value.code=l),class:"block w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 focus:outline-none"},null,512),[[u,r.value.code]])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"สถานศึกษา (Academy)",-1)),d(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.academy_id=l),class:"block w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 focus:outline-none"},[e[26]||(e[26]=t("option",{value:""},"-- ไม่สังกัด (อิสระ) --",-1)),(i(!0),n(V,null,C(M.value,l=>(i(),n("option",{key:l.id,value:l.id},k(l.name),9,ee))),128))],512),[[f,r.value.academy_id]]),e[28]||(e[28]=t("p",{class:"text-xs text-gray-500 mt-1"},'เลือกสถานศึกษาที่ต้องการสังกัด หรือเลือก "ไม่สังกัด" เพื่อเป็นวิชาอิสระ',-1))])]),t("div",null,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"คำอธิบายรายวิชา",-1)),d(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=l=>r.value.description=l),rows:"3",class:"block w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-violet-500 focus:outline-none"},null,512),[[u,r.value.description]])])])]),e[54]||(e[54]=t("hr",{class:"border-gray-100 dark:border-gray-700"},null,-1)),t("div",te,[t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"กลุ่มสาระ",-1)),d(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.category=l),class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},[e[30]||(e[30]=t("option",{value:""},"เลือกกลุ่มสาระ",-1)),(i(!0),n(V,null,C(S.value,l=>(i(),n("option",{key:l.name,value:l.name},k(l.name),9,re))),128))],512),[[f,r.value.category]])]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"ระดับชั้น",-1)),d(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>r.value.level=l),class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},[e[32]||(e[32]=t("option",{value:""},"เลือกระดับชั้น",-1)),(i(!0),n(V,null,C(F.value,l=>(i(),n("option",{key:l.level,value:l.level},k(l.level),9,le))),128))],512),[[f,r.value.level]])]),t("div",null,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"หน่วยกิต",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[6]||(e[6]=l=>r.value.credit_units=l),min:"0",class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},null,512),[[u,r.value.credit_units]])]),t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"ชม./สัปดาห์",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[7]||(e[7]=l=>r.value.hours_per_week=l),min:"0",class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},null,512),[[u,r.value.hours_per_week]])])]),t("div",ae,[t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"วันที่เริ่ม",-1)),g(x,null,{default:A(()=>[g(c(j),{modelValue:r.value.start_date,"onUpdate:modelValue":e[8]||(e[8]=l=>r.value.start_date=l),format:"dd/MM/yyyy","auto-apply":"","input-class-name":"!bg-white dark:!bg-gray-700 !border-gray-200 dark:!border-gray-600 !rounded-xl !py-2.5 !text-gray-900 dark:!text-white"},null,8,["modelValue"])]),_:1})]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"วันที่สิ้นสุด",-1)),g(x,null,{default:A(()=>[g(c(j),{modelValue:r.value.end_date,"onUpdate:modelValue":e[9]||(e[9]=l=>r.value.end_date=l),format:"dd/MM/yyyy","auto-apply":"","input-class-name":"!bg-white dark:!bg-gray-700 !border-gray-200 dark:!border-gray-600 !rounded-xl !py-2.5 !text-gray-900 dark:!text-white"},null,8,["modelValue"])]),_:1})]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"ภาคเรียน",-1)),d(t("select",{"onUpdate:modelValue":e[10]||(e[10]=l=>r.value.semester=l),class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},[...e[38]||(e[38]=[t("option",{value:"1"},"ภาคเรียนที่ 1",-1),t("option",{value:"2"},"ภาคเรียนที่ 2",-1),t("option",{value:"summer"},"ภาคเรียนฤดูร้อน",-1)])],512),[[f,r.value.semester]])]),t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"ปีการศึกษา",-1)),d(t("input",{type:"text","onUpdate:modelValue":e[11]||(e[11]=l=>r.value.academic_year=l),class:"w-full px-4 py-2.5 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-violet-500"},null,512),[[u,r.value.academic_year]])])]),e[55]||(e[55]=t("hr",{class:"border-gray-100 dark:border-gray-700"},null,-1)),t("div",oe,[t("div",se,[e[45]||(e[45]=t("h4",{class:"font-medium text-gray-900 dark:text-white"},"การตั้งค่าทั่วไป",-1)),t("div",de,[e[42]||(e[42]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"ตอบรับสมาชิกอัตโนมัติ",-1)),t("label",ne,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=l=>r.value.auto_accept_members=l),class:"sr-only peer"},null,512),[[U,r.value.auto_accept_members]]),e[41]||(e[41]=t("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-violet-600"},null,-1))])]),t("div",ie,[e[44]||(e[44]=t("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"เปิดสถานะรายวิชา (Active)",-1)),t("label",ue,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=l=>r.value.status=l),class:"sr-only peer"},null,512),[[U,r.value.status]]),e[43]||(e[43]=t("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-500"},null,-1))])])]),t("div",ge,[e[53]||(e[53]=t("h4",{class:"font-medium text-gray-900 dark:text-white"},"ราคาและค่าธรรมเนียม",-1)),t("div",pe,[e[47]||(e[47]=t("span",{class:"text-sm text-gray-500"},"เปิดขายรายวิชา",-1)),t("label",me,[d(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=l=>r.value.saleable=l),class:"sr-only peer"},null,512),[[U,r.value.saleable]]),e[46]||(e[46]=t("div",{class:"w-11 h-6 bg-gray-200 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-emerald-500"},null,-1))])]),r.value.saleable?(i(),n("div",be,[t("div",ye,[t("div",null,[e[48]||(e[48]=t("label",{class:"text-xs text-gray-500 block mb-1"},"ราคาปกติ (฿)",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[15]||(e[15]=l=>r.value.price=l),class:"w-full px-3 py-2 border rounded-lg bg-gray-50"},null,512),[[u,r.value.price]])]),t("div",null,[e[50]||(e[50]=t("label",{class:"text-xs text-gray-500 block mb-1"},"ส่วนลด",-1)),t("div",ce,[d(t("input",{type:"number","onUpdate:modelValue":e[16]||(e[16]=l=>r.value.discount=l),class:"w-full px-3 py-2 border rounded-l-lg bg-gray-50"},null,512),[[u,r.value.discount]]),d(t("select",{"onUpdate:modelValue":e[17]||(e[17]=l=>r.value.discount_type=l),class:"border-y border-r rounded-r-lg bg-gray-100 px-2"},[...e[49]||(e[49]=[t("option",{value:"fixed"},"฿",-1),t("option",{value:"percent"},"%",-1)])],512),[[f,r.value.discount_type]])])])]),t("div",fe,[e[51]||(e[51]=t("span",null,"ราคาสุทธิ",-1)),t("span",null,"฿"+k(R.value.toLocaleString()),1)])])):w("",!0),t("div",ve,[e[52]||(e[52]=t("label",{class:"text-sm text-gray-500 block mb-1"},"ค่าธรรมเนียมเข้าเรียน (Point)",-1)),d(t("input",{type:"number","onUpdate:modelValue":e[18]||(e[18]=l=>r.value.tuition_fees=l),class:"w-full px-4 py-2 border rounded-xl bg-gray-50 dark:bg-gray-700 dark:text-white"},null,512),[[u,r.value.tuition_fees]])])])]),e[56]||(e[56]=t("div",{class:"pt-6 flex justify-end"},[t("button",{type:"submit",class:"px-8 py-3 bg-gradient-to-r from-violet-600 to-indigo-600 text-white rounded-xl font-bold shadow-lg shadow-violet-200 dark:shadow-none hover:shadow-xl hover:-translate-y-0.5 transition-all"}," บันทึกการเปลี่ยนแปลง ")],-1))],32)])}}},ke={key:0,class:"mt-4"},Se={__name:"Settings",props:{course:Object,lessons:Object,groups:Object,isCourseAdmin:Boolean,courseMemberOfAuth:Object},setup(m){const b=m;async function v(s){try{const r={headers:{"Content-Type":"multipart/form-data"}};let o=new FormData;o.append("name",s.name),o.append("code",s.code),o.append("description",s.description),o.append("category",s.category),o.append("level",s.level),o.append("credit_units",s.credit_units),o.append("hours_per_week",s.hours_per_week),o.append("start_date",s.start_date),o.append("end_date",s.end_date),o.append("auto_accept_members",s.auto_accept_members),o.append("tuition_fees",s.tuition_fees),o.append("saleable",s.saleable),o.append("price",s.price),o.append("status",s.status),o.append("academy_id",s.academy_id),s.cover&&o.append("cover",s.cover),o.append("_method","put");let y=await axios.put(`/courses/${b.course.data.id}`,o,r);y.data&&y.data.success&&router.reload({only:["course"]})}catch{}}return(s,r)=>(i(),n("div",null,[g(T,{course:m.course,isCourseAdmin:m.isCourseAdmin,activeTab:8,courseMemberOfAuth:m.courseMemberOfAuth},{courseContent:A(()=>[b.isCourseAdmin?(i(),n("div",ke,[g(xe,{course:b.course.data,isCourseAdmin:b.isCourseAdmin,onUpdateCourse:r[0]||(r[0]=o=>v(o))},null,8,["course","isCourseAdmin"])])):w("",!0)]),_:1},8,["course","isCourseAdmin","courseMemberOfAuth"])]))}};export{Se as default};
