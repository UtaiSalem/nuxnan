import{r as h,n as g,c as i,b as m,a as t,u as w,t as u,$ as y,aa as k,e as b,F as p,k as _,o as d}from"./DvtEeXFW.js";import M from"./BweDkJ29.js";import{H as C}from"./DX2fB3Es.js";import"./C9jVIhCz.js";import"./unovbEJl.js";import"./BQxta0Da.js";import"./Ch2gumr2.js";const B={class:"min-h-screen"},S={class:"max-w-7xl bg-slate-200 mx-auto"},U={class:"bg-white rounded-2xl shadow-xl p-6 mb-6"},j={class:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4"},z={class:"space-y-2"},$={class:"flex gap-4"},H={class:"flex items-center gap-2"},T={class:"px-3 py-2 bg-blue-100 text-blue-800 rounded-lg font-bold"},I={class:"flex items-center gap-2 text-gray-600"},L={class:"font-medium"},V={class:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full md:w-auto"},F={class:"relative w-full sm:w-80"},N={class:"flex items-center w-full sm:w-auto"},A={key:0,class:"flex flex-col items-center justify-center bg-white rounded-2xl shadow-xl p-12"},D={key:1,class:"grid grid-cols-1 gap-4"},O={__name:"StudentCardByRoom",props:{students:{type:Array,default:()=>[]},room:String,level:String},setup(n){const r=n,l=h(""),f=g(()=>l.value?r.students?r.students.filter(s=>{const e=l.value.toLowerCase();return s.student_name_th&&s.student_name_th.toLowerCase().includes(e)||s.student_id&&s.student_id.toString().includes(l.value)}):[]:r.students),x=async({id:s,studentId:e,file:o})=>{if(!o||!e)return;const a=new FormData;a.append("photo",o),a.append("_method","patch");try{const c=await axios.post("/student-card/admin/upload-photo/"+s,a,{headers:{"Content-Type":"multipart/form-data"}})}catch(c){console.error("Upload failed:",c)}},v=async s=>{try{if((await axios.put(`/student/${s.id}`,s)).data.success){const o=r.students.findIndex(a=>a.id===s.id);o!==-1&&(r.students[o]={...r.students[o],...s}),alert("บันทึกข้อมูลสำเร็จ")}}catch(e){console.error("Update failed:",e),alert("เกิดข้อผิดพลาดในการบันทึกข้อมูล")}};return(s,e)=>(d(),i(p,null,[m(w(C),{title:`ข้อมูลนักเรียน - ชั้น ม.${n.level}/${n.room}`},null,8,["title"]),t("div",B,[t("div",S,[t("div",U,[t("div",j,[t("div",z,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold text-gray-800"},"ข้อมูลนักเรียน",-1)),t("div",$,[t("div",H,[t("span",T," ชั้น ม."+u(n.level)+"/"+u(n.room),1)]),t("div",I,[e[2]||(e[2]=t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1)),t("span",L,u(n.students?.length||0)+" คน",1)])])]),t("div",V,[t("div",F,[y(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),placeholder:"ค้นหาชื่อหรือรหัสนักเรียน...",class:"w-full px-4 py-2 pr-10 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"},null,512),[[k,l.value]]),e[4]||(e[4]=t("svg",{class:"w-5 h-5 text-gray-400 absolute right-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))]),t("div",N,[t("button",{onClick:e[1]||(e[1]=o=>s.$inertia.visit("/student-card")),class:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-200"},[...e[5]||(e[5]=[t("svg",{class:"w-5 h-5 inline-block mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),b(" กลับ ",-1)])])])])])]),!n.students||n.students.length===0?(d(),i("div",A,[...e[6]||(e[6]=[t("svg",{class:"w-16 h-16 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),t("p",{class:"mt-4 text-gray-500 text-lg"},"ไม่พบข้อมูลนักเรียน",-1)])])):(d(),i("div",D,[(d(!0),i(p,null,_(f.value,o=>(d(),i("div",{key:o.id},[m(M,{studentInfo:o,onUpdate:v,onUploadImage:x},null,8,["studentInfo"])]))),128))]))])])],64))}};export{O as default};
