import{_ as De}from"./CNJKLhSn.js";import{q as Q,y as Be,r as k,a3 as W,n as K,z as re,W as ne,c as m,o as c,a as e,b as d,T as w,g as H,d as _,u as r,I as u,t as p,a1 as Te,w as O,F as G,k as Y,j as je,ae as ie,_ as de,a9 as ue,h as Se,e as B,s as Me,$ as R,aa as F,U as oe}from"./CHs-R6Sv.js";import{C as Ie}from"./DEyJstjP.js";import{u as Ue}from"./B34yIM1Q.js";import{S as P}from"./BQxta0Da.js";import"./CqN4doyA.js";const Ee=["title"],Le={key:0,class:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-36 bg-white dark:bg-gray-800 rounded-xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50"},Ve={class:"py-1"},Re=["onClick","disabled"],Fe={class:"flex-1 text-left"},Ne=Q({__name:"AttendanceStatusBadge",props:{status:{},attendanceId:{},memberId:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["update-status"],setup(x,{emit:C}){const{$apiFetch:A}=Be(),$=x,y=C,f=k($.status),j=k(!1),D=k(!1),T=k(null);W(()=>$.status,s=>{f.value=s});const U=[{value:1,label:"มา",icon:"heroicons:check-circle",color:"green"},{value:2,label:"สาย",icon:"heroicons:clock",color:"amber"},{value:3,label:"ลา",icon:"heroicons:document-text",color:"blue"},{value:null,label:"ขาด",icon:"heroicons:x-circle",color:"red"}],v=K(()=>{const s=f.value;return s===1?{label:"มา",icon:"heroicons:check-circle-20-solid",color:"green",bgClass:"bg-green-50 dark:bg-green-900/40",textClass:"text-green-800 dark:text-green-200",iconClass:"text-green-600 dark:text-green-400"}:s===2?{label:"สาย",icon:"heroicons:clock-20-solid",color:"amber",bgClass:"bg-amber-50 dark:bg-amber-900/40",textClass:"text-amber-800 dark:text-amber-200",iconClass:"text-amber-600 dark:text-amber-400"}:s===3?{label:"ลา",icon:"heroicons:document-text-20-solid",color:"blue",bgClass:"bg-blue-50 dark:bg-blue-900/40",textClass:"text-blue-800 dark:text-blue-200",iconClass:"text-blue-600 dark:text-blue-400"}:{label:"ขาด",icon:"heroicons:x-circle-20-solid",color:"red",bgClass:"bg-red-50 dark:bg-red-900/40",textClass:"text-red-800 dark:text-red-200",iconClass:"text-red-600 dark:text-red-400"}}),S=()=>{$.isCourseAdmin&&(j.value=!j.value)},b=()=>{j.value=!1},n=async s=>{if(!D.value){if(f.value===s||f.value===null&&s===null){b();return}D.value=!0;try{const o=s===null?0:s;await A(`/api/attendances/${$.attendanceId}/member/${$.memberId}/update-status`,{method:"POST",body:{status:o}}),f.value=s,y("update-status",{attendanceId:$.attendanceId,memberId:$.memberId,status:s})}catch(o){console.error("Failed to update status:",o)}finally{D.value=!1,await ie(),b()}}},l=s=>{T.value&&!T.value.contains(s.target)&&b()};return re(()=>{document.addEventListener("click",l)}),ne(()=>{document.removeEventListener("click",l)}),(s,o)=>(c(),m("div",{ref_key:"menuRef",ref:T,class:"relative inline-flex items-center gap-1"},[e("div",{class:w(["inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-semibold transition-all duration-200 border",v.value.bgClass,v.value.textClass,v.value.color==="green"?"border-green-200 dark:border-green-800":"",v.value.color==="amber"?"border-amber-200 dark:border-amber-800":"",v.value.color==="blue"?"border-blue-200 dark:border-blue-800":"",v.value.color==="red"?"border-red-200 dark:border-red-800":"",x.isCourseAdmin?"cursor-pointer hover:shadow-sm active:scale-95":""]),onClick:S,title:x.isCourseAdmin?"คลิกเพื่อเปลี่ยนสถานะ":v.value.label},[d(r(u),{icon:D.value?"svg-spinners:ring-resize":v.value.icon,class:w(["w-4 h-4",v.value.iconClass])},null,8,["icon","class"]),e("span",null,p(v.value.label),1),x.isCourseAdmin&&!D.value?(c(),H(r(u),{key:0,icon:"heroicons:chevron-down",class:w(["w-3 h-3 ml-0.5 transition-transform duration-200",[{"rotate-180":j.value},v.value.iconClass]])},null,8,["class"])):_("",!0)],10,Ee),d(Te,{"enter-active-class":"transition ease-out duration-150","enter-from-class":"opacity-0 scale-95 -translate-y-1","enter-to-class":"opacity-100 scale-100 translate-y-0","leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100 scale-100 translate-y-0","leave-to-class":"opacity-0 scale-95 -translate-y-1"},{default:O(()=>[j.value&&x.isCourseAdmin?(c(),m("div",Le,[o[0]||(o[0]=e("div",{class:"px-3 py-2 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600"},[e("p",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide"},"เลือกสถานะ")],-1)),e("div",Ve,[(c(),m(G,null,Y(U,g=>e("button",{key:g.value??"null",onClick:je(E=>n(g.value),["stop"]),disabled:D.value,class:w(["w-full flex items-center gap-2.5 px-3 py-2.5 text-sm font-medium transition-all duration-150 hover:bg-gray-100 dark:hover:bg-gray-700/50",[f.value===g.value||f.value===null&&g.value===null||f.value===void 0&&g.value===null||f.value===0&&g.value===null?`bg-${g.color}-50 dark:bg-${g.color}-900/20 text-${g.color}-700 dark:text-${g.color}-300`:"text-gray-700 dark:text-gray-300"]])},[e("div",{class:w(["w-7 h-7 rounded-full flex items-center justify-center",g.color==="green"?"bg-green-100 dark:bg-green-900/30":"",g.color==="amber"?"bg-amber-100 dark:bg-amber-900/30":"",g.color==="blue"?"bg-blue-100 dark:bg-blue-900/30":"",g.color==="red"?"bg-red-100 dark:bg-red-900/30":""])},[d(r(u),{icon:g.icon,class:w(["w-4 h-4",[g.color==="green"?"text-green-600 dark:text-green-400":"",g.color==="amber"?"text-amber-600 dark:text-amber-400":"",g.color==="blue"?"text-blue-600 dark:text-blue-400":"",g.color==="red"?"text-red-600 dark:text-red-400":""]])},null,8,["icon","class"])],2),e("span",Fe,p(g.label),1),f.value===g.value||f.value===null&&g.value===null||f.value===void 0&&g.value===null||f.value===0&&g.value===null?(c(),H(r(u),{key:0,icon:"heroicons:check",class:w(["w-4 h-4",[g.color==="green"?"text-green-600":"",g.color==="amber"?"text-amber-600":"",g.color==="blue"?"text-blue-600":"",g.color==="red"?"text-red-600":""]])},null,8,["class"])):_("",!0)],10,Re)),64))])])):_("",!0)]),_:1})],512))}}),Oe=de(Ne,[["__scopeId","data-v-def1b4d7"]]),Pe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ze={class:"w-full"},He={class:"bg-gradient-to-r from-gray-50 via-gray-100 to-slate-100 dark:from-gray-700 dark:via-gray-800 dark:to-gray-700 border-b-2 border-gray-200 dark:border-gray-600"},Ge={class:"text-center"},qe={scope:"col",class:"px-6 py-4 border border-slate-300 dark:border-gray-600 font-black text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 min-w-[280px] sticky left-0 z-20"},We={class:"flex items-center justify-center gap-3"},Ye={class:"w-10 h-10 bg-gradient-to-br from-violet-100 to-purple-100 dark:from-violet-900 dark:to-purple-900 rounded-xl flex items-center justify-center shadow-sm"},Je=["onClick"],Ke={class:"text-xs text-gray-500 dark:text-gray-400"},Qe={class:"mt-1"},Xe={key:0,scope:"col",class:"px-3 py-4 border bg-white dark:bg-gray-800 sticky right-0 z-20"},Ze={class:"bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700"},et={class:"p-2 border border-slate-300 dark:border-gray-600 whitespace-nowrap sticky left-0 z-10 bg-white dark:bg-gray-800"},tt={class:"flex items-center min-w-fit group"},rt={class:"relative"},st=["src","alt"],at={class:"ml-3 flex-1"},lt={class:"text-gray-900 dark:text-gray-100 font-bold text-md tracking-wide group-hover:text-blue-700 dark:group-hover:text-blue-400 transition-colors duration-200"},ot={class:"flex items-center mt-1 space-x-2 text-xs"},nt={key:0,class:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-violet-100 to-purple-100 dark:from-violet-900/50 dark:to-purple-900/50 text-violet-700 dark:text-violet-300 rounded-full font-medium border border-violet-200 dark:border-violet-700"},it={key:1,class:"inline-flex items-center gap-1 px-2 py-1 bg-gradient-to-r from-blue-100 to-indigo-100 dark:from-blue-900/50 dark:to-indigo-900/50 text-blue-700 dark:text-blue-300 rounded-full font-medium border border-blue-200 dark:border-blue-700"},dt={class:"flex justify-center items-center"},ut={key:0},ct=["colspan"],gt={class:"flex flex-col items-center justify-center"},bt=Q({__name:"AttendancesTable",props:{attendances:{},groupMembers:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["create","view-details","edit","delete","update-status"],setup(x,{emit:C}){const{getAvatarUrl:A}=Ue(),$=x,y=C,f=b=>b?new Date(b).toLocaleDateString("th-TH",{day:"numeric",month:"short"}):"",j=K(()=>[...$.attendances].sort((b,n)=>{const l=new Date(b.date||b.start_at||b.created_at).getTime(),s=new Date(n.date||n.start_at||n.created_at).getTime();return l-s})),D=(b,n)=>b.details?.find(s=>s.course_member_id===n)?.status,T=b=>A(b.user||b),U=b=>{const n=b.target,l=n.alt||"User";n.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(l)}&color=7F9CF5&background=EBF4FF`},v=k(null),S=async()=>{await ie(),v.value&&(v.value.scrollLeft=v.value.scrollWidth)};return re(()=>{S()}),W(()=>$.attendances,()=>{S()},{deep:!0}),(b,n)=>(c(),m("div",Pe,[e("div",{ref_key:"tableContainer",ref:v,class:"relative overflow-x-auto"},[e("table",ze,[e("thead",He,[e("tr",Ge,[e("th",qe,[e("div",We,[e("div",Ye,[d(r(u),{icon:"fluent:people-24-filled",class:"w-5 h-5 text-violet-600 dark:text-violet-400"})]),n[2]||(n[2]=e("span",{class:"uppercase tracking-wide"},"สมาชิก",-1))])]),(c(!0),m(G,null,Y(r(j),(l,s)=>(c(),m("th",{scope:"col",key:l.id,class:"px-3 py-4 border border-slate-300 dark:border-gray-600 min-w-[100px]"},[e("button",{onClick:o=>y("view-details",l),class:"flex flex-col justify-center items-center mx-auto text-sm font-bold text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-xl px-3 py-2 transition-all duration-300 transform hover:scale-105 shadow-sm hover:shadow-md"},[e("span",Ke,"#"+p(s+1),1),e("span",Qe,p(f(l.date)),1),d(r(u),{icon:"fluent:eye-24-regular",width:"16",height:"16",class:"mt-1"})],8,Je)]))),128)),x.isCourseAdmin?(c(),m("th",Xe,[e("button",{onClick:n[0]||(n[0]=l=>y("create")),class:"flex justify-center items-center mx-auto text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-xl p-3 transition-all duration-300 transform hover:scale-105 shadow-sm hover:shadow-md",title:"เพิ่มการเช็คชื่อใหม่"},[d(r(u),{icon:"fluent:add-circle-24-filled",width:"24",height:"24"})])])):_("",!0)])]),e("tbody",Ze,[(c(!0),m(G,null,Y(x.groupMembers,l=>(c(),m("tr",{key:l.id,class:"hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 dark:hover:from-blue-900/20 dark:hover:to-indigo-900/20 transition-all duration-200"},[e("td",et,[e("div",tt,[e("div",rt,[e("img",{class:"w-14 h-14 rounded-full border-2 border-white dark:border-gray-700 shadow-md transition-all duration-300 group-hover:scale-105 group-hover:shadow-lg object-cover",src:T(l),alt:l.user?.name||l.name||"Avatar",onError:U},null,40,st),n[3]||(n[3]=e("div",{class:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"},null,-1))]),e("div",at,[e("p",lt,p(l.name||l.member_name||l.user?.name||"ไม่มีชื่อ"),1),e("div",ot,[l.order_number?(c(),m("span",nt,[d(r(u),{icon:"fluent:number-symbol-square-20-regular",width:"14",height:"14"}),e("span",null,p(l.order_number),1)])):_("",!0),l.group?(c(),m("span",it,[d(r(u),{icon:"fluent:people-team-20-regular",width:"14",height:"14"}),e("span",null,p(l.group.name),1)])):_("",!0)])])])]),(c(!0),m(G,null,Y(r(j),s=>(c(),m("td",{key:s.id,class:"p-3 whitespace-nowrap border border-slate-300 dark:border-gray-600 text-center"},[e("div",dt,[d(Oe,{status:D(s,l.id),attendanceId:s.id,memberId:l.id,isCourseAdmin:x.isCourseAdmin,onUpdateStatus:n[1]||(n[1]=o=>y("update-status",o))},null,8,["status","attendanceId","memberId","isCourseAdmin"])])]))),128))]))),128)),x.groupMembers.length===0?(c(),m("tr",ut,[e("td",{colspan:x.attendances.length+(x.isCourseAdmin?2:1),class:"p-12 text-center"},[e("div",gt,[d(r(u),{icon:"fluent:people-24-regular",class:"w-16 h-16 text-gray-400 dark:text-gray-600 mb-4"}),n[4]||(n[4]=e("p",{class:"text-gray-500 dark:text-gray-400 font-medium"},"ไม่มีสมาชิกในกลุ่มนี้",-1))])],8,ct)])):_("",!0)])])],512)]))}}),mt={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg border border-gray-200 dark:border-gray-700 overflow-hidden"},ft={class:"bg-gradient-to-r from-violet-500 via-purple-500 to-fuchsia-500 px-6 py-4"},xt={class:"flex items-center justify-between"},pt={class:"flex items-center gap-3"},yt={class:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center"},vt={class:"text-white text-lg font-bold"},ht=["disabled"],kt={class:"overflow-x-auto"},wt={class:"w-full"},_t={class:"bg-gradient-to-r from-violet-50 via-purple-50 to-fuchsia-50 dark:from-violet-900/30 dark:via-purple-900/30 dark:to-fuchsia-900/30"},$t={class:"px-4 py-4 text-center"},Ct={class:"flex items-center justify-center gap-2"},At={class:"w-8 h-8 bg-violet-100 dark:bg-violet-800 rounded-lg flex items-center justify-center"},Dt={class:"px-4 py-4 text-center"},Bt={class:"flex items-center justify-center gap-2"},Tt={class:"w-8 h-8 bg-purple-100 dark:bg-purple-800 rounded-lg flex items-center justify-center"},jt={class:"px-4 py-4 text-center"},St={class:"flex items-center justify-center gap-2"},Mt={class:"w-8 h-8 bg-cyan-100 dark:bg-cyan-800 rounded-lg flex items-center justify-center"},It={class:"px-4 py-4 text-center"},Ut={class:"flex items-center justify-center gap-2"},Et={class:"w-8 h-8 bg-pink-100 dark:bg-pink-800 rounded-lg flex items-center justify-center"},Lt={class:"px-4 py-4 text-center"},Vt={class:"flex items-center justify-center gap-2"},Rt={class:"w-8 h-8 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center"},Ft={class:"px-4 py-4 text-center"},Nt={class:"flex items-center justify-center gap-2"},Ot={class:"w-8 h-8 bg-emerald-100 dark:bg-emerald-800 rounded-lg flex items-center justify-center"},Pt={class:"divide-y divide-gray-100 dark:divide-gray-700"},zt={class:"px-4 py-4 text-center"},Ht={class:"inline-flex items-center justify-center w-8 h-8 bg-violet-100 dark:bg-violet-800 text-violet-700 dark:text-violet-300 rounded-lg font-bold text-sm"},Gt={class:"px-4 py-4 text-center"},qt={class:"flex flex-col items-center"},Wt={class:"font-semibold text-gray-900 dark:text-white"},Yt={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},Jt={class:"px-4 py-4 text-center"},Kt={class:"inline-flex items-center gap-2 px-3 py-1.5 bg-cyan-50 dark:bg-cyan-900/30 rounded-lg"},Qt={class:"font-semibold text-cyan-700 dark:text-cyan-300"},Xt={class:"px-4 py-4 text-center"},Zt={class:"inline-flex items-center gap-2 px-3 py-1.5 bg-pink-50 dark:bg-pink-900/30 rounded-lg"},er={class:"font-semibold text-pink-700 dark:text-pink-300"},tr={class:"px-4 py-4 text-center"},rr={class:"text-gray-600 dark:text-gray-400"},sr={class:"px-4 py-4 text-center"},ar=["onClick","disabled"],lr={key:2,class:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gray-100 dark:bg-gray-700"},or={key:0,class:"py-12 text-center"},nr={class:"w-24 h-24 mx-auto mb-4 bg-gray-100 dark:bg-gray-700 rounded-2xl flex items-center justify-center"},ir={key:1,class:"divide-y divide-gray-100 dark:divide-gray-700"},dr=Q({__name:"StudentAttendanceTable",props:{attendances:{},loading:{type:Boolean,default:!1}},emits:["reload","check-in-success"],setup(x,{emit:C}){const A=C,$=ue(),y=k(null),f=l=>{const s=new Date,o=new Date(l.start_at),g=new Date(l.finish_at);return s>=o&&s<=g},j=l=>{const s=new Date,o=new Date(l.start_at);return s<o},D=l=>l.status===1||l.status===2,T=l=>{const s=new Date,o=new Date(l.start_at),g=l.late_time||15,E=new Date(o.getTime()+g*6e4);return s>E},U=async l=>{if(!y.value){y.value=l.id;try{const s=await $.post(`/api/attendances/${l.id}/check-in`),o=s.status===1?"มา (ตรงเวลา)":"มา (สาย)",g=s.status===1?"#10b981":"#f59e0b";await P.fire({icon:"success",title:"รายงานตัวสำเร็จ!",html:`
        <div class="text-center">
          <p class="text-lg font-semibold" style="color: ${g}">${o}</p>
          <p class="text-gray-500 mt-2">เวลาเข้าเรียน: ${s.time_in}</p>
        </div>
      `,confirmButtonColor:"#8b5cf6",confirmButtonText:"ตกลง",timer:3e3,timerProgressBar:!0}),A("check-in-success",{attendanceId:l.id,status:s.status}),A("reload")}catch(s){const o=s.response?.data?.message||"เกิดข้อผิดพลาด กรุณาลองใหม่";P.fire({icon:"error",title:"ไม่สามารถรายงานตัวได้",text:o,confirmButtonColor:"#8b5cf6",confirmButtonText:"ตกลง"})}finally{y.value=null}}},v=l=>{if(!l)return"-";const s=new Date(l),o=s.getDate(),g=s.getMonth()+1,E=s.getFullYear()+543;return`${String(o).padStart(2,"0")}/${String(g).padStart(2,"0")}/${E}`},S=l=>{if(!l)return"";const s=new Date(l);return["วันอาทิตย์","วันจันทร์","วันอังคาร","วันพุธ","วันพฤหัสบดี","วันศุกร์","วันเสาร์"][s.getDay()]},b=l=>{if(!l)return"-";const s=new Date(l),o=String(s.getHours()).padStart(2,"0"),g=String(s.getMinutes()).padStart(2,"0");return`${o}:${g}`},n=l=>l===1?{label:"มา",icon:"heroicons:check-circle-20-solid",bgClass:"bg-green-100 dark:bg-green-900/40",textClass:"text-green-700 dark:text-green-300",iconClass:"text-green-600 dark:text-green-400",dotClass:"bg-green-500"}:l===2?{label:"สาย",icon:"heroicons:clock-20-solid",bgClass:"bg-amber-100 dark:bg-amber-900/40",textClass:"text-amber-700 dark:text-amber-300",iconClass:"text-amber-600 dark:text-amber-400",dotClass:"bg-amber-500"}:l===3?{label:"ลา",icon:"heroicons:document-text-20-solid",bgClass:"bg-blue-100 dark:bg-blue-900/40",textClass:"text-blue-700 dark:text-blue-300",iconClass:"text-blue-600 dark:text-blue-400",dotClass:"bg-blue-500"}:{label:"ขาด",icon:"heroicons:x-circle-20-solid",bgClass:"bg-red-100 dark:bg-red-900/40",textClass:"text-red-700 dark:text-red-300",iconClass:"text-red-600 dark:text-red-400",dotClass:"bg-red-500"};return(l,s)=>(c(),m("div",mt,[e("div",ft,[e("div",xt,[e("div",pt,[e("div",yt,[d(r(u),{icon:"fluent:calendar-checkmark-24-filled",class:"w-7 h-7 text-white"})]),e("div",null,[s[1]||(s[1]=e("h3",{class:"text-white/80 text-sm font-medium"},"ข้อมูลการเข้าเรียน",-1)),e("p",vt," แสดง "+p(x.attendances.length)+" จาก "+p(x.attendances.length)+" รายการ ",1)])]),e("button",{onClick:s[0]||(s[0]=o=>A("reload")),disabled:x.loading,class:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white rounded-lg transition-all duration-200 font-medium disabled:opacity-50"},[d(r(u),{icon:"fluent:arrow-sync-24-filled",class:w(["w-5 h-5",{"animate-spin":x.loading}])},null,8,["class"]),s[2]||(s[2]=e("span",null,"รีโหลด",-1))],8,ht)])]),e("div",kt,[e("table",wt,[e("thead",_t,[e("tr",null,[e("th",$t,[e("div",Ct,[e("div",At,[d(r(u),{icon:"fluent:number-symbol-24-regular",class:"w-5 h-5 text-violet-600 dark:text-violet-400"})]),s[3]||(s[3]=e("span",{class:"text-sm font-bold text-violet-700 dark:text-violet-300"},"ลำดับ",-1))])]),e("th",Dt,[e("div",Bt,[e("div",Tt,[d(r(u),{icon:"fluent:calendar-24-regular",class:"w-5 h-5 text-purple-600 dark:text-purple-400"})]),s[4]||(s[4]=e("span",{class:"text-sm font-bold text-purple-700 dark:text-purple-300"},"วันที่",-1))])]),e("th",jt,[e("div",St,[e("div",Mt,[d(r(u),{icon:"fluent:play-circle-24-regular",class:"w-5 h-5 text-cyan-600 dark:text-cyan-400"})]),s[5]||(s[5]=e("span",{class:"text-sm font-bold text-cyan-700 dark:text-cyan-300"},"เวลาเริ่ม",-1))])]),e("th",It,[e("div",Ut,[e("div",Et,[d(r(u),{icon:"fluent:stop-24-regular",class:"w-5 h-5 text-pink-600 dark:text-pink-400"})]),s[6]||(s[6]=e("span",{class:"text-sm font-bold text-pink-700 dark:text-pink-300"},"เวลาสิ้นสุด",-1))])]),e("th",Lt,[e("div",Vt,[e("div",Rt,[d(r(u),{icon:"fluent:document-text-24-regular",class:"w-5 h-5 text-slate-600 dark:text-slate-400"})]),s[7]||(s[7]=e("span",{class:"text-sm font-bold text-slate-700 dark:text-slate-300"},"คำอธิบาย",-1))])]),e("th",Ft,[e("div",Nt,[e("div",Ot,[d(r(u),{icon:"fluent:checkmark-circle-24-regular",class:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})]),s[8]||(s[8]=e("span",{class:"text-sm font-bold text-emerald-700 dark:text-emerald-300"},"สถานะการเข้าเรียน",-1))])])])]),e("tbody",Pt,[(c(!0),m(G,null,Y(x.attendances,(o,g)=>(c(),m("tr",{key:o.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"},[e("td",zt,[e("span",Ht,p(g+1),1)]),e("td",Gt,[e("div",qt,[e("span",Wt,p(v(o.date||o.start_at)),1),e("span",Yt,p(S(o.date||o.start_at)),1)])]),e("td",Jt,[e("div",Kt,[d(r(u),{icon:"fluent:play-circle-24-filled",class:"w-4 h-4 text-cyan-600 dark:text-cyan-400"}),e("span",Qt,p(b(o.start_at)),1)])]),e("td",Xt,[e("div",Zt,[d(r(u),{icon:"fluent:stop-24-filled",class:"w-4 h-4 text-pink-600 dark:text-pink-400"}),e("span",er,p(b(o.finish_at)),1)])]),e("td",tr,[e("span",rr,p(o.description||"-"),1)]),e("td",sr,[D(o)?(c(),m("div",{key:0,class:w(["inline-flex items-center gap-2 px-4 py-2 rounded-full",n(o.status).bgClass])},[d(r(u),{icon:n(o.status).icon,class:w(["w-5 h-5",n(o.status).iconClass])},null,8,["icon","class"]),e("span",{class:w(["font-semibold",n(o.status).textClass])},p(n(o.status).label),3),e("span",{class:w(["w-2 h-2 rounded-full animate-pulse",n(o.status).dotClass])},null,2)],2)):f(o)?(c(),m("button",{key:1,onClick:E=>U(o),disabled:y.value!==null,class:w(["inline-flex items-center gap-2 px-4 py-2 rounded-full font-semibold transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none",T(o)?"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-800/50":"bg-green-100 dark:bg-green-900/40 text-green-700 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-800/50"])},[y.value===o.id?(c(),H(r(u),{key:0,icon:"fluent:spinner-ios-20-filled",class:"w-5 h-5 animate-spin"})):(c(),H(r(u),{key:1,icon:T(o)?"heroicons:clock-20-solid":"heroicons:hand-raised-20-solid",class:"w-5 h-5"},null,8,["icon"])),e("span",null,p(y.value===o.id?"กำลังรายงานตัว...":T(o)?"รายงานตัว (สาย)":"รายงานตัว"),1)],10,ar)):j(o)?(c(),m("div",lr,[d(r(u),{icon:"fluent:clock-24-regular",class:"w-5 h-5 text-gray-500 dark:text-gray-400"}),s[9]||(s[9]=e("span",{class:"font-semibold text-gray-500 dark:text-gray-400"},"รอเวลาเริ่ม",-1))])):(c(),m("div",{key:3,class:w(["inline-flex items-center gap-2 px-4 py-2 rounded-full",n(o.status).bgClass])},[d(r(u),{icon:n(o.status).icon,class:w(["w-5 h-5",n(o.status).iconClass])},null,8,["icon","class"]),e("span",{class:w(["font-semibold",n(o.status).textClass])},p(n(o.status).label),3),e("span",{class:w(["w-2 h-2 rounded-full animate-pulse",n(o.status).dotClass])},null,2)],2))])]))),128))])])]),x.attendances.length===0&&!x.loading?(c(),m("div",or,[e("div",nr,[d(r(u),{icon:"fluent:calendar-empty-24-regular",class:"w-12 h-12 text-gray-400 dark:text-gray-500"})]),s[10]||(s[10]=e("h3",{class:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-2"}," ยังไม่มีข้อมูลการเข้าเรียน ",-1)),s[11]||(s[11]=e("p",{class:"text-gray-500 dark:text-gray-400"}," รอผู้สอนสร้างการเช็คชื่อใหม่ ",-1))])):_("",!0),x.loading?(c(),m("div",ir,[(c(),m(G,null,Y(3,o=>e("div",{key:o,class:"px-4 py-4 flex items-center gap-4 animate-pulse"},[...s[12]||(s[12]=[Se('<div class="w-8 h-8 bg-gray-200 dark:bg-gray-700 rounded-lg"></div><div class="flex-1 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-16 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-24 h-4 bg-gray-200 dark:bg-gray-700 rounded"></div><div class="w-20 h-8 bg-gray-200 dark:bg-gray-700 rounded-full"></div>',6)])])),64))])):_("",!0)]))}}),ur={class:"space-y-6"},cr={key:0,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4"},gr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},br={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},mr=["onClick"],fr={class:"flex items-start justify-between gap-2"},xr={class:"flex-1 min-w-0"},pr={class:"flex items-center gap-2 mb-1"},yr={class:"font-semibold text-gray-900 dark:text-white truncate"},vr={class:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1"},hr={key:0,class:"mt-3 flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400"},kr={key:1,class:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-xl shadow-sm p-4 border border-blue-200 dark:border-gray-600"},wr={class:"flex flex-wrap items-center justify-between gap-4"},_r={class:"flex items-center gap-3"},$r={class:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"},Cr={class:"text-xs text-gray-500 dark:text-gray-400"},Ar={key:0,class:"ml-2"},Dr={class:"flex items-center gap-3"},Br=["disabled"],Tr={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},jr={key:0,class:"mt-3 flex items-center gap-2 text-sm text-green-600 dark:text-green-400"},Sr={key:5,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-12 text-center"},Mr={class:"w-32 h-32 mx-auto mb-6 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 rounded-3xl flex items-center justify-center"},Ir={class:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto"},Ur={class:"space-y-4"},Er={key:0,class:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg"},Lr={class:"flex items-center gap-3"},Vr={class:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"},Rr={class:"font-semibold text-gray-900 dark:text-white"},Fr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Nr={class:"grid grid-cols-2 gap-4"},Or={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Pr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},zr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},Hr={class:"flex items-center gap-3"},Gr={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center"},qr={key:0,class:"space-y-4"},Wr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Yr={class:"grid grid-cols-2 gap-4"},Jr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Kr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Qr={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},Xr={class:"flex items-center justify-between"},Zr={class:"flex items-center gap-3"},es={class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center shadow-md"},ts={class:"text-xs text-gray-500 dark:text-gray-400 mt-0.5"},rs={class:"space-y-4"},ss={key:0,class:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-4 border border-blue-200 dark:border-gray-600"},as={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ls={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},os=["disabled"],ns={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},is=["disabled"],ds={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},us=["disabled"],cs={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1.5"},gs=["disabled"],bs={class:"flex items-center justify-between w-full"},ms={key:0,class:"flex items-center gap-3"},fs=Q({__name:"AttendancesList",props:{courseId:{},isCourseAdmin:{type:Boolean,default:!1}},setup(x){const C=x,A=ue(),$=k([]),y=k([]),f=k(null),j=k([]),D=k(null),T=k(!0),U=k(!1),v=k(!1),S=k(!1),b=k(null),n=k(null);k([]),k(!1);const l=k(!0),s=k(15),o=k(null),g=k(null),E=k(!1),J=a=>{const t=a.getFullYear(),h=String(a.getMonth()+1).padStart(2,"0"),i=String(a.getDate()).padStart(2,"0"),L=String(a.getHours()).padStart(2,"0"),V=String(a.getMinutes()).padStart(2,"0");return`${t}-${h}-${i}T${L}:${V}`},X=a=>{if(!a)return"";const t=new Date(a);return isNaN(t.getTime())?"":J(t)},Z=(a,t=45)=>{if(!a)return"";const h=new Date(a);return isNaN(h.getTime())?"":(h.setMinutes(h.getMinutes()+t),J(h))},se=new Date,ce=new Date(se.getTime()+45*6e4),M=k({title:"",date:new Date().toISOString().split("T")[0],start_time:J(se),end_time:J(ce),description:"",late_time:15});W(()=>M.value.start_time,(a,t)=>{a&&a!==t&&(M.value.end_time=Z(a,45))});const N=async(a,t=!1)=>{t||(T.value=!0);try{const h=new URLSearchParams;a&&h.append("group_id",a.toString());const i=h.toString(),L=`/api/courses/${C.courseId}/attendances${i?`?${i}`:""}`,V=await A.get(L);if(V.courseMemberOfAuth&&(D.value=V.courseMemberOfAuth),V.groups&&y.value.length===0&&(y.value=V.groups,C.isCourseAdmin&&y.value.length>0&&!f.value)){const I=D.value?.last_accessed_group_tab;I&&y.value.some(q=>q.id===I)?f.value=I:f.value=y.value[0].id;const z=y.value.find(q=>q.id===f.value);z?.members&&(j.value=z.members.sort((q,Ae)=>(q.order_number||0)-(Ae.order_number||0)));return}if(a){const I=y.value.find(z=>z.id===a);I?.members&&(j.value=I.members.sort((z,q)=>(z.order_number||0)-(q.order_number||0)))}$.value=V.data||V}catch(h){console.error("Error fetching attendances:",h),$.value=[]}finally{T.value=!1}},ge=async a=>{if(!(!C.isCourseAdmin||!D.value))try{await A.patch(`/api/courses/${C.courseId}/members/update-last-access-group`,{last_accessed_group_tab:a})}catch(t){console.error("Error updating last access group tab:",t)}},be=async()=>{if(!f.value){alert("กรุณาเลือกกลุ่มเรียน");return}try{const a={description:M.value.description,start_at:M.value.start_time,finish_at:M.value.end_time,late_time:M.value.late_time||15};await A.post(`/api/courses/${C.courseId}/groups/${f.value}/attendances`,a),U.value=!1,he(),await N(f.value),P.fire({toast:!0,position:"top-end",icon:"success",title:"สร้างสำเร็จ",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"colored-toast"}})}catch(a){console.error("Error creating attendance:",a),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถสร้างการเช็คชื่อได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},me=async()=>{if(b.value)try{const a={description:b.value.description,start_at:b.value.start_at,finish_at:b.value.finish_at,late_time:b.value.late_time||0};await A.patch(`/api/attendances/${b.value.id}`,a),v.value=!1,await N(f.value)}catch(a){console.error("Error updating attendance:",a),alert("เกิดข้อผิดพลาดในการอัพเดทการเช็คชื่อ")}},fe=async a=>{if(confirm("คุณต้องการลบการเช็คชื่อนี้หรือไม่?"))try{await A.delete(`/api/attendances/${a}`),N()}catch(t){console.error("Error deleting attendance:",t)}},xe=a=>{n.value={...a,start_at:X(a.start_at),finish_at:X(a.finish_at)},S.value=!0},pe=a=>{b.value={...a,start_at:X(a.start_at),finish_at:X(a.finish_at)},v.value=!0};W(()=>n.value?.start_at,(a,t)=>{a&&a!==t&&n.value&&(n.value.finish_at=Z(a,45))}),W(()=>b.value?.start_at,(a,t)=>{a&&a!==t&&b.value&&(b.value.finish_at=Z(a,45))});const ye=async()=>{if(n.value)try{const a={description:n.value.description,start_at:n.value.start_at,finish_at:n.value.finish_at,late_time:n.value.late_time||0};await A.patch(`/api/attendances/${n.value.id}`,a),S.value=!1,await N(f.value),P.fire({toast:!0,position:"top-end",icon:"success",title:"บันทึกสำเร็จ",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,customClass:{popup:"colored-toast"}})}catch(a){console.error("Error updating attendance:",a),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพเดทข้อมูลได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},ve=async()=>{if(!(!n.value||!(await P.fire({title:"ลบการเช็คชื่อ?",html:`<p class="text-gray-600">คุณต้องการลบการเช็คชื่อ<br/><strong>${n.value.description||"วันที่ "+new Date(n.value.date).toLocaleDateString("th-TH")}</strong></p><p class="text-red-600 text-sm mt-2">การดำเนินการน้ีไม่สามารถย้อนกลับได้</p>`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",reverseButtons:!0,customClass:{popup:"rounded-xl",confirmButton:"px-5 py-2 rounded-lg font-medium",cancelButton:"px-5 py-2 rounded-lg font-medium"}})).isConfirmed))try{await A.delete(`/api/attendances/${n.value.id}`),S.value=!1,await N(f.value)}catch(t){console.error("Error deleting attendance:",t),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถลบการเช็คชื่อได้",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}},he=()=>{const a=new Date,t=new Date(a.getTime()+45*6e4);M.value={title:"",date:new Date().toISOString().split("T")[0],start_time:J(a),end_time:J(t),description:"",late_time:15}},ke=async({attendanceId:a,memberId:t,status:h})=>{const i=$.value.find(I=>I.id===a);if(!i)return;const L=i.details?.find(I=>I.course_member_id===t),V=L?L.status:null;L?L.status=h:i.details&&i.details.push({course_member_id:t,status:h});try{const I=h===null?0:h;await A.post(`/api/attendances/${a}/member/${t}/update-status`,{status:I}),P.fire({toast:!0,position:"top-end",icon:"success",title:"อัพเดทสถานะสำเร็จ",showConfirmButton:!1,timer:1500,timerProgressBar:!0})}catch(I){if(L&&V!==null)L.status=V;else if(L&&V===null){const z=i.details.indexOf(L);z>-1&&i.details.splice(z,1)}console.error("Error updating member status:",I),P.fire({toast:!0,position:"top-end",icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพเดทสถานะได้",showConfirmButton:!1,timer:2e3})}},we=a=>a?new Date(a).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"",ae=K(()=>!C.isCourseAdmin||!f.value?$.value:$.value.filter(a=>a.group_id===f.value)),le=K(()=>{if(C.isCourseAdmin||!D.value)return[];const a=D.value.group_id;return $.value.filter(t=>!a||t.group_id===a).map(t=>{const h=t.details?.find(i=>i.course_member_id===D.value?.id);return{id:t.id,date:t.date||t.start_at,start_at:t.start_at,finish_at:t.finish_at,late_time:t.late_time||15,description:t.description,status:h?.status??null,time_in:h?.time_in}}).sort((t,h)=>new Date(h.date).getTime()-new Date(t.date).getTime())});W(f,(a,t)=>{a&&C.isCourseAdmin&&(t!=null&&ge(a),N(a))});const ee=()=>{o.value&&clearInterval(o.value),l.value&&C.isCourseAdmin&&(o.value=Me(async()=>{!T.value&&!U.value&&!v.value&&!S.value&&(E.value=!0,await N(f.value,!0),g.value=new Date,E.value=!1)},s.value*1e3))},te=()=>{o.value&&(clearInterval(o.value),o.value=null)},_e=()=>{l.value=!l.value,l.value?ee():te()},$e=async()=>{E.value=!0,await N(f.value,!0),g.value=new Date,E.value=!1},Ce=K(()=>{if(!g.value)return"";const t=Math.floor((new Date().getTime()-g.value.getTime())/1e3);return t<60?`${t} วินาทีที่แล้ว`:t<3600?`${Math.floor(t/60)} นาทีที่แล้ว`:g.value.toLocaleTimeString("th-TH")});return W(l,a=>{a?ee():te()}),re(()=>{N(),C.isCourseAdmin&&ee()}),ne(()=>{te()}),(a,t)=>{const h=De;return c(),m("div",ur,[x.isCourseAdmin&&r(y).length>0?(c(),m("div",cr,[e("label",gr,[d(r(u),{icon:"fluent:people-team-24-regular",class:"w-5 h-5 inline-block mr-2"}),t[22]||(t[22]=B(" เลือกกลุ่มเรียน ",-1))]),e("div",br,[(c(!0),m(G,null,Y(r(y),i=>(c(),m("button",{key:i.id,onClick:L=>f.value=i.id,class:w(["relative p-4 rounded-xl border-2 transition-all duration-300 text-left",r(f)===i.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-md scale-105":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-sm"])},[e("div",fr,[e("div",xr,[e("div",pr,[e("div",{class:w(["w-3 h-3 rounded-full transition-all",r(f)===i.id?"bg-blue-500 animate-pulse":"bg-gray-400"])},null,2),e("h4",yr,p(i.name||`กลุ่ม ${i.id}`),1)]),e("p",vr,[d(r(u),{icon:"fluent:people-20-regular",class:"w-4 h-4"}),e("span",null,p(i.members?.length||i.member_count||0)+" คน",1)])]),r(f)===i.id?(c(),H(r(u),{key:0,icon:"fluent:checkmark-circle-24-filled",class:"w-6 h-6 text-blue-500 flex-shrink-0"})):_("",!0)])],10,mr))),128))]),r(T)?(c(),m("div",hr,[...t[23]||(t[23]=[e("div",{class:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"},null,-1),e("span",null,"กำลังโหลดประวัติการเช็คชื่อ...",-1)])])):_("",!0)])):_("",!0),x.isCourseAdmin&&r(y).length>0?(c(),m("div",kr,[e("div",wr,[e("div",_r,[e("div",$r,[d(r(u),{icon:"fluent:arrow-sync-24-filled",class:w(["w-5 h-5 text-white",{"animate-spin":r(E)}])},null,8,["class"])]),e("div",null,[t[24]||(t[24]=e("h3",{class:"font-semibold text-gray-900 dark:text-white"},"อัพเดทสถานะอัตโนมัติ",-1)),e("p",Cr,[r(l)?(c(),m(G,{key:0},[B(" รีเฟรชทุก "+p(r(s))+" วินาที ",1),r(g)?(c(),m("span",Ar,"• อัพเดทล่าสุด: "+p(r(Ce)),1)):_("",!0)],64)):(c(),m(G,{key:1},[B("ปิดอยู่ - กดปุ่มรีเฟรชเพื่ออัพเดทข้อมูล")],64))])])]),e("div",Dr,[e("button",{onClick:$e,disabled:r(E),class:"inline-flex items-center gap-2 px-4 py-2 bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 rounded-lg border border-blue-300 dark:border-gray-600 hover:bg-blue-50 dark:hover:bg-gray-600 transition-all disabled:opacity-50"},[d(r(u),{icon:"fluent:arrow-clockwise-24-regular",class:w(["w-5 h-5",{"animate-spin":r(E)}])},null,8,["class"]),t[25]||(t[25]=e("span",{class:"hidden sm:inline"},"รีเฟรช",-1))],8,Br),e("button",{onClick:_e,class:w(["relative inline-flex h-8 w-14 items-center rounded-full transition-colors duration-300",r(l)?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"])},[e("span",{class:w(["inline-block h-6 w-6 transform rounded-full bg-white shadow-lg transition-transform duration-300",r(l)?"translate-x-7":"translate-x-1"])},null,2)],2),e("span",Tr,p(r(l)?"เปิด":"ปิด"),1)])]),r(l)?(c(),m("div",jr,[...t[26]||(t[26]=[e("span",{class:"relative flex h-3 w-3"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})],-1),e("span",null,"กำลังติดตามสถานะการมาเรียนแบบ Live",-1)])])):_("",!0)])):_("",!0),r(T)?(c(),H(Ie,{key:2})):x.isCourseAdmin&&r(ae).length>0&&r(j).length>0?(c(),H(bt,{key:3,attendances:r(ae),"group-members":r(j),"is-course-admin":x.isCourseAdmin,onCreate:t[0]||(t[0]=i=>U.value=!0),onViewDetails:xe,onEdit:pe,onDelete:fe,onUpdateStatus:ke},null,8,["attendances","group-members","is-course-admin"])):!x.isCourseAdmin&&r(le).length>0?(c(),H(dr,{key:4,attendances:r(le),loading:r(T),onReload:t[1]||(t[1]=i=>N())},null,8,["attendances","loading"])):(c(),m("div",Sr,[e("div",Mr,[d(r(u),{icon:"fluent:calendar-empty-24-regular",class:"w-20 h-20 text-blue-500 dark:text-blue-400"})]),t[28]||(t[28]=e("h3",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"}," ยังไม่มีการเช็คชื่อ ",-1)),e("p",Ir,p(x.isCourseAdmin?"เริ่มต้นสร้างการเช็คชื่อเพื่อติดตามการเข้าเรียนของนักเรียน":"รอผู้สอนสร้างการเช็คชื่อ คุณจะได้รับการแจ้งเตือนเมื่อมีการเช็คชื่อใหม่"),1),x.isCourseAdmin?(c(),m("button",{key:0,onClick:t[2]||(t[2]=i=>U.value=!0),class:"inline-flex items-center gap-2 px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-300 font-semibold shadow-lg hover:shadow-xl hover:scale-105"},[d(r(u),{icon:"fluent:add-circle-24-filled",class:"w-6 h-6"}),t[27]||(t[27]=e("span",null,"สร้างการเช็คชื่อแรก",-1))])):_("",!0)])),d(h,{show:r(U),onClose:t[8]||(t[8]=i=>U.value=!1)},{title:O(()=>[...t[29]||(t[29]=[B("สร้างการเช็คชื่อ",-1)])]),content:O(()=>[e("div",Ur,[r(f)?(c(),m("div",Er,[e("div",Lr,[e("div",Vr,[d(r(u),{icon:"fluent:people-team-24-filled",class:"w-6 h-6 text-white"})]),e("div",null,[t[30]||(t[30]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"กำลังสร้างการเช็คชื่อสำหรับ",-1)),e("p",Rr,p(r(y).find(i=>i.id===r(f))?.name||`กลุ่ม ${r(f)}`),1)])])])):_("",!0),e("div",null,[e("label",Fr,[d(r(u),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[31]||(t[31]=B(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[3]||(t[3]=i=>r(M).description=i),type:"text",placeholder:"ครั้งที่หรือสัปดาห์ที่",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).description]])]),e("div",Nr,[e("div",null,[e("label",Or,[d(r(u),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[32]||(t[32]=B(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>r(M).start_time=i),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).start_time]])]),e("div",null,[e("label",Pr,[d(r(u),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[33]||(t[33]=B(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>r(M).end_time=i),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).end_time]])])]),e("div",null,[e("label",zr,[d(r(u),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[34]||(t[34]=B(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>r(M).late_time=i),type:"number",min:"0",placeholder:"15",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},null,512),[[F,r(M).late_time,void 0,{number:!0}]])])])]),footer:O(()=>[e("button",{onClick:t[7]||(t[7]=i=>U.value=!1),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg"}," ยกเลิก "),e("button",{onClick:be,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," สร้าง ")]),_:1},8,["show"]),d(h,{show:r(v),onClose:t[14]||(t[14]=i=>v.value=!1)},{title:O(()=>[e("div",Hr,[e("div",Gr,[d(r(u),{icon:"fluent:edit-24-filled",class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),t[35]||(t[35]=e("div",null,[e("h3",{class:"text-lg font-bold"},"แก้ไขการเช็คชื่อ"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"อัพเดทข้อมูลการเช็คชื่อ")],-1))])]),content:O(()=>[r(b)?(c(),m("div",qr,[e("div",null,[e("label",Wr,[d(r(u),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[36]||(t[36]=B(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[9]||(t[9]=i=>r(b).description=i),type:"text",placeholder:"เช่น บทที่ 1, สอบกลางภาค",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(b).description]])]),e("div",Yr,[e("div",null,[e("label",Jr,[d(r(u),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[37]||(t[37]=B(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[10]||(t[10]=i=>r(b).start_at=i),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(b).start_at]])]),e("div",null,[e("label",Kr,[d(r(u),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[38]||(t[38]=B(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[11]||(t[11]=i=>r(b).finish_at=i),type:"datetime-local",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(b).finish_at]])])]),e("div",null,[e("label",Qr,[d(r(u),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[39]||(t[39]=B(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[12]||(t[12]=i=>r(b).late_time=i),type:"number",min:"0",placeholder:"จำนวนนาทีที่ถือว่าสาย",class:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[F,r(b).late_time,void 0,{number:!0}]])])])):_("",!0)]),footer:O(()=>[e("button",{onClick:t[13]||(t[13]=i=>v.value=!1),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"}," ยกเลิก "),e("button",{onClick:me,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},[d(r(u),{icon:"fluent:save-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[40]||(t[40]=B(" บันทึกการเปลี่ยนแปลง ",-1))])]),_:1},8,["show"]),d(h,{show:r(S),onClose:t[21]||(t[21]=i=>S.value=!1),"max-width":"2xl"},{title:O(()=>[e("div",Xr,[e("div",Zr,[e("div",es,[d(r(u),{icon:"fluent:calendar-checkmark-24-filled",class:"w-6 h-6 text-white"})]),e("div",null,[t[41]||(t[41]=e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white"},"รายละเอียดการเช็คชื่อ",-1)),e("p",ts,p(we(r(n)?.date||r(n)?.start_at)),1)])]),e("button",{onClick:t[15]||(t[15]=i=>S.value=!1),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"ปิด"},[d(r(u),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5 text-gray-500 dark:text-gray-400"})])])]),content:O(()=>[e("div",rs,[r(n)?(c(),m("div",ss,[e("div",as,[e("div",null,[e("label",ls,[d(r(u),{icon:"fluent:text-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[42]||(t[42]=B(" หัวข้อ/คำอธิบาย ",-1))]),R(e("input",{"onUpdate:modelValue":t[16]||(t[16]=i=>r(n).description=i),disabled:!x.isCourseAdmin,type:"text",placeholder:"ครั้งที่หรือสัปดาห์ที่",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,os),[[F,r(n).description]])]),e("div",null,[e("label",ns,[d(r(u),{icon:"fluent:clock-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[43]||(t[43]=B(" เวลาสาย (นาที) ",-1))]),R(e("input",{"onUpdate:modelValue":t[17]||(t[17]=i=>r(n).late_time=i),disabled:!x.isCourseAdmin,type:"number",min:"0",placeholder:"จำนวนนาทีที่ถือว่าสาย",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,is),[[F,r(n).late_time,void 0,{number:!0}]])]),e("div",null,[e("label",ds,[d(r(u),{icon:"fluent:calendar-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[44]||(t[44]=B(" เวลาเริ่มต้น ",-1))]),R(e("input",{"onUpdate:modelValue":t[18]||(t[18]=i=>r(n).start_at=i),disabled:!x.isCourseAdmin,type:"datetime-local",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,us),[[F,r(n).start_at]])]),e("div",null,[e("label",cs,[d(r(u),{icon:"fluent:calendar-checkmark-24-regular",class:"inline-block w-4 h-4 mr-1"}),t[45]||(t[45]=B(" เวลาสิ้นสุด ",-1))]),R(e("input",{"onUpdate:modelValue":t[19]||(t[19]=i=>r(n).finish_at=i),disabled:!x.isCourseAdmin,type:"datetime-local",class:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-700 disabled:cursor-not-allowed"},null,8,gs),[[F,r(n).finish_at]])])])])):_("",!0)])]),footer:O(()=>[e("div",bs,[e("button",{onClick:t[20]||(t[20]=i=>S.value=!1),class:"inline-flex items-center gap-2 px-5 py-2.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium"},[d(r(u),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5"}),t[46]||(t[46]=e("span",null,"ปิด",-1))]),x.isCourseAdmin?(c(),m("div",ms,[e("button",{onClick:ve,class:"inline-flex items-center gap-2 px-5 py-2.5 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg hover:shadow-xl"},[d(r(u),{icon:"fluent:delete-24-regular",class:"w-5 h-5"}),t[47]||(t[47]=e("span",null,"ลบการเช็คชื่อ",-1))]),e("button",{onClick:ye,class:"inline-flex items-center gap-2 px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all font-medium shadow-lg hover:shadow-xl"},[d(r(u),{icon:"fluent:save-24-filled",class:"w-5 h-5"}),t[48]||(t[48]=e("span",null,"บันทึกการเปลี่ยนแปลง",-1))])])):_("",!0)])]),_:1},8,["show"])])}}}),xs=de(fs,[["__scopeId","data-v-3cbbea61"]]),_s=Q({__name:"attendances",setup(x){const C=oe("course"),A=oe("isCourseAdmin");return($,y)=>(c(),m("div",null,[r(C)?.id?(c(),H(xs,{key:0,"course-id":r(C).id,"is-course-admin":r(A)},null,8,["course-id","is-course-admin"])):_("",!0)]))}});export{_s as default};
