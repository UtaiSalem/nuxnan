import{_ as pe}from"./CNJKLhSn.js";import{q as J,n as S,c as l,o as d,a as e,t as o,d as y,T as u,u as r,b as x,e as m,I as c,a7 as E,_ as fe,h as he,a9 as _e,r as C,a3 as te,z as ve,F as B,k as U,$ as q,aa as D,aB as ke,g as T,w as Q,p as we,l as $e,ab as se,U as re}from"./CHs-R6Sv.js";import"./CqN4doyA.js";const Ce={class:"flex items-start gap-3"},ze=["src","alt"],je={class:"flex-1 min-w-0"},Be={class:"font-medium text-gray-900 dark:text-white truncate"},Pe={class:"text-sm text-gray-500 dark:text-gray-400 truncate flex flex-wrap items-center gap-1"},Ue={key:0,class:"px-1.5 py-0.5 rounded bg-blue-100 dark:bg-blue-900/40 text-xs font-mono font-bold text-blue-700 dark:text-blue-300"},Me={key:1,class:"px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-xs font-mono font-medium text-gray-600 dark:text-gray-300"},Ve={key:2},qe={class:"mt-1"},Ae={class:"text-xs text-gray-400 mt-1"},Ee={class:"relative w-16 h-16 flex-shrink-0"},Ie={class:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36"},De=["stroke-dasharray"],Te={class:"absolute inset-0 flex flex-col items-center justify-center"},Se={class:"text-[10px] text-gray-400"},Re={class:"mt-4 space-y-3"},Ne={class:"flex items-center justify-between mb-1"},Le={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},We={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Oe={class:"flex items-center justify-between mb-1"},Fe={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},Ge={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},He={class:"flex items-center justify-between mb-1"},Qe={class:"text-sm text-gray-600 dark:text-gray-400 flex items-center gap-1"},Je={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Ke={class:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 grid grid-cols-3 gap-2 text-center"},Xe={class:"text-xs text-gray-400"},Ye={class:"text-lg font-semibold text-blue-600 dark:text-blue-400"},Ze=J({__name:"ProgressCard",props:{member:{},isCourseAdmin:{type:Boolean,default:!1}},emits:["view-details"],setup(n,{emit:v}){const $=n,b=v,P=S(()=>{if($.member.overall_progress!==void 0)return $.member.overall_progress;const g=$.member.lessons_progress||0,p=$.member.assignments_progress||0,_=$.member.quizzes_progress||0;return Math.round((g*40+p*30+_*30)/100)}),j=g=>g>=80?"bg-green-500":g>=60?"bg-blue-500":g>=40?"bg-yellow-500":"bg-red-500",k=g=>g>=80?"text-green-600 dark:text-green-400":g>=60?"text-blue-600 dark:text-blue-400":g>=40?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",M=g=>g?new Date(g).toLocaleDateString("th-TH",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"ยังไม่มีกิจกรรม",A=S(()=>{const g=P.value;return g>=80?{text:"ดีเยี่ยม",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300 border-green-200 dark:border-green-800"}:g>=50?{text:"ปกติ",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 border-blue-200 dark:border-blue-800"}:{text:"ต้องปรับปรุง",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 border-red-200 dark:border-red-800"}}),i=g=>{if(g?.avatar)return g.avatar;const p=g?.id||g?.name?.length||0,_=["f59e0b","64748b","f97316","0ea5e9","10b981","8b5cf6","f43f5e","14b8a6","6366f1","06b6d4"],V=_[p%_.length];return`https://ui-avatars.com/api/?name=${encodeURIComponent(g?.name||"User")}&background=eff6ff&color=${V}&font-size=0.4`};return(g,p)=>(d(),l("div",{class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:p[0]||(p[0]=_=>b("view-details",n.member))},[e("div",Ce,[e("img",{src:i(n.member.user),alt:n.member.user?.name,class:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 dark:border-gray-600"},null,8,ze),e("div",je,[e("h4",Be,o(n.member.member_name||n.member.user?.name),1),e("p",Pe,[n.member.order_number?(d(),l("span",Ue," No. "+o(n.member.order_number),1)):y("",!0),n.member.member_code?(d(),l("span",Me,o(n.member.member_code),1)):y("",!0),!n.member.order_number&&!n.member.member_code?(d(),l("span",Ve,"@"+o(n.member.user?.username),1)):y("",!0)]),e("div",qe,[e("span",{class:u(["inline-flex items-center px-2 py-0.5 rounded textxs font-medium border",r(A).color])},o(r(A).text),3)]),e("p",Ae," เข้าใช้งานล่าสุด: "+o(M(n.member.last_activity)),1)]),e("div",Ee,[(d(),l("svg",Ie,[p[1]||(p[1]=e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3",class:"text-gray-200 dark:text-gray-700"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round",class:u(k(r(P))),"stroke-dasharray":`${r(P)*.97} 100`},null,10,De)])),e("div",Te,[e("span",{class:u(["text-sm font-bold",k(r(P))])},o(n.member.scores?.grade_name||"-"),3),e("span",Se,o(r(P))+"%",1)])])]),e("div",Re,[e("div",null,[e("div",Ne,[e("span",Le,[x(r(c),{icon:"fluent:book-24-regular",class:"w-4 h-4"}),p[2]||(p[2]=m(" บทเรียน ",-1))]),e("span",{class:u(["text-sm font-medium",k(n.member.lessons_progress||0)])},o(n.member.lessons_completed||0)+"/"+o(n.member.total_lessons||0),3)]),e("div",We,[e("div",{class:u(["h-full rounded-full transition-all duration-500",j(n.member.lessons_progress||0)]),style:E({width:`${n.member.lessons_progress||0}%`})},null,6)])]),e("div",null,[e("div",Oe,[e("span",Fe,[x(r(c),{icon:"fluent:document-text-24-regular",class:"w-4 h-4"}),p[3]||(p[3]=m(" งานที่มอบหมาย ",-1))]),e("span",{class:u(["text-sm font-medium",k(n.member.assignments_progress||0)])},o(n.member.assignments_completed||0)+"/"+o(n.member.total_assignments||0),3)]),e("div",Ge,[e("div",{class:u(["h-full rounded-full transition-all duration-500",j(n.member.assignments_progress||0)]),style:E({width:`${n.member.assignments_progress||0}%`})},null,6)])]),e("div",null,[e("div",He,[e("span",Qe,[x(r(c),{icon:"fluent:quiz-new-24-regular",class:"w-4 h-4"}),p[4]||(p[4]=m(" แบบทดสอบ ",-1))]),e("span",{class:u(["text-sm font-medium",k(n.member.quizzes_progress||0)])},o(n.member.quizzes_completed||0)+"/"+o(n.member.total_quizzes||0),3)]),e("div",Je,[e("div",{class:u(["h-full rounded-full transition-all duration-500",j(n.member.quizzes_progress||0)]),style:E({width:`${n.member.quizzes_progress||0}%`})},null,6)])])]),e("div",Ke,[e("div",null,[e("div",{class:u(["text-lg font-semibold",k(n.member.attendance_rate||0)])},o(n.member.attendance_rate||0)+"% ",3),e("p",Xe,"เข้าเรียน ("+o(n.member.attendance_present||0)+"/"+o(n.member.total_attendance||0)+")",1)]),e("div",null,[e("div",Ye,o(n.member.scores?.total_score||0),1),p[5]||(p[5]=e("p",{class:"text-xs text-gray-400"},"คะแนนรวม",-1))]),e("div",null,[e("div",{class:u(["text-lg font-semibold",k(r(P))])},o(n.member.scores?.grade_name||"-"),3),p[6]||(p[6]=e("p",{class:"text-xs text-gray-400"},"เกรด",-1))])])]))}}),et={},tt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-4 animate-pulse"};function st(n,v){return d(),l("div",tt,[...v[0]||(v[0]=[he('<div class="flex items-start gap-3"><div class="w-12 h-12 rounded-full bg-gray-300 dark:bg-gray-600"></div><div class="flex-1 min-w-0 space-y-2"><div class="h-4 w-3/4 rounded bg-gray-300 dark:bg-gray-600"></div><div class="h-3 w-1/2 rounded bg-gray-300 dark:bg-gray-600"></div><div class="h-2 w-2/3 rounded bg-gray-200 dark:bg-gray-700 mt-1"></div></div><div class="w-16 h-16 rounded-full bg-gray-200 dark:bg-gray-700 flex-shrink-0"></div></div><div class="mt-4 space-y-3"><div><div class="flex justify-between mb-1"><div class="h-3 w-16 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div><div><div class="flex justify-between mb-1"><div class="h-3 w-20 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div><div><div class="flex justify-between mb-1"><div class="h-3 w-16 rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-3 w-8 rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="h-2 w-full rounded-full bg-gray-200 dark:bg-gray-700"></div></div></div><div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-700 grid grid-cols-3 gap-2"><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-12 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-14 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div><div class="text-center space-y-1"><div class="h-5 w-10 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div><div class="h-2 w-12 mx-auto rounded bg-gray-200 dark:bg-gray-700"></div></div></div>',3)])])}const rt=fe(et,[["render",st]]),ot={class:"space-y-6"},at={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4"},dt={class:"text-sm text-gray-500 dark:text-gray-400"},lt={key:0,class:"space-y-4"},nt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},it={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},gt={class:"flex items-center gap-3"},ct={class:"p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},ut={class:"text-xl font-bold text-gray-900 dark:text-white"},xt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},bt={class:"flex items-center gap-3"},mt={class:"p-2 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg"},yt={class:"text-xl font-bold text-gray-900 dark:text-white"},pt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},ft={class:"flex items-center gap-3"},ht={class:"p-2 bg-green-50 dark:bg-green-900/20 rounded-lg"},_t={class:"text-xl font-bold text-gray-900 dark:text-white"},vt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},kt={class:"flex items-center gap-3"},wt={class:"p-2 bg-teal-50 dark:bg-teal-900/20 rounded-lg"},$t={class:"text-xl font-bold text-gray-900 dark:text-white"},Ct={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},zt={class:"lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700"},jt={class:"font-semibold text-gray-800 dark:text-gray-200 mb-6 flex items-center gap-2"},Bt={class:"flex items-end justify-between h-40 gap-2 px-2"},Pt={class:"absolute -top-8 bg-gray-900 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity"},Ut={key:0,class:"absolute bottom-0 left-0 right-0 bg-blue-500/20 h-full w-full"},Mt={class:"text-sm font-medium text-gray-600 dark:text-gray-400"},Vt={class:"bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700 flex flex-col"},qt={class:"font-semibold text-gray-800 dark:text-gray-200 mb-4 flex items-center gap-2"},At={class:"flex-1 overflow-y-auto space-y-3 pr-2 custom-scrollbar"},Et=["onClick"],It={class:"relative"},Dt=["src"],Tt={class:"flex-1 min-w-0"},St={class:"text-sm font-medium text-gray-900 dark:text-white truncate"},Rt={class:"text-xs text-gray-500 truncate"},Nt={class:"text-sm font-bold text-green-600"},Lt={key:0,class:"bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-800/30 rounded-xl p-4 flex items-start gap-4"},Wt={class:"p-2 bg-red-100 dark:bg-red-900/30 rounded-full shrink-0"},Ot={class:"flex-1"},Ft={class:"font-bold text-red-700 dark:text-red-400 text-sm"},Gt={class:"flex flex-wrap gap-2"},Ht=["onClick"],Qt=["src"],Jt={class:"text-xs font-medium text-gray-700 dark:text-gray-300"},Kt={class:"text-xs text-red-500 font-bold"},Xt={key:0,class:"px-2 py-1 text-xs text-red-600 font-medium"},Yt={key:1,class:"mb-4"},Zt={class:"flex flex-wrap items-center border-b bg-gray-50 dark:bg-gray-800 rounded-t-lg"},es={class:"mr-1"},ts=["onClick"],ss={key:0,class:"mr-1"},rs={class:"flex flex-col sm:flex-row gap-3"},os={class:"relative flex-1"},as={class:"flex gap-2"},ds={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 mr-2"},ls={key:2,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},ns={key:3,class:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3"},is={key:4,class:"overflow-x-auto bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700"},gs={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},cs={class:"px-4 py-3"},us={class:"px-4 py-3 font-medium text-center text-gray-900 dark:text-white"},xs={class:"px-4 py-3 font-mono text-gray-600 dark:text-gray-400"},bs={class:"px-4 py-3 font-medium text-gray-900 dark:text-white whitespace-nowrap"},ms={class:"flex items-center gap-3"},ys=["src"],ps={class:"flex flex-col"},fs={class:"text-xs text-gray-400"},hs={class:"px-4 py-3 text-center"},_s={class:"flex flex-col items-center"},vs={class:"text-xs text-gray-400"},ks={class:"text-xs text-gray-400"},ws={class:"px-4 py-3 text-center"},$s={class:"px-4 py-3 text-center"},Cs={class:"px-6 py-4"},zs={key:0,class:"flex items-center gap-1"},js=["onUpdate:modelValue"],Bs=["onClick"],Ps={key:1,class:"text-orange-600 font-medium"},Us={class:"px-4 py-3 text-center font-bold text-blue-700 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400"},Ms={class:"text-xs text-gray-400 font-normal"},Vs={class:"px-4 py-3 text-center"},qs={key:0,class:"flex items-center justify-center gap-1"},As=["onUpdate:modelValue"],Es=["onClick"],Is={key:1,class:"font-medium"},Ds={class:"px-4 py-3 text-center"},Ts={key:0,class:"bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-green-900 dark:text-green-300"},Ss={key:1,class:"bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded dark:bg-red-900 dark:text-red-300"},Rs={class:"px-4 py-3 text-center"},Ns=["onClick"],Ls={key:5,class:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-6"},Ws={class:"text-sm text-gray-500 dark:text-gray-400"},Os={class:"flex gap-2"},Fs=["disabled"],Gs={class:"flex items-center gap-1"},Hs=["onClick"],Qs={key:1,class:"px-2"},Js=["disabled"],Ks={key:6,class:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl"},Xs={class:"mt-4 text-lg font-medium text-gray-900 dark:text-white"},Ys={class:"mt-2 text-gray-500 dark:text-gray-400"},Zs={key:0,class:"space-y-6 max-h-[70vh] overflow-y-auto pr-2"},er={key:0,class:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},tr={class:"flex items-center justify-between mb-4"},sr={class:"font-semibold text-gray-900 dark:text-white flex items-center gap-2"},rr=["href"],or={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ar={class:"flex flex-col sm:flex-row gap-2"},dr={class:"flex flex-col sm:flex-row gap-2"},lr={class:"flex flex-col sm:flex-row gap-2"},nr={class:"flex flex-col sm:flex-row gap-2"},ir={class:"md:col-span-2"},gr={class:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 rounded-xl"},cr={class:"text-center"},ur={class:"relative w-16 h-16 mx-auto"},xr={class:"w-full h-full transform -rotate-90",viewBox:"0 0 36 36"},br=["stroke-dasharray"],mr={class:"absolute inset-0 flex items-center justify-center"},yr={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},pr={class:"text-center"},fr={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},hr={class:"text-2xl font-bold text-green-600 dark:text-green-400"},_r={class:"text-xs text-gray-500 mt-2"},vr={class:"text-center"},kr={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},wr={class:"text-xl font-bold text-orange-600 dark:text-orange-400"},$r={class:"text-xs text-gray-500 mt-2"},Cr={class:"text-center"},zr={class:"w-16 h-16 mx-auto rounded-full bg-white dark:bg-gray-700 shadow flex items-center justify-center"},jr={class:"text-xl font-bold text-purple-600 dark:text-purple-400"},Br={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Pr={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Ur={class:"flex items-center justify-between mb-2"},Mr={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},Vr={class:"text-sm font-bold text-blue-600 dark:text-blue-400"},qr={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Ar={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Er={class:"flex items-center justify-between mb-2"},Ir={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},Dr={class:"text-sm font-bold text-orange-600 dark:text-orange-400"},Tr={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Sr={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Rr={class:"flex items-center justify-between mb-2"},Nr={class:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-2"},Lr={class:"text-sm font-bold text-purple-600 dark:text-purple-400"},Wr={class:"h-2 rounded-full bg-gray-100 dark:bg-gray-700 overflow-hidden"},Or={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},Fr={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},Gr={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},Hr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},Qr={class:"text-lg font-bold text-gray-900 dark:text-white"},Jr={class:"text-sm font-normal text-gray-500"},Kr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},Xr={class:"text-lg font-bold text-gray-900 dark:text-white"},Yr={class:"text-sm font-normal text-gray-500"},Zr={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},eo={class:"text-lg font-bold text-gray-900 dark:text-white"},to={class:"text-sm font-normal text-gray-500"},so={class:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},ro={class:"text-lg font-bold text-gray-900 dark:text-white"},oo={class:"text-sm font-normal text-gray-500"},ao={class:"mt-3 flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},lo={class:"text-lg font-bold text-blue-600 dark:text-blue-400"},no={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},io={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},go={key:0,class:"space-y-2"},co={class:"text-sm text-gray-700 dark:text-gray-300"},uo={key:1,class:"text-sm text-gray-500 text-center py-4"},xo={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},bo={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},mo={key:0,class:"space-y-2"},yo=["title"],po={class:"flex items-center gap-2"},fo={key:0,class:"text-sm font-bold text-green-600 dark:text-green-400"},ho={key:1,class:"text-sm text-gray-500 text-center py-4"},_o={class:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700"},vo={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2 mb-3"},ko={key:0,class:"space-y-2"},wo={class:"flex-1"},$o={class:"text-sm text-gray-700 dark:text-gray-300"},Co={key:0,class:"text-xs text-gray-400 ml-2"},zo={class:"flex items-center gap-2"},jo={key:1,class:"text-sm text-gray-500 text-center py-4"},Bo={key:1,class:"flex flex-col items-center justify-center py-12"},Po=J({__name:"ProgressList",props:{courseId:{},isCourseAdmin:{type:Boolean,default:!1}},setup(n){const v=n,$=_e(),b=C([]),P=C(!0),j=C(""),k=C("order_number"),M=C("asc"),A=C(!1),i=C(null),g=C(null),p=C([]),_=C("all"),V=C("grid"),w=C({current_page:1,last_page:1,total:0,per_page:20,from:0,to:0}),R=C({avg:0,min:0,max:0,completed:0,total:0}),I=async(a=1)=>{P.value=!0;try{const t={page:a,per_page:w.value.per_page,sort:k.value,order:M.value};_.value!=="all"&&(t.group_id=_.value),j.value&&(t.search=j.value);const f=await $.get(`/api/courses/${v.courseId}/progress`,{params:t});f.courseMembersProgress?b.value=f.courseMembersProgress.map(s=>({lessons_completed:s.lessons_completed,total_lessons:s.total_lessons,lessons_progress:s.lessons_progress,assignments_completed:s.assignments_completed,total_assignments:s.total_assignments,assignments_progress:s.assignments_progress,quizzes_completed:s.quizzes_completed,total_quizzes:s.total_quizzes,quizzes_progress:s.quizzes_progress,attendance_present:s.attendance_present,total_attendance:s.total_attendance,attendance_rate:s.attendance_rate,overall_progress:s.overall_progress,...s.progress,...s.member,scores:{...s.scores,original_bonus:s.scores?.bonus_points||0,original_edited_grade:s.scores?.edited_grade}})):b.value=[],p.value=f.groups||[],f.pagination&&(w.value=f.pagination),f.stats&&(R.value={...R.value,...f.stats})}catch(t){console.error("Error fetching progress:",t)}finally{P.value=!1}};te(_,()=>{I(1)});let K;te(j,a=>{clearTimeout(K),K=setTimeout(()=>{I(1)},500)});const F=a=>{a>=1&&a<=w.value.last_page&&I(a)},W=async a=>{i.value=a,A.value=!0;try{const t=await $.get(`/api/courses/${v.courseId}/members/${a.id}/progress`);g.value=t}catch(t){console.error("Error fetching member details:",t),g.value=null}},oe=async()=>{try{const a=we(),t=$e();let s=`${a.public.apiBase}/api/courses/${v.courseId}/export/results`;_.value!=="all"&&(s+=`?group_id=${_.value}`);const h=await fetch(s,{method:"GET",headers:{Authorization:`Bearer ${t.token}`}});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);let z=`course-progress-${v.courseId}`;if(_.value==="all")z+="-ทั้งหมด";else if(_.value==="ungrouped")z+="-ไม่มีกลุ่ม";else{const ee=p.value.find(ye=>ye.id===_.value);ee&&(z+=`-${ee.name}`)}z+=".xlsx";const me=await h.blob(),Z=window.URL.createObjectURL(me),L=document.createElement("a");L.href=Z,L.setAttribute("download",z),document.body.appendChild(L),L.click(),L.remove(),window.URL.revokeObjectURL(Z)}catch(a){console.error("Error exporting progress:",a)}},ae=async a=>{const t=a.scores?.bonus_points??0,f=a.scores?.original_bonus??0;if(t!==f)try{const s=await $.patch(`/api/courses/${v.courseId}/members/${a.id}/bonus-points`,{bonus_points:t}),h=(a.scores.bonus_points||0)-(a.scores.original_bonus||0);a.scores.total_score=(a.scores.total_score||0)+h,a.scores.original_bonus=a.scores.bonus_points,a.scores.grade_progress=s.grade_progress,a.scores.grade_name=s.grade_name}catch(s){console.error("Error updating bonus points:",s)}},de=async a=>{try{const t=await $.patch(`/api/courses/${v.courseId}/members/${a.id}/edited-grade`,{edited_grade:a.scores.edited_grade});a.scores.original_edited_grade=a.scores.edited_grade,a.scores.grade_progress=t.edited_grade??a.scores.calculated_grade??t.grade_progress,a.scores.edited_grade=t.edited_grade,a.scores.grade_name=t.grade_name}catch(t){console.error("Error updating edited grade:",t)}},le=async a=>{try{await $.patch(`/api/courses/${v.courseId}/members/${a.id}/member-code`,{member_code:a.member_code})}catch(t){console.error("Error updating member code:",t)}},ne=async a=>{try{await $.patch(`/api/courses/${v.courseId}/members/${a.id}/order-number`,{order_number:a.order_number})}catch(t){console.error("Error updating order number:",t)}},ie=async a=>{try{await $.patch(`/api/courses/${v.courseId}/members/${a.id}/update`,{course_member_status:a.course_member_status})}catch(t){console.error("Error updating member status:",t)}},X=async a=>{try{await $.patch(`/api/courses/${v.courseId}/members/${a.id}/update`,{member_name:a.member_name,member_email:a.member_email})}catch(t){console.error("Error updating member profile:",t)}},O=a=>{k.value===a?M.value=M.value==="asc"?"desc":"asc":(k.value=a,M.value="desc"),I(1)},ge=S(()=>{const a={A:0,"B+":0,B:0,"C+":0,C:0,"D+":0,D:0,F:0};return b.value.forEach(t=>{const f=t.scores?.grade_name||"F";a.hasOwnProperty(f)&&a[f]++}),a}),G=C([]),Y=C(!1),ce=async()=>{Y.value=!0;try{const a=await $.get(`/api/courses/${v.courseId}/top-performers`,{params:{limit:5}});(a.data||a.topPerformers)&&(G.value=a.topPerformers||a.data||[])}catch(a){console.error("Error fetching top performers:",a),G.value=[...b.value].sort((t,f)=>(f.scores?.total_score||0)-(t.scores?.total_score||0)).slice(0,5)}finally{Y.value=!1}},N=S(()=>b.value.filter(a=>(a.overall_progress||0)<50)),ue=S(()=>{if(b.value.length===0)return 0;const a=b.value.reduce((t,f)=>t+(f.overall_progress||0),0);return Math.round(a/b.value.length)}),xe=S(()=>{if(b.value.length===0)return 0;const a=b.value.filter(t=>(t.overall_progress||0)>=50).length;return Math.round(a/b.value.length*100)}),H=(a,t=0)=>{if(a?.avatar)return a.avatar;const f=a?.id||t||a?.name?.length||0,s=["f59e0b","64748b","f97316","0ea5e9","10b981","8b5cf6","f43f5e","14b8a6","6366f1","06b6d4"],h=s[f%s.length];return`https://ui-avatars.com/api/?name=${encodeURIComponent(a?.name||"User")}&background=eff6ff&color=${h}&font-size=0.4`},be=a=>["bg-amber-500","bg-slate-400","bg-orange-400","bg-sky-400","bg-emerald-400","bg-violet-400","bg-rose-400","bg-teal-400","bg-indigo-400","bg-cyan-400"][a]||"bg-slate-400";return ve(()=>{I(),ce()}),(a,t)=>{const f=pe;return d(),l("div",ot,[e("div",at,[e("div",null,[t[23]||(t[23]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"}," ความคืบหน้าของผู้เรียน ",-1)),e("p",dt," ทั้งหมด "+o(r(w).total)+" คน ",1)])]),r(b).length>0?(d(),l("div",lt,[e("div",nt,[e("div",it,[e("div",gt,[e("div",ct,[x(r(c),{icon:"fluent:people-community-24-filled",class:"w-6 h-6 text-blue-600 dark:text-blue-400"})]),e("div",null,[t[24]||(t[24]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ผู้เรียนทั้งหมด",-1)),e("div",ut,o(r(R).total),1)])])]),e("div",xt,[e("div",bt,[e("div",mt,[x(r(c),{icon:"fluent:data-trending-24-filled",class:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})]),e("div",null,[t[25]||(t[25]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ความคืบหน้าเฉลี่ย",-1)),e("div",yt,o(r(ue))+"%",1)])])]),e("div",pt,[e("div",ft,[e("div",ht,[x(r(c),{icon:"fluent:checkmark-starburst-24-filled",class:"w-6 h-6 text-green-600 dark:text-green-400"})]),e("div",null,[t[26]||(t[26]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"ผ่านเกณฑ์ (>50%)",-1)),e("div",_t,o(r(xe))+"%",1)])])]),e("div",vt,[e("div",kt,[e("div",wt,[x(r(c),{icon:"fluent:trophy-24-filled",class:"w-6 h-6 text-teal-600 dark:text-teal-400"})]),e("div",null,[t[27]||(t[27]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"เรียนจบแล้ว",-1)),e("div",$t,o(r(R).completed),1)])])])]),e("div",Ct,[e("div",zt,[e("h4",jt,[x(r(c),{icon:"fluent:chart-person-24-regular",class:"w-5 h-5"}),t[28]||(t[28]=m(" การกระจายเกรด (Grade Distribution) ",-1))]),e("div",Bt,[(d(!0),l(B,null,U(r(ge),(s,h)=>(d(),l("div",{key:h,class:"flex-1 flex flex-col items-center justify-end h-full gap-2 group relative"},[e("div",Pt,o(s)+" คน ",1),e("div",{class:"w-full max-w-[40px] bg-blue-100 dark:bg-blue-900/30 rounded-t-md relative overflow-hidden transition-all duration-500 hover:bg-blue-200 dark:hover:bg-blue-800/50",style:E({height:`${Math.max(s/r(b).length*100,4)}%`})},[s>0?(d(),l("div",Ut)):y("",!0)],4),e("div",Mt,o(h),1)]))),128))])]),e("div",Vt,[e("h4",qt,[x(r(c),{icon:"fluent:ribbon-star-24-filled",class:"w-5 h-5 text-yellow-500"}),t[29]||(t[29]=m(" Top Performers ",-1))]),e("div",At,[(d(!0),l(B,null,U(r(G),(s,h)=>(d(),l("div",{key:s.id,class:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:z=>W(s)},[e("div",It,[e("img",{src:H(s.user,h),class:"w-10 h-10 rounded-full object-cover border border-gray-200"},null,8,Dt),h<3?(d(),l("div",{key:0,class:u(["absolute -top-1 -left-1 w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold text-white shadow-sm border border-white",be(h)])},o(h+1),3)):y("",!0)]),e("div",Tt,[e("p",St,o(s.user?.name),1),e("p",Rt,o(s.scores?.grade_name||"-")+" • "+o(s.overall_progress||0)+"%",1)]),e("div",Nt,o(s.scores?.total_score||0),1)],8,Et))),128))])])]),r(N).length>0?(d(),l("div",Lt,[e("div",Wt,[x(r(c),{icon:"fluent:alert-24-filled",class:"w-6 h-6 text-red-600 dark:text-red-400"})]),e("div",Ot,[e("h4",Ft,"ต้องการความช่วยเหลือ ("+o(r(N).length)+" คน)",1),t[30]||(t[30]=e("p",{class:"text-xs text-red-600/80 dark:text-red-400/80 mt-1 mb-2"},"นักเรียนกลุ่มนี้มีความคืบหน้าน้อยกว่า 50% หรือคะแนนต่ำกว่าเกณฑ์",-1)),e("div",Gt,[(d(!0),l(B,null,U(r(N).slice(0,5),s=>(d(),l("div",{key:s.id,class:"flex items-center gap-1.5 bg-white dark:bg-gray-800 px-2 py-1 rounded-md border border-red-100 dark:border-red-900/30 shadow-sm cursor-pointer hover:shadow-md transition-shadow",onClick:h=>W(s)},[e("img",{src:H(s.user,s.id),class:"w-5 h-5 rounded-full"},null,8,Qt),e("span",Jt,o(s.user?.name),1),e("span",Kt,"("+o(s.overall_progress)+"%)",1)],8,Ht))),128)),r(N).length>5?(d(),l("div",Xt," + อีก "+o(r(N).length-5)+" คน ",1)):y("",!0)])])])):y("",!0)])):y("",!0),n.isCourseAdmin&&(r(p).length>0||r(b).some(s=>!s.group_id))?(d(),l("div",Yt,[e("ul",Zt,[e("li",es,[e("button",{onClick:t[0]||(t[0]=s=>_.value="all"),class:u(["px-4 py-2 text-sm font-medium rounded-t-lg",r(_)==="all"?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])}," ทั้งหมด ("+o(r(b).length)+") ",3)]),(d(!0),l(B,null,U(r(p),s=>(d(),l("li",{key:s.id,class:"mr-1"},[e("button",{onClick:h=>_.value=s.id,class:u(["px-4 py-2 text-sm font-medium rounded-t-lg",r(_)===s.id?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])},o(s.name),11,ts)]))),128)),r(b).some(s=>!s.group_id)?(d(),l("li",ss,[e("button",{onClick:t[1]||(t[1]=s=>_.value="ungrouped"),class:u(["px-4 py-2 text-sm font-medium rounded-t-lg",r(_)==="ungrouped"?"bg-white dark:bg-gray-900 text-blue-600 border-t border-l border-r border-gray-200 dark:border-gray-700":"text-gray-500 hover:text-gray-700 dark:text-gray-400"])}," ไม่มีกลุ่ม ",2)])):y("",!0)])])):y("",!0),e("div",rs,[e("div",os,[x(r(c),{icon:"fluent:search-24-regular",class:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),q(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>ke(j)?j.value=s:null),type:"text",placeholder:"ค้นหา ชื่อ, เลขที่, Email...",class:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,512),[[D,r(j)]])]),e("div",as,[e("div",ds,[e("button",{onClick:t[3]||(t[3]=s=>V.value="grid"),class:u(["p-1.5 rounded-md transition-colors",r(V)==="grid"?"bg-white dark:bg-gray-600 shadow text-blue-600":"text-gray-500 hover:text-gray-700"])},[x(r(c),{icon:"fluent:grid-24-regular",class:"w-5 h-5"})],2),e("button",{onClick:t[4]||(t[4]=s=>V.value="table"),class:u(["p-1.5 rounded-md transition-colors",r(V)==="table"?"bg-white dark:bg-gray-600 shadow text-blue-600":"text-gray-500 hover:text-gray-700"])},[x(r(c),{icon:"fluent:table-24-regular",class:"w-5 h-5"})],2)]),e("button",{onClick:t[5]||(t[5]=s=>O("order_number")),class:u(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",r(k)==="order_number"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[t[31]||(t[31]=m(" เลขที่ ",-1)),r(k)==="order_number"?(d(),T(r(c),{key:0,icon:r(M)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):y("",!0)],2),e("button",{onClick:t[6]||(t[6]=s=>O("name")),class:u(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",r(k)==="name"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[t[32]||(t[32]=m(" ชื่อ ",-1)),r(k)==="name"?(d(),T(r(c),{key:0,icon:r(M)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):y("",!0)],2),e("button",{onClick:t[7]||(t[7]=s=>O("progress")),class:u(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",r(k)==="progress"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[t[33]||(t[33]=m(" ความคืบหน้า ",-1)),r(k)==="progress"?(d(),T(r(c),{key:0,icon:r(M)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):y("",!0)],2),e("button",{onClick:t[8]||(t[8]=s=>O("last_activity")),class:u(["px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-1 transition-colors",r(k)==="last_activity"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"])},[t[34]||(t[34]=m(" ล่าสุด ",-1)),r(k)==="last_activity"?(d(),T(r(c),{key:0,icon:r(M)==="asc"?"fluent:arrow-up-24-regular":"fluent:arrow-down-24-regular",class:"w-4 h-4"},null,8,["icon"])):y("",!0)],2),n.isCourseAdmin?(d(),l("button",{key:0,onClick:oe,class:"inline-flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium"},[x(r(c),{icon:"fluent:arrow-download-24-regular",class:"w-4 h-4"}),t[35]||(t[35]=e("span",null,"ส่งออก Excel",-1))])):y("",!0)])]),r(P)?(d(),l("div",ls,[(d(),l(B,null,U(6,s=>x(rt,{key:s})),64))])):r(b).length>0&&r(V)==="grid"?(d(),l("div",ns,[(d(!0),l(B,null,U(r(b),s=>(d(),T(Ze,{key:s.id,member:s,"is-course-admin":n.isCourseAdmin,onViewDetails:W},null,8,["member","is-course-admin"]))),128))])):r(b).length>0&&r(V)==="table"?(d(),l("div",is,[e("table",gs,[t[39]||(t[39]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-300"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 min-w-[50px]"},"#"),e("th",{scope:"col",class:"px-4 py-3 min-w-[60px]"},"เลขที่"),e("th",{scope:"col",class:"px-4 py-3 min-w-[80px]"},"รหัส"),e("th",{scope:"col",class:"px-4 py-3 min-w-[200px]"},"สมาชิก"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"บทเรียน"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"งาน"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"ทดสอบ"),e("th",{scope:"col",class:"px-6 py-3 min-w-[120px]"}," พิเศษ "),e("th",{scope:"col",class:"px-6 py-3 whitespace-nowrap"}," รวม "),e("th",{scope:"col",class:"px-4 py-3 text-center"},"เกรด"),e("th",{scope:"col",class:"px-4 py-3 text-center min-w-[120px]"},"เกรดแก้"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"สถานะ"),e("th",{scope:"col",class:"px-4 py-3 text-center"},"จัดการ")])],-1)),e("tbody",null,[(d(!0),l(B,null,U(r(b),(s,h)=>(d(),l("tr",{key:s.id,class:"border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",cs,o(h+1),1),e("td",us,o(s.order_number||"-"),1),e("td",xs,o(s.member_code||"-"),1),e("td",bs,[e("div",ms,[e("img",{src:H(s.user,h),class:"w-8 h-8 rounded-full",alt:""},null,8,ys),e("div",ps,[e("span",null,o(s.member_name||s.user?.name),1),e("span",fs,o(s.member_email||s.user?.email||"-"),1)])])]),e("td",hs,[e("div",_s,[e("span",vs,"งาน: "+o(s.scores?.lesson_assignments||0),1),e("span",ks,"สอบ: "+o(s.scores?.lesson_quizzes||0),1)])]),e("td",ws,o(s.scores?.course_assignments||0),1),e("td",$s,o(s.scores?.course_quizzes||0),1),e("td",Cs,[n.isCourseAdmin?(d(),l("div",zs,[q(e("input",{type:"number","onUpdate:modelValue":z=>s.scores.bonus_points=z,class:"w-16 px-2 py-1 text-sm border rounded focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},null,8,js),[[D,s.scores.bonus_points,void 0,{number:!0}]]),s.scores.bonus_points!==s.scores.original_bonus?(d(),l("button",{key:0,onClick:z=>ae(s),class:"p-1 text-green-600 hover:bg-green-100 rounded dark:hover:bg-green-900/30",title:"บันทึก"},[...t[36]||(t[36]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)])],8,Bs)):y("",!0)])):(d(),l("span",Ps,o(s.scores?.bonus_points||0),1))]),e("td",Us,o(s.scores?.total_score||0),1),e("td",{class:u(["px-4 py-3 text-center font-bold text-lg",{"text-green-600 dark:text-green-400":(s.scores?.grade_progress||0)>=2,"text-red-600 dark:text-red-400":(s.scores?.grade_progress||0)<1}])},[m(o(s.scores?.grade_name||"-")+" ",1),e("span",Ms,"("+o(s.scores?.grade_progress||0)+")",1)],2),e("td",Vs,[n.isCourseAdmin?(d(),l("div",qs,[q(e("select",{"onUpdate:modelValue":z=>s.scores.edited_grade=z,class:"w-20 px-2 py-1 text-sm border rounded focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},[...t[37]||(t[37]=[e("option",{value:null},"-",-1),e("option",{value:1},"1 (D)",-1),e("option",{value:1.5},"1.5 (D+)",-1),e("option",{value:2},"2 (C)",-1),e("option",{value:2.5},"2.5 (C+)",-1),e("option",{value:3},"3 (B)",-1),e("option",{value:3.5},"3.5 (B+)",-1),e("option",{value:4},"4 (A)",-1)])],8,As),[[se,s.scores.edited_grade,void 0,{number:!0}]]),s.scores.edited_grade!==s.scores.original_edited_grade?(d(),l("button",{key:0,onClick:z=>de(s),class:"p-1 text-blue-600 hover:bg-blue-100 rounded dark:hover:bg-blue-900/30",title:"บันทึกเกรดแก้"},[...t[38]||(t[38]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e("polyline",{points:"17 21 17 13 7 13 7 21"}),e("polyline",{points:"7 3 7 8 15 8"})],-1)])],8,Es)):y("",!0)])):(d(),l("span",Is,o(s.scores?.edited_grade||"-"),1))]),e("td",Ds,[s.course_member_status===1?(d(),l("span",Ts,"ปกติ")):(d(),l("span",Ss,"พัก"))]),e("td",Rs,[e("button",{onClick:z=>W(s),class:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium text-xs"}," รายละเอียด ",8,Ns)])]))),128))])])])):y("",!0),r(b).length>0?(d(),l("div",Ls,[e("span",Ws," แสดง "+o(r(w).from)+"-"+o(r(w).to)+" จากทั้งหมด "+o(r(w).total)+" รายการ ",1),e("div",Os,[e("button",{onClick:t[9]||(t[9]=s=>F(r(w).current_page-1)),disabled:r(w).current_page===1,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-600 dark:hover:bg-gray-700"}," ก่อนหน้า ",8,Fs),e("div",Gs,[(d(!0),l(B,null,U(r(w).last_page,s=>(d(),l(B,{key:s},[Math.abs(s-r(w).current_page)<=2||s===1||s===r(w).last_page?(d(),l("button",{key:0,onClick:h=>F(s),class:u(["px-3 py-1 text-sm border rounded-lg",s===r(w).current_page?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-50 dark:border-gray-600 dark:hover:bg-gray-700"])},o(s),11,Hs)):Math.abs(s-r(w).current_page)===3?(d(),l("span",Qs,"...")):y("",!0)],64))),128))]),e("button",{onClick:t[10]||(t[10]=s=>F(r(w).current_page+1)),disabled:r(w).current_page===r(w).last_page,class:"px-3 py-1 text-sm border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-600 dark:hover:bg-gray-700"}," ถัดไป ",8,Js)])])):(d(),l("div",Ks,[x(r(c),{icon:"fluent:data-area-24-regular",class:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600"}),e("h3",Xs,o(r(j)?"ไม่พบผู้เรียน":"ยังไม่มีข้อมูลความคืบหน้า"),1),e("p",Ys,o(r(j)?"ลองค้นหาด้วยคำอื่น":"ยังไม่มีผู้เรียนในคอร์สนี้"),1)])),x(f,{show:r(A),onClose:t[22]||(t[22]=s=>A.value=!1),"max-width":"2xl"},{title:Q(()=>[m(" รายละเอียดความคืบหน้า - "+o(r(i)?.user?.name),1)]),content:Q(()=>[r(g)?(d(),l("div",Zs,[n.isCourseAdmin?(d(),l("div",er,[e("div",tr,[e("h4",sr,[x(r(c),{icon:"fluent:person-edit-24-regular",class:"w-5 h-5 text-blue-500"}),t[40]||(t[40]=m(" ข้อมูลผู้เรียน ",-1))]),e("a",{href:`/Learn/Courses/${n.courseId}/my-progress?member_id=${r(i).id}`,target:"_blank",class:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 flex items-center gap-1"},[t[41]||(t[41]=m(" ดูรายละเอียดทั้งหมด ",-1)),x(r(c),{icon:"fluent:open-24-regular",class:"w-4 h-4"})],8,rr)]),e("div",or,[e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"ชื่อ-สกุล (Name)",-1)),e("div",ar,[q(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>r(i).member_name=s),type:"text",class:"w-full sm:flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"ระบุชื่อ-สกุล"},null,512),[[D,r(i).member_name]]),e("button",{onClick:t[12]||(t[12]=s=>X(r(i))),class:"w-full sm:w-auto px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap"}," บันทึก ")])]),e("div",null,[t[43]||(t[43]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"อีเมล (Email)",-1)),e("div",dr,[q(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>r(i).member_email=s),type:"email",class:"w-full sm:flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"ระบุอีเมล"},null,512),[[D,r(i).member_email]]),e("button",{onClick:t[14]||(t[14]=s=>X(r(i))),class:"w-full sm:w-auto px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap"}," บันทึก ")])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"เลขที่ (No.)",-1)),e("div",lr,[q(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>r(i).order_number=s),type:"number",class:"w-full sm:flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"ระบุเลขที่"},null,512),[[D,r(i).order_number]]),e("button",{onClick:t[16]||(t[16]=s=>ne(r(i))),class:"w-full sm:w-auto px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap"}," บันทึก ")])]),e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"รหัสประจำตัว (Student ID)",-1)),e("div",nr,[q(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>r(i).member_code=s),type:"text",class:"w-full sm:flex-1 px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500",placeholder:"ระบุรหัสประจำตัว"},null,512),[[D,r(i).member_code]]),e("button",{onClick:t[18]||(t[18]=s=>le(r(i))),class:"w-full sm:w-auto px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap"}," บันทึก ")])]),e("div",ir,[t[47]||(t[47]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"สถานะ",-1)),q(e("select",{"onUpdate:modelValue":t[19]||(t[19]=s=>r(i).course_member_status=s),onChange:t[20]||(t[20]=s=>ie(r(i))),class:"w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white focus:ring-2 focus:ring-blue-500"},[...t[46]||(t[46]=[e("option",{value:1},"ปกติ (Active)",-1),e("option",{value:0},"พักการเรียน (Suspended)",-1)])],544),[[se,r(i).course_member_status]])])])])):y("",!0),e("div",gr,[e("div",cr,[e("div",ur,[(d(),l("svg",xr,[t[48]||(t[48]=e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3",class:"text-gray-200 dark:text-gray-600"},null,-1)),e("circle",{cx:"18",cy:"18",r:"15.5",fill:"none",stroke:"currentColor","stroke-width":"3","stroke-linecap":"round",class:"text-blue-500","stroke-dasharray":`${r(i)?.overall_progress||0} 100`},null,8,br)])),e("div",mr,[e("span",yr,o(r(i)?.overall_progress||0)+"%",1)])]),t[49]||(t[49]=e("p",{class:"text-xs text-gray-500 mt-2"},"ความคืบหน้า",-1))]),e("div",pr,[e("div",fr,[e("span",hr,o(r(i)?.scores?.grade_name||"-"),1)]),e("p",_r,"เกรด ("+o(r(i)?.scores?.grade_progress||0)+")",1)]),e("div",vr,[e("div",kr,[e("span",wr,o(r(i)?.attendance_rate||0)+"%",1)]),e("p",$r,"เข้าเรียน ("+o(r(i)?.attendance_present||0)+"/"+o(r(i)?.total_attendance||0)+")",1)]),e("div",Cr,[e("div",zr,[e("span",jr,o(r(i)?.scores?.total_score||0),1)]),t[50]||(t[50]=e("p",{class:"text-xs text-gray-500 mt-2"},"คะแนนรวม",-1))])]),e("div",Br,[e("div",Pr,[e("div",Ur,[e("span",Mr,[x(r(c),{icon:"fluent:book-24-regular",class:"w-4 h-4 text-blue-500"}),t[51]||(t[51]=m(" บทเรียน ",-1))]),e("span",Vr,o(r(i)?.lessons_completed||0)+"/"+o(r(i)?.total_lessons||0),1)]),e("div",qr,[e("div",{class:"h-full rounded-full bg-blue-500 transition-all duration-500",style:E({width:`${r(i)?.lessons_progress||0}%`})},null,4)])]),e("div",Ar,[e("div",Er,[e("span",Ir,[x(r(c),{icon:"fluent:document-text-24-regular",class:"w-4 h-4 text-orange-500"}),t[52]||(t[52]=m(" งาน ",-1))]),e("span",Dr,o(r(i)?.assignments_completed||0)+"/"+o(r(i)?.total_assignments||0),1)]),e("div",Tr,[e("div",{class:"h-full rounded-full bg-orange-500 transition-all duration-500",style:E({width:`${r(i)?.assignments_progress||0}%`})},null,4)])]),e("div",Sr,[e("div",Rr,[e("span",Nr,[x(r(c),{icon:"fluent:quiz-new-24-regular",class:"w-4 h-4 text-purple-500"}),t[53]||(t[53]=m(" ทดสอบ ",-1))]),e("span",Lr,o(r(i)?.quizzes_completed||0)+"/"+o(r(i)?.total_quizzes||0),1)]),e("div",Wr,[e("div",{class:"h-full rounded-full bg-purple-500 transition-all duration-500",style:E({width:`${r(i)?.quizzes_progress||0}%`})},null,4)])])]),e("div",Or,[e("h4",Fr,[x(r(c),{icon:"fluent:chart-multiple-24-regular",class:"w-5 h-5 text-blue-500"}),t[54]||(t[54]=m(" รายละเอียดคะแนน ",-1))]),e("div",Gr,[e("div",Hr,[e("div",Qr,[m(o(r(i)?.scores?.lesson_assignments||0),1),e("span",Jr,"/"+o(r(i)?.scores?.max_lesson_assignments||0),1)]),t[55]||(t[55]=e("p",{class:"text-xs text-gray-500"},"งานบทเรียน",-1))]),e("div",Kr,[e("div",Xr,[m(o(r(i)?.scores?.lesson_quizzes||0),1),e("span",Yr,"/"+o(r(i)?.scores?.max_lesson_quizzes||0),1)]),t[56]||(t[56]=e("p",{class:"text-xs text-gray-500"},"ทดสอบบทเรียน",-1))]),e("div",Zr,[e("div",eo,[m(o(r(i)?.scores?.course_assignments||0),1),e("span",to,"/"+o(r(i)?.scores?.max_course_assignments||0),1)]),t[57]||(t[57]=e("p",{class:"text-xs text-gray-500"},"งานรายวิชา",-1))]),e("div",so,[e("div",ro,[m(o(r(i)?.scores?.course_quizzes||0),1),e("span",oo,"/"+o(r(i)?.scores?.max_course_quizzes||0),1)]),t[58]||(t[58]=e("p",{class:"text-xs text-gray-500"},"ทดสอบรายวิชา",-1))])]),e("div",ao,[t[59]||(t[59]=e("span",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"คะแนนพิเศษ (Bonus)",-1)),e("span",lo,"+"+o(r(i)?.scores?.bonus_points||0),1)])]),e("div",no,[e("h4",io,[x(r(c),{icon:"fluent:book-24-regular",class:"w-5 h-5 text-blue-500"}),t[60]||(t[60]=m(" บทเรียน ",-1))]),r(g).lessons&&r(g).lessons.length>0?(d(),l("div",go,[(d(!0),l(B,null,U(r(g).lessons,s=>(d(),l("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("span",co,o(s.title),1),e("span",{class:u(["text-xs px-2 py-1 rounded-full",s.completed?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"])},o(s.completed?"เรียนจบแล้ว":"ยังไม่เริ่ม"),3)]))),128))])):(d(),l("p",uo,"ไม่มีข้อมูลบทเรียน"))]),e("div",xo,[e("h4",bo,[x(r(c),{icon:"fluent:document-text-24-regular",class:"w-5 h-5 text-orange-500"}),t[61]||(t[61]=m(" งานที่มอบหมาย ",-1))]),r(g).assignments&&r(g).assignments.length>0?(d(),l("div",mo,[(d(!0),l(B,null,U(r(g).assignments,s=>(d(),l("div",{key:s.id,class:"flex items-center justify-between gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("span",{class:"text-sm text-gray-700 dark:text-gray-300 truncate flex-1 min-w-0",title:s.title},o(s.title),9,yo),e("div",po,[s.graded?(d(),l("span",fo,o(s.score)+"/"+o(s.max_score),1)):y("",!0),e("span",{class:u(["text-xs px-2 py-1 rounded-full whitespace-nowrap",s.status==="graded"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":s.status==="in_review"?"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":s.status==="submitted"?"bg-yellow-100 text-yellow-600 dark:bg-yellow-900/30 dark:text-yellow-400":"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400"])},o(s.status==="graded"?"ตรวจแล้ว":s.status==="in_review"?"กำลังตรวจ":s.status==="submitted"?"รอตรวจ":"ยังไม่ส่ง"),3)])]))),128))])):(d(),l("p",ho,"ไม่มีข้อมูลงานที่มอบหมาย"))]),e("div",_o,[e("h4",vo,[x(r(c),{icon:"fluent:quiz-new-24-regular",class:"w-5 h-5 text-purple-500"}),t[62]||(t[62]=m(" แบบทดสอบ ",-1))]),r(g).quizzes&&r(g).quizzes.length>0?(d(),l("div",ko,[(d(!0),l(B,null,U(r(g).quizzes,s=>(d(),l("div",{key:s.id,class:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},[e("div",wo,[e("span",$o,o(s.title),1),s.attempt_count>0?(d(),l("span",Co," (ทำ "+o(s.attempt_count)+" ครั้ง) ",1)):y("",!0)]),e("div",zo,[s.completed?(d(),l("span",{key:0,class:u(["text-sm font-bold",s.passed===!1?"text-red-500":"text-green-600 dark:text-green-400"])},o(s.score)+"/"+o(s.max_score),3)):y("",!0),e("span",{class:u(["text-xs px-2 py-1 rounded-full whitespace-nowrap",s.completed?s.passed===!1?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-500 dark:bg-gray-600 dark:text-gray-400"])},o(s.completed?s.passed===!1?"ไม่ผ่าน":"ผ่าน":"ยังไม่ได้ทำ"),3)])]))),128))])):(d(),l("p",jo,"ไม่มีข้อมูลแบบทดสอบ"))])])):(d(),l("div",Bo,[...t[63]||(t[63]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mb-4"},null,-1),e("p",{class:"text-gray-500"},"กำลังโหลดข้อมูล...",-1)])]))]),footer:Q(()=>[e("button",{onClick:t[21]||(t[21]=s=>A.value=!1),class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600"}," ปิด ")]),_:1},8,["show"])])}}}),qo=J({__name:"progress",setup(n){const v=re("course"),$=re("isCourseAdmin");return(b,P)=>(d(),l("div",null,[r(v)?.id?(d(),T(Po,{key:0,"course-id":r(v).id,"is-course-admin":r($)},null,8,["course-id","is-course-admin"])):y("",!0)]))}});export{qo as default};
