import{_ as O,r as i,V as E,n as _,c as w,a as e,h as A,b as x,u as f,t as o,w as h,o as I,I as B,e as L,j as R,$ as d,aa as r}from"./cTealXVQ.js";import{_ as P}from"./CTH_zSYT.js";import{j as F}from"./unovbEJl.js";import{S as p}from"./BQxta0Da.js";import{G as q,V as H,Y}from"./h00NXFv8.js";const M={class:"flex justify-center items-center font-sarabun"},z={class:"student-card-container w-full max-w-[640px] aspect-[1.95/1.20] relative overflow-hidden rounded-2xl shadow-lg border border-gray-300"},G={class:"flex p-[3%] gap-[3%] h-[80%]"},K={class:"w-[30%] h-[75%] rounded-xl overflow-hidden flex-shrink-0"},W={key:0,class:"w-full h-full relative"},J=["src"],Q={key:1,class:"w-full h-full flex items-center justify-center bg-gray-300 cursor-pointer"},X={class:"flex-1 pt-0.5 relative"},Z={class:"flex items-baseline"},tt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},et={class:"flex items-baseline -mt-3 sm:-mt-4 md:-mt-5"},st={class:"flex-1 text-[1.8vw] sm:text-sm font-normal text-gray-800"},at={class:"flex items-baseline mt-0.5"},nt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},lt={class:"flex items-baseline mt-0.5"},ot={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},it={class:"flex items-baseline mt-0.5"},dt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},rt={class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},mt={class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},ut={class:"flex items-baseline mt-0.5"},xt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},ft={class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},pt={class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},gt={class:"flex items-baseline mt-0.5"},vt={class:"flex-1 text-[2.4vw] sm:text-sm md:text-lg font-semibold text-gray-800"},bt={class:"absolute bottom-[5%] right-[3%] w-[15%] aspect-square"},ct={class:"w-full h-full bg-white flex items-center justify-center rounded-lg shadow-md"},yt={class:"fixed inset-0 flex items-center justify-center p-4"},_t={class:"mb-4"},wt={class:"mb-4"},ht={class:"mb-4"},It={class:"mb-4"},St={class:"mb-4"},kt={class:"mb-6"},Dt={class:"flex justify-end gap-2"},Tt=["disabled"],Ut={__name:"StudentCard",props:{studentInfo:{type:Object,required:!0}},emits:["update","upload-image"],setup(S,{emit:jt}){const a=S,k=i(!1);i(!1);const g=i(!1),v=i(!1),s=E({id:a.studentInfo.id,student_number:a.studentInfo.student_number,title_name:a.studentInfo.title_name||"",first_name_thai:a.studentInfo.first_name_thai||"",last_name_thai:a.studentInfo.last_name_thai||"",full_name_thai:a.studentInfo.full_name_thai||((a.studentInfo.title_name||"")+" "+(a.studentInfo.first_name_thai||"")+" "+(a.studentInfo.last_name_thai||"")).trim(),first_name_english:a.studentInfo.first_name_english||"",level:a.studentInfo.class_level<4?"มัธยมศึกษาตอนต้น":"มัธยมศึกษาตอนปลาย",birth_date:a.studentInfo.birth_date,national_id:a.studentInfo.national_id,card_expiry_date:a.studentInfo.card_expiry_date}),D=_(()=>{if(!s.national_id)return"";const l=String(s.national_id);return l.length!==13?l:l.replace(/\D/g,"").replace(/(\d)(\d{4})(\d{5})(\d{2})(\d{1})/,"$1-$2-$3-$4-$5")}),T=_(()=>s.full_name_thai&&s.full_name_thai.trim()?s.full_name_thai.trim():[s.title_name?.trim(),s.first_name_thai?.trim(),s.last_name_thai?.trim()].filter(t=>t&&t!=="").join(" ")),c=i(null),b=i(null),y=i(a.studentInfo.profile_image||null),U=_(()=>b.value?b.value:y.value?`/storage/images/students/${a.studentInfo.class_level}/${a.studentInfo.class_section}/${y.value}`:null),j=l=>{const t=l.target.files[0];if(!t)return;const n=new FileReader;n.onload=m=>{b.value=m.target.result,k.value=!0,C(a.studentInfo.id,a.studentInfo.student_number,t)},n.readAsDataURL(t)},C=async(l,t,n)=>{if(!n||!t)return;const m=new FormData;m.append("photo",n),m.append("_method","patch");try{const u=await axios.post(`/student-card/admin/upload-photo/${l}`,m,{headers:{"Content-Type":"multipart/form-data"}});u.data.success?p.fire({icon:"success",title:"อัพโหลดรูปภาพสำเร็จ",text:u.data.message,confirmButtonText:"ตกลง"}):p.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:u.data.message||"ไม่สามารถอัพโหลดรูปภาพได้",confirmButtonText:"ตกลง"})}catch(u){console.error("Upload failed:",u),p.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถอัพโหลดรูปภาพได้",confirmButtonText:"ตกลง"})}finally{k.value=!1,c.value.value=""}},N=()=>{c.value.click()},V=async()=>{try{g.value=!0;const l={national_id:s.national_id,student_number:s.student_number,title_name:s.title_name,first_name_thai:s.first_name_thai,last_name_thai:s.last_name_thai,first_name_english:s.first_name_english,birth_date:s.birth_date};(await axios.put(`/student-card/update/${s.id}`,l,{headers:{"Content-Type":"application/json"}})).data.success&&(p.fire({title:"บันทึกข้อมูลสำเร็จ",icon:"success",confirmButtonText:"ตกลง"}),v.value=!1)}catch{p.fire({title:"เกิดข้อผิดพลาด",text:"ไม่สามารถบันทึกข้อมูลได้",icon:"error",confirmButtonText:"ตกลง"})}finally{g.value=!1}},$=l=>{try{const t=new Date(l);return isNaN(t.getTime())?"-":t.toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return console.error("Error formatting date:",t),"-"}};return(l,t)=>(I(),w("div",M,[e("div",z,[t[41]||(t[41]=A('<div class="h-[20%] bg-gradient-to-br from-gray-50 to-gray-200 relative" style="background:linear-gradient(135deg, transparent 40%, #4a90e2 0%);" data-v-73fca6fb><div class="absolute -left-2 md:-left-3 -top-[16px] sm:-top-[28px] md:-top-[22px] w-[22%] aspect-square rounded-full border-1 border-white flex items-center justify-center" data-v-73fca6fb><img src="'+P+'" alt="School Logo" class="w-[56%] h-[56%] object-cover rounded-full" data-v-73fca6fb></div><div class="absolute left-[16%] top-[10%] sm:top-2" data-v-73fca6fb><div class="text-[3.8vw] md:text-[28px] font-semibold md:font-bold text-gray-800" data-v-73fca6fb> โรงเรียนจริยธรรมศึกษามูลนิธิ </div><div class="text-[2.4vw] sm:text-[2.5vw] md:text-[16px] -mt-1 sm:-mt-2.5 md:-mt-2 font-base text-gray-800 tracking-wider" data-v-73fca6fb> CHARIYATHAMSUKSA FOUNDATION SCHOOL </div><div class="text-[2.4vw] md:text-sm -mt-0.5 sm:-mt-2 md:-mt-1 text-gray-800" data-v-73fca6fb> 148 ม.8 ต.สะกอม อ.จะนะ จ.สงขลา 90130 โทร.081-5412281 </div></div><div class="absolute z-10 top-6 md:top-[52px] right-2 text-white bg-blue-700 px-2 py-1 text-end rounded-md" data-v-73fca6fb><div class="text-[1.8vw] sm:text-[14px] font-semibold" data-v-73fca6fb>บัตรประจำตัวนักเรียน</div><div class="text-[1.4vw] sm:text-[10px] opacity-90" data-v-73fca6fb>STUDENT CARD</div></div></div>',1)),e("div",G,[e("div",K,[e("input",{type:"file",ref_key:"fileInput",ref:c,onChange:j,accept:"image/*",class:"hidden"},null,544),b.value||y.value?(I(),w("div",W,[e("img",{src:U.value,alt:"Student Photo",class:"w-full h-full object-cover"},null,8,J)])):(I(),w("div",Q,[x(f(B),{icon:"tabler:photo-plus",class:"w-10 h-10 text-gray-600/60",onClick:N})]))]),e("div",X,[e("div",Z,[t[9]||(t[9]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-md md:text-lg font-medium text-gray-700"},"ชื่อ",-1)),t[10]||(t[10]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",tt,o(T.value),1)]),t[27]||(t[27]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Name")],-1)),e("div",et,[t[11]||(t[11]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},null,-1)),t[12]||(t[12]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",st,o(s.first_name_english),1)]),e("div",at,[t[13]||(t[13]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"รหัสประจำตัว",-1)),t[14]||(t[14]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",nt,o(s.student_number),1)]),t[28]||(t[28]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Student ID")],-1)),e("div",lt,[t[15]||(t[15]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm font-medium text-gray-700"},"เลขบัตรประชาชน",-1)),t[16]||(t[16]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",ot,o(D.value),1)]),t[29]||(t[29]=e("div",{class:"flex items-baseline -mt-1"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"ID Card No.")],-1)),e("div",it,[t[17]||(t[17]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"}," ระดับ ",-1)),t[18]||(t[18]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",dt,o(s.level),1)]),e("div",rt,[t[19]||(t[19]=e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Level",-1)),t[20]||(t[20]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",mt,o(S.studentInfo.class_level<4?"LOWER SECONDARY":"UPPER SECONDARY"),1)]),e("div",ut,[t[21]||(t[21]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"วันเกิด",-1)),t[22]||(t[22]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",xt,o(new Date(s.birth_date).toLocaleDateString("th-TH",{day:"2-digit",month:"2-digit",year:"numeric"})),1)]),e("div",ft,[t[23]||(t[23]=e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Date of Birth",-1)),t[24]||(t[24]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":",-1)),e("span",pt,o(new Date(s.birth_date).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})),1)]),e("div",gt,[t[25]||(t[25]=e("span",{class:"w-[25%] text-[2.2vw] sm:text-sm md:text-lg font-medium text-gray-700"},"วันหมดอายุ",-1)),t[26]||(t[26]=e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700"},":",-1)),e("span",vt,o($(a.studentInfo.card_expiry_date)),1)]),t[30]||(t[30]=e("div",{class:"flex items-baseline -mt-1.5 sm:-mt-2 md:-mt-2.5"},[e("span",{class:"w-[25%] text-[2vw] sm:text-xs font-normal text-gray-600"},"Expiry Date"),e("span",{class:"mx-[1%] text-[2.2vw] sm:text-sm md:text-lg text-gray-700 text-transparent"},":"),e("span",{class:"flex-1 text-[1.4vw] sm:text-[12px] font-normal text-gray-800"},o("05/15/2027"))],-1))]),e("div",bt,[e("div",ct,[x(f(F),{value:`${a.studentInfo.student_number}`,cornersSquareOptions:{type:"extra-rounded",color:"#000"},dotsOptions:{type:"dots",color:"#000"},cornersDotOptions:{type:"square",color:"#000"}},null,8,["value"])])]),t[31]||(t[31]=e("div",{class:"absolute bottom-0 left-0 w-full h-[2.5%] flex items-center justify-center rounded-b-2xl",style:{background:"linear-gradient(135deg, #4a90e2 72%, transparent 0%)"}},[e("span",{class:"text-white text-[1vw] text-sm font-medium tracking-wider"})],-1))]),x(f(Y),{as:"div",onClose:t[8]||(t[8]=n=>v.value=!1),open:v.value,class:"relative z-50"},{default:h(()=>[t[40]||(t[40]=e("div",{class:"fixed inset-0 bg-black/30","aria-hidden":"true"},null,-1)),e("div",yt,[x(f(q),{class:"w-full max-w-md bg-white rounded-lg p-6 shadow-xl"},{default:h(()=>[x(f(H),{class:"text-lg font-medium text-gray-900 mb-4"},{default:h(()=>[...t[32]||(t[32]=[L("แก้ไขข้อมูลนักเรียน",-1)])]),_:1}),e("form",{onSubmit:R(V,["prevent"])},[e("div",_t,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"รหัสนักเรียน",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=n=>s.student_number=n),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[r,s.student_number]])]),e("div",wt,[t[34]||(t[34]=e("label",{class:"block text-sm font-medium text-gray-700"},"คำนำหน้าชื่อ",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=n=>s.title_name=n),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[r,s.title_name]])]),e("div",null,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700"},"ชื่อ",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=n=>s.first_name_thai=n),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[r,s.first_name_thai]])]),e("div",ht,[t[36]||(t[36]=e("label",{class:"block text-sm font-medium text-gray-700"},"นามสกุล",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=n=>s.last_name_thai=n),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[r,s.last_name_thai]])]),e("div",It,[t[37]||(t[37]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"ชื่อ-นามสกุล (อังกฤษ)",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>s.first_name_english=n),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[r,s.first_name_english]])]),e("div",St,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"เลขประจำตัวประชาชน",-1)),d(e("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>s.id_card_no=n),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[r,s.id_card_no]])]),e("div",kt,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"วันเกิด",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[6]||(t[6]=n=>s.date_of_birth=n),class:"w-full rounded-md border border-gray-300 px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none"},null,512),[[r,s.date_of_birth]])]),e("div",Dt,[e("button",{type:"button",onClick:t[7]||(t[7]=n=>v.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"}," ยกเลิก "),e("button",{type:"submit",disabled:g.value,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50"},o(g.value?"กำลังบันทึก...":"บันทึก"),9,Tt)])],32)]),_:1})])]),_:1},8,["open"])])]))}},Et=O(Ut,[["__scopeId","data-v-73fca6fb"]]);export{Et as default};
