import{q as P,y as H,c as s,a as t,t as o,$ as S,ab as T,F as y,k as x,b as m,u as f,e as I,d as z,p as M,r as n,aH as U,o as l,I as h,T as k}from"./Brb_7992.js";const j={class:"space-y-6"},R={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},q={class:"text-gray-500 dark:text-gray-400 mt-1"},A={class:"bg-white dark:bg-gray-800 rounded-2xl p-4 shadow-sm border border-gray-100 dark:border-gray-700"},E={class:"flex flex-col sm:flex-row gap-4"},G=["value"],J=["value"],K={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden"},O={key:0,class:"p-8 text-center"},Q={key:1,class:"p-8 text-center"},W={key:2,class:"overflow-x-auto"},X={class:"w-full"},Y={class:"divide-y divide-gray-100 dark:divide-gray-700"},Z={class:"px-4 py-3 text-sm text-gray-600 dark:text-gray-300"},ee={class:"px-4 py-3 text-sm text-gray-800 dark:text-white"},te={class:"px-4 py-3 text-sm text-gray-600 dark:text-gray-300 capitalize"},ae={class:"px-4 py-3 text-center"},re={class:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400"},se={key:3,class:"p-4 border-t border-gray-100 dark:border-gray-700"},le={class:"flex justify-center gap-1"},oe=["onClick"],ge=P({__name:"transactions",setup(ne){const B=M().public.apiBase,d=n([]),p=n(!0),i=n(1),v=n(1),V=n(20),b=n(0),g=n("all"),c=n("all"),$=[{value:"all",label:"ทั้งหมด"},{value:"deposit",label:"เติมเงิน"},{value:"withdraw",label:"ถอนเงิน"},{value:"transfer",label:"โอน"},{value:"payment",label:"ชำระเงิน"},{value:"refund",label:"คืนเงิน"}],_=[{value:"all",label:"ทั้งหมด"},{value:"pending",label:"รอดำเนินการ"},{value:"completed",label:"สำเร็จ"},{value:"failed",label:"ล้มเหลว"},{value:"cancelled",label:"ยกเลิก"}],u=async()=>{p.value=!0;try{const r=U("token"),a=new URLSearchParams({page:i.value.toString(),per_page:V.value.toString(),...g.value!=="all"&&{type:g.value},...c.value!=="all"&&{status:c.value}}),e=await $fetch(`${B}/api/admin/wallet-transactions?${a}`,{headers:{Authorization:`Bearer ${r.value}`}});e.success&&(d.value=e.data.data||e.data,v.value=e.data.last_page||1,b.value=e.data.total||d.value.length)}catch(r){console.error("Failed to fetch transactions:",r),d.value=[],b.value=0}finally{p.value=!1}},w=()=>{i.value=1,u()},D=r=>{i.value=r,u()},F=r=>{const a={pending:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",completed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",failed:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400",cancelled:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"};return a[r]||a.pending},L=r=>new Intl.NumberFormat("th-TH",{style:"currency",currency:"THB"}).format(r),N=r=>new Date(r).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return H(()=>{u()}),(r,a)=>(l(),s("div",j,[t("div",R,[t("div",null,[a[2]||(a[2]=t("h1",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"ธุรกรรมทั้งหมด",-1)),t("p",q," ธุรกรรม "+o(b.value.toLocaleString())+" รายการ ",1)])]),t("div",A,[t("div",E,[S(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>g.value=e),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:w},[(l(),s(y,null,x($,e=>t("option",{key:e.value,value:e.value},o(e.label),9,G)),64))],544),[[T,g.value]]),S(t("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>c.value=e),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",onChange:w},[(l(),s(y,null,x(_,e=>t("option",{key:e.value,value:e.value},o(e.label),9,J)),64))],544),[[T,c.value]]),t("button",{onClick:u,class:"px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-gray-700 dark:text-gray-300 transition-colors inline-flex items-center gap-2"},[m(f(h),{icon:"fluent:arrow-sync-24-regular",class:"w-5 h-5"}),a[3]||(a[3]=I(" รีเฟรช ",-1))])])]),t("div",K,[p.value?(l(),s("div",O,[m(f(h),{icon:"fluent:spinner-ios-20-regular",class:"w-8 h-8 text-indigo-600 animate-spin mx-auto"}),a[4]||(a[4]=t("p",{class:"text-gray-500 mt-2"},"กำลังโหลดข้อมูล...",-1))])):d.value.length===0?(l(),s("div",Q,[m(f(h),{icon:"fluent:wallet-24-regular",class:"w-12 h-12 text-gray-300 mx-auto"}),a[5]||(a[5]=t("p",{class:"text-gray-500 mt-2"},"ไม่พบธุรกรรม",-1))])):(l(),s("div",W,[t("table",X,[a[6]||(a[6]=t("thead",{class:"bg-gray-50 dark:bg-gray-700/50"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"ID"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"ผู้ใช้"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"ประเภท"),t("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"จำนวน"),t("th",{class:"px-4 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"สถานะ"),t("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase"},"วันที่")])],-1)),t("tbody",Y,[(l(!0),s(y,null,x(d.value,e=>(l(),s("tr",{key:e.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[t("td",Z,"#"+o(e.id),1),t("td",ee,o(e.user?.name||"-"),1),t("td",te,o(e.type),1),t("td",{class:k(["px-4 py-3 text-sm text-right font-medium",e.amount>=0?"text-green-600":"text-red-600"])},o(L(e.amount)),3),t("td",ae,[t("span",{class:k(["px-2 py-1 text-xs rounded-lg",F(e.status)])},o(_.find(C=>C.value===e.status)?.label||e.status),3)]),t("td",re,o(N(e.created_at)),1)]))),128))])])])),v.value>1?(l(),s("div",se,[t("div",le,[(l(!0),s(y,null,x(Math.min(v.value,10),e=>(l(),s("button",{key:e,onClick:C=>D(e),class:k(["w-10 h-10 rounded-lg text-sm font-medium transition-colors",i.value===e?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},o(e),11,oe))),128))])])):z("",!0)])]))}});export{ge as default};
