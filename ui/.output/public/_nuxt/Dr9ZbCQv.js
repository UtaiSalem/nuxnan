import{_ as P}from"./ChBnuzYQ.js";import{q as V,c as o,a as s,b as l,e as x,u as e,o as t,I as n,ay as Q,a9 as W,n as B,r as p,z as X,d as m,a7 as N,t as u,F as k,w as R,g as w,k as G,U as S,K as Y,p as Z,T as ee}from"./cTealXVQ.js";import{C as se}from"./ClrY4_Va.js";import"./DZzR-KKF.js";import"./CaSR6SuD.js";import"./BQxta0Da.js";import"./CuhQWnJh.js";import"./D7lyOd2e.js";import"./CYLt1a9j.js";import"./B8TD85Ki.js";const te={class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-6 min-h-[400px]"},re={class:"mb-6 flex items-center justify-between"},oe={class:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2"},ae=V({__name:"CourseGroupResources",props:{courseId:{},groupId:{},isCourseAdmin:{type:Boolean,default:!1}},setup(j){const c=j;return(b,y)=>(t(),o("div",te,[s("div",re,[s("h2",oe,[l(e(n),{icon:"heroicons:document-duplicate",class:"w-6 h-6 text-blue-500"}),y[0]||(y[0]=x(" ไฟล์และเอกสารประกอบการเรียน ",-1))])]),l(se,{"course-id":c.courseId,"group-id":c.groupId,"is-course-admin":c.isCourseAdmin,"initial-tab":"materials"},null,8,["course-id","group-id","is-course-admin"])]))}}),ie={class:"bg-white p-4 shadow rounded-lg"},ne={__name:"CourseGroupAttendance",props:{groups:Array},setup(j){return(c,b)=>(t(),o("div",ie,[...b[0]||(b[0]=[s("h3",{class:"font-bold mb-4"},"Course Group Attendance",-1),s("p",null,"Attendance records will be displayed here.",-1)])]))}},le={key:0,class:"flex items-center justify-center py-12"},ce={key:1,class:"space-y-6"},de={class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden shadow-lg"},ue={class:"p-6"},ge={class:"flex items-start justify-between gap-4"},pe={class:"flex items-start gap-4 flex-1"},me={class:"flex-1"},be={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},he={key:0,class:"text-gray-600 dark:text-gray-400 mb-3"},xe={class:"flex items-center gap-4 text-sm"},ye={class:"flex items-center gap-1 text-gray-600 dark:text-gray-400"},ve={key:0,class:"flex items-center gap-1 text-gray-600 dark:text-gray-400"},_e={class:"flex items-center gap-2"},fe=["disabled"],ke=["disabled"],we={class:"flex items-center gap-2 border-b border-gray-200 dark:border-gray-700 mb-6 overflow-x-auto"},$e=["onClick"],Ce={key:0},Ae={key:1},Ie={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-6"},je={class:"text-gray-600 dark:text-gray-300 whitespace-pre-line"},Me={class:"mt-6 grid grid-cols-2 gap-4"},ze={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-xl"},Be={class:"font-medium"},Ge={class:"p-4 bg-gray-50 dark:bg-gray-900 rounded-xl"},Te={class:"font-medium"},Fe={key:3,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-6"},Le={class:"text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2"},Ne={key:0,class:"mb-8"},Re={class:"text-lg font-semibold text-orange-500 mb-3 flex items-center gap-2"},Se={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Ve=["src","alt"],De={class:"flex-1 min-w-0"},Ue={class:"font-medium text-gray-900 dark:text-white truncate"},Oe={class:"flex items-center gap-1"},Ee=["onClick"],He=["onClick"],Je={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},Ke=["src","alt"],qe={class:"flex-1 min-w-0"},Pe={class:"font-medium text-gray-900 dark:text-white truncate"},Qe={key:2,class:"text-center py-8"},We={key:2,class:"text-center py-12"},ns=V({__name:"[groupId]",setup(j){const c=S("course"),b=S("isCourseAdmin"),y=Q(),h=W(),D=Z(),g=B(()=>Array.isArray(y.params.groupId)?y.params.groupId[0]:y.params.groupId),i=p(null),$=p([]),C=p([]),M=p(!0),v=p(!1),_=p(!1);p(!1);const f=p("about"),U=B(()=>[{id:"attendance",label:"การเข้าเรียน",icon:"heroicons:calendar-days"},{id:"resources",label:"ไฟล์/เอกสาร",icon:"heroicons:document-duplicate"},{id:"members",label:"สมาชิก",icon:"heroicons:users"},{id:"about",label:"เกี่ยวกับ",icon:"heroicons:information-circle"}]),O=B(()=>!!i.value?.groupMemberOfAuth),A=async()=>{if(!(!c?.value?.id||!g.value)){M.value=!0;try{const r=await h.get(`/api/courses/${c.value.id}/groups/${g.value}`);i.value=r.group||r.data?.group||r,$.value=i.value.members||[],(b.value||i.value.groupMemberOfAuth?.role==="admin")&&await z()}catch(r){console.error("Failed to load group:",r)}finally{M.value=!1}}},z=async()=>{try{const r=await h.get(`/api/courses/${c.value.id}/groups/${g.value}/members/requesters`);C.value=r.data||[]}catch(r){console.error("Failed to load requesters:",r)}},E=async r=>{try{await h.post(`/api/courses/${c.value.id}/groups/${g.value}/members/${r}/approve`,{}),await A(),await z()}catch(a){alert(a.data?.message||"ไม่สามารถอนุมัติได้")}},H=async r=>{if(confirm("ยืนยันการปฏิเสธคำขอ?"))try{await h.post(`/api/courses/${c.value.id}/groups/${g.value}/members/${r}/reject`,{}),await z()}catch(a){alert(a.data?.message||"ไม่สามารถปฏิเสธได้")}},J=async()=>{if(!v.value){v.value=!0;try{await h.post(`/api/courses/${c.value.id}/groups/${g.value}/members/join`,{}),await A()}catch(r){alert(r.data?.message||"ไม่สามารถเข้าร่วมกลุ่มได้")}finally{v.value=!1}}},K=async()=>{if(!_.value&&confirm("คุณต้องการออกจากกลุ่มนี้ใช่หรือไม่?")){_.value=!0;try{await h.post(`/api/courses/${c.value.id}/groups/${g.value}/members/leave`,{}),await A()}catch(r){alert(r.data?.message||"ไม่สามารถออกจากกลุ่มได้")}finally{_.value=!1}}},q=async()=>{if(confirm("ยืนยันการลบกลุ่มนี้หรือไม่? สมาชิกในกลุ่มจะถูกย้ายไปยังกลุ่มหลัก"))try{await h.delete(`/api/courses/${c.value.id}/groups/${g.value}`),Y(`/courses/${c.value.id}/groups`)}catch(r){alert(r.data?.message||"ไม่สามารถลบกลุ่มได้")}},T=r=>(r.user||r.member)?.avatar||"/images/default-avatar.png",I=r=>(r.user||r.member)?.name||"Unknown User";return X(()=>{A()}),(r,a)=>{const F=P;return t(),o("div",null,[e(M)?(t(),o("div",le,[l(e(n),{icon:"svg-spinners:ring-resize",class:"w-8 h-8 text-blue-500"})])):e(i)?(t(),o("div",ce,[s("div",de,[s("div",{class:"h-32 bg-gradient-to-br from-purple-500 via-pink-500 to-orange-500",style:N(e(i).cover?{backgroundImage:`url(${e(D).public.apiBase}/storage/images/courses/groups/covers/${e(i).cover})`,backgroundSize:"cover"}:{})},null,4),s("div",ue,[s("div",ge,[s("div",pe,[s("div",{class:"w-20 h-20 rounded-2xl flex items-center justify-center flex-shrink-0 shadow-lg",style:N({backgroundColor:e(i).color||"#3B82F6"})},[l(e(n),{icon:"heroicons:user-group",class:"w-10 h-10 text-white"})],4),s("div",me,[s("h1",be,u(e(i).name),1),e(i).description?(t(),o("p",he,u(e(i).description),1)):m("",!0),s("div",xe,[s("span",ye,[l(e(n),{icon:"heroicons:users",class:"w-5 h-5"}),x(" "+u(e(i).members_count||0)+" สมาชิก ",1)]),e(i).max_members?(t(),o("span",ve,[l(e(n),{icon:"heroicons:user-plus",class:"w-5 h-5"}),x(" สูงสุด "+u(e(i).max_members)+" คน ",1)])):m("",!0)])])]),s("div",_e,[e(b)?(t(),o(k,{key:0},[l(F,{to:`/courses/${e(c).id}/groups/${e(g)}/edit`,class:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"แก้ไข"},{default:R(()=>[l(e(n),{icon:"fluent:edit-24-filled",class:"w-5 h-5"})]),_:1},8,["to"]),s("button",{onClick:q,class:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"ลบ"},[l(e(n),{icon:"fluent:delete-24-filled",class:"w-5 h-5"})])],64)):(t(),o(k,{key:1},[e(O)?(t(),o("button",{key:1,onClick:K,disabled:e(_),class:"flex items-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-lg transition-colors disabled:opacity-50"},[e(_)?(t(),w(e(n),{key:0,icon:"svg-spinners:ring-resize",class:"w-5 h-5"})):(t(),w(e(n),{key:1,icon:"heroicons:arrow-left-on-rectangle",class:"w-5 h-5"})),s("span",null,u(e(_)?"กำลังออก...":"ออกจากกลุ่ม"),1)],8,ke)):(t(),o("button",{key:0,onClick:J,disabled:e(v),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white font-semibold rounded-lg transition-colors disabled:opacity-50"},[e(v)?(t(),w(e(n),{key:0,icon:"svg-spinners:ring-resize",class:"w-5 h-5"})):(t(),w(e(n),{key:1,icon:"heroicons:user-plus",class:"w-5 h-5"})),s("span",null,u(e(v)?"กำลังเข้าร่วม...":"เข้าร่วมกลุ่ม"),1)],8,fe))],64))])])])]),s("div",we,[(t(!0),o(k,null,G(e(U),d=>(t(),o("button",{key:d.id,onClick:L=>f.value=d.id,class:ee(["flex items-center gap-2 px-4 py-3 border-b-2 font-medium transition-colors whitespace-nowrap",e(f)===d.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"])},[l(e(n),{icon:d.icon,class:"w-5 h-5"},null,8,["icon"]),x(" "+u(d.label),1)],10,$e))),128))]),e(f)==="attendance"?(t(),o("div",Ce,[e(i)?(t(),w(ne,{key:0,groups:[e(i)]},null,8,["groups"])):m("",!0)])):m("",!0),e(f)==="resources"?(t(),o("div",Ae,[l(ae,{"course-id":e(c).id,"group-id":e(g),"is-course-admin":e(b)},null,8,["course-id","group-id","is-course-admin"])])):m("",!0),e(f)==="about"?(t(),o("div",Ie,[a[2]||(a[2]=s("h2",{class:"text-xl font-bold mb-4"},"เกี่ยวกับกลุ่ม",-1)),s("p",je,u(e(i).description||"ไม่มีคำอธิบาย"),1),s("div",Me,[s("div",ze,[a[0]||(a[0]=s("div",{class:"text-sm text-gray-500"},"วันที่สร้าง",-1)),s("div",Be,u(e(i).created_at?new Date(e(i).created_at).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"-"),1)]),s("div",Ge,[a[1]||(a[1]=s("div",{class:"text-sm text-gray-500"},"สถานะ",-1)),s("div",Te,u(e(i).privacy==="private"?"กลุ่มส่วนตัว":"กลุ่มสาธารณะ"),1)])])])):m("",!0),e(f)==="members"?(t(),o("div",Fe,[s("h2",Le,[l(e(n),{icon:"heroicons:users",class:"w-6 h-6"}),x(" สมาชิกกลุ่ม ("+u(e($).length)+") ",1)]),e(C).length>0?(t(),o("div",Ne,[s("h3",Re,[l(e(n),{icon:"heroicons:user-plus",class:"w-5 h-5"}),x(" คำขอเข้าร่วม ("+u(e(C).length)+") ",1)]),s("div",Se,[(t(!0),o(k,null,G(e(C),d=>(t(),o("div",{key:d.id,class:"flex items-center gap-3 p-3 bg-orange-50 dark:bg-orange-900/10 border border-orange-100 dark:border-orange-900/30 rounded-lg"},[s("img",{src:T(d),alt:I(d),class:"w-10 h-10 rounded-full object-cover"},null,8,Ve),s("div",De,[s("p",Ue,u(I(d)),1),a[3]||(a[3]=s("p",{class:"text-xs text-orange-500"},"รออนุมัติ",-1))]),s("div",Oe,[s("button",{onClick:L=>E(d.id),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"อนุมัติ"},[l(e(n),{icon:"fluent:checkmark-24-filled",class:"w-5 h-5"})],8,Ee),s("button",{onClick:L=>H(d.id),class:"p-1 text-red-600 hover:bg-red-100 rounded",title:"ปฏิเสธ"},[l(e(n),{icon:"fluent:dismiss-24-filled",class:"w-5 h-5"})],8,He)])]))),128))])])):m("",!0),e($).length>0?(t(),o("div",Je,[(t(!0),o(k,null,G(e($),d=>(t(),o("div",{key:d.id,class:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-900 transition-colors"},[s("img",{src:T(d),alt:I(d),class:"w-10 h-10 rounded-full object-cover"},null,8,Ke),s("div",qe,[s("p",Pe,u(I(d)),1),a[4]||(a[4]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"สมาชิก",-1))])]))),128))])):(t(),o("div",Qe,[l(e(n),{icon:"heroicons:user-group",class:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-2"}),a[5]||(a[5]=s("p",{class:"text-gray-500 dark:text-gray-400"},"ยังไม่มีสมาชิกในกลุ่มนี้",-1))]))])):m("",!0)])):(t(),o("div",We,[l(e(n),{icon:"heroicons:exclamation-circle",class:"w-16 h-16 text-red-500 mx-auto mb-4"}),a[7]||(a[7]=s("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"ไม่พบข้อมูลกลุ่ม",-1)),l(F,{to:`/courses/${e(c)?.id}/groups`,class:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-700"},{default:R(()=>[l(e(n),{icon:"heroicons:arrow-left",class:"w-5 h-5"}),a[6]||(a[6]=x(" กลับไปหน้ากลุ่ม ",-1))]),_:1},8,["to"])]))])}}});export{ns as default};
