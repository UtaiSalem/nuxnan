import{q as S,o as l,c as p,a as t,b as n,T as h,u as r,I as d,t as C,j,d as B,n as $,ay as q,a9 as F,y as U,g as I,w as _,r as x,e as T,F as K,k as R,a4 as H,$ as L,aa as N,K as J}from"./Brb_7992.js";import{S as A}from"./BQxta0Da.js";import O from"./Cbl2BWlS.js";import"./Bw_wEDt3.js";import"./BP2gnDQ3.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./CZYWTWzM.js";import"./BF4yyfxD.js";import"./KqkJvF9s.js";import"./rPLS4Pv1.js";import"./BerWVpxm.js";const P={class:"absolute top-3 left-3 flex items-center gap-1 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-full px-3 py-1 shadow-lg"},Q={class:"text-xs font-semibold text-gray-700 dark:text-gray-200"},W={key:0,class:"absolute top-3 right-3 flex items-center gap-1 bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded-full px-2 py-1 shadow-lg"},X={class:"relative px-5 py-4"},Y={class:"flex justify-center -mt-12 mb-3"},Z={class:"relative"},ee={class:"relative w-20 h-20 rounded-2xl border-4 border-white dark:border-gray-800 bg-white dark:bg-gray-700 overflow-hidden shadow-xl"},te={class:"text-center text-lg font-bold text-gray-900 dark:text-white mb-1 line-clamp-1 group-hover/card:text-purple-600 dark:group-hover/card:text-purple-400 transition-colors"},re={key:0,class:"text-center text-sm text-gray-500 dark:text-gray-400 mb-4 line-clamp-2"},oe={key:1,class:"mb-4"},se={class:"flex items-center justify-center gap-6 mb-4"},ae={class:"text-center"},le={class:"text-xl font-black text-gray-900 dark:text-white"},ie=S({__name:"AcademyGroupCard",props:{group:{},isAcademyAdmin:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["edit","delete","click","join"],setup(u,{emit:k}){const g=u,c=k,y={department:"from-indigo-400 to-purple-500",classroom:"from-cyan-400 to-blue-500",club:"from-green-400 to-teal-500"},f=$(()=>y[g.group.type]||"from-purple-400 to-pink-500"),m={department:"ฝ่ายงาน",classroom:"ห้องเรียน",club:"ชมรม"},w=$(()=>m[g.group.type]||"กลุ่ม"),b={department:"heroicons:briefcase-solid",classroom:"heroicons:academic-cap-solid",club:"heroicons:star-solid"},s=$(()=>b[g.group.type]||"heroicons:user-group-solid");return(G,o)=>(l(),p("div",{class:"group/card relative bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-100 dark:border-gray-700 hover:scale-[1.02] cursor-pointer",onClick:o[3]||(o[3]=v=>c("click",u.group))},[t("div",{class:h(["relative h-24 bg-gradient-to-br flex items-center justify-center",r(f)])},[t("div",P,[n(r(d),{icon:r(s),class:h(["w-4 h-4",`text-${u.group.type==="department"?"indigo":u.group.type==="classroom"?"cyan":"green"}-600`])},null,8,["icon","class"]),t("span",Q,C(r(w)),1)]),u.isAcademyAdmin?(l(),p("div",W,[t("button",{onClick:o[0]||(o[0]=j(v=>c("edit",u.group),["stop"])),class:"p-1.5 text-blue-600 hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-full transition-colors",title:"แก้ไข"},[n(r(d),{icon:"fluent:edit-24-filled",class:"w-4 h-4"})]),t("button",{onClick:o[1]||(o[1]=j(v=>c("delete",u.group.id),["stop"])),class:"p-1.5 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-full transition-colors",title:"ลบ"},[n(r(d),{icon:"fluent:delete-24-filled",class:"w-4 h-4"})])])):B("",!0)],2),t("div",X,[t("div",Y,[t("div",Z,[o[4]||(o[4]=t("div",{class:"absolute inset-0 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 rounded-2xl blur-lg opacity-50 group-hover/card:opacity-70 transition-opacity"},null,-1)),t("div",ee,[t("div",{class:h(`w-full h-full flex items-center justify-center bg-gradient-to-br ${r(f)}`)},[n(r(d),{icon:r(s),class:"w-8 h-8 text-white"},null,8,["icon"])],2)])])]),t("h3",te,C(u.group.name),1),u.group.description?(l(),p("p",re,C(u.group.description),1)):(l(),p("div",oe)),t("div",se,[t("div",ae,[t("div",le,C(u.group.members_count||0),1),o[5]||(o[5]=t("div",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," สมาชิก ",-1))])]),t("button",{onClick:o[2]||(o[2]=j(v=>c("click",u.group),["stop"])),class:"w-full py-2.5 bg-gradient-to-r from-purple-500 via-blue-500 to-purple-600 hover:from-purple-600 hover:via-blue-600 hover:to-purple-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center gap-2 group/btn"},[n(r(d),{icon:"heroicons:eye-solid",class:"w-5 h-5 group-hover/btn:scale-110 transition-transform"}),o[6]||(o[6]=t("span",null,"ดูรายละเอียด",-1))])])]))}}),ne={key:0,class:"flex justify-center items-center h-screen"},de={key:1,class:"flex flex-col justify-center items-center h-screen gap-4"},ce={class:"mt-4"},ue={class:"flex items-center justify-between mb-6"},pe={class:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2"},ge={key:0,class:"flex justify-center items-center h-[40vh]"},me={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},ye={key:2,class:"flex flex-col justify-center items-center h-[40vh] text-center"},be={key:0,class:"text-gray-400 dark:text-gray-500 text-sm"},xe={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md mx-4 overflow-hidden"},fe={class:"bg-gradient-to-r from-purple-500 to-blue-500 px-6 py-4"},ve={class:"text-xl font-bold text-white flex items-center gap-2"},he={class:"p-6 space-y-4"},ke={class:"grid grid-cols-3 gap-2"},we={class:"px-6 py-4 bg-gray-50 dark:bg-gray-700/50 flex justify-end gap-3"},$e=["disabled"],De={__name:"AcademyGroups",setup(u){const k=q(),g=F(),c=x(null),y=x(!1),f=x(!0),m=x([]),w=x(!1),b=x(!1),s=x({name:"",description:"",type:"classroom"}),G=$(()=>k.query.academyId||k.params.academyId),o=$(()=>k.params.name),v=async()=>{try{f.value=!0;let a="";if(o.value)a=`/api/academies/${o.value}`;else if(G.value)a=`/api/academies/by-id/${G.value}`;else{console.error("No academy identifier provided");return}const e=await g.get(a);e&&(c.value=e.academy||e,y.value=e.isAcademyAdmin||!1)}catch(a){console.error("Error fetching academy:",a)}finally{f.value=!1}},V=async()=>{if(!c.value?.id&&!c.value?.data?.id)return;const a=c.value?.id||c.value?.data?.id;try{w.value=!0;const e=await g.get(`/api/academies/${a}/groups`);e.success&&(m.value=e.groups)}catch(e){console.error("Error fetching groups:",e)}finally{w.value=!1}},z=async()=>{const a=c.value?.id||c.value?.data?.id;if(a)try{const e=await g.post(`/api/academies/${a}/groups`,s.value);e.success&&(m.value.push(e.group),b.value=!1,s.value={name:"",description:"",type:"classroom"},A.fire({icon:"success",title:"สร้างกลุ่มสำเร็จ",text:"กลุ่มใหม่ถูกสร้างเรียบร้อยแล้ว",timer:2e3,showConfirmButton:!1}))}catch(e){console.error("Error creating group:",e),A.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถสร้างกลุ่มได้ กรุณาลองใหม่อีกครั้ง"})}},E=async a=>{if((await A.fire({icon:"warning",title:"ยืนยันการลบ",text:"คุณต้องการลบกลุ่มนี้หรือไม่? การดำเนินการนี้ไม่สามารถยกเลิกได้",showCancelButton:!0,confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก",confirmButtonColor:"#dc2626"})).isConfirmed)try{(await g.delete(`/api/academies/groups/${a}`)).success&&(m.value=m.value.filter(M=>M.id!==a),A.fire({icon:"success",title:"ลบกลุ่มสำเร็จ",timer:2e3,showConfirmButton:!1}))}catch(i){console.error("Error deleting group:",i)}},D=a=>{J(`/Learn/Academy/GroupDetail?groupId=${a.id}`)};return U(async()=>{await v(),await V()}),(a,e)=>f.value?(l(),p("div",ne,[n(r(d),{icon:"svg-spinners:ring-resize",class:"w-12 h-12 text-purple-500"})])):c.value?(l(),I(O,{key:2,academy:c.value,isAcademyAdmin:y.value},{academyContent:_(()=>[t("div",ce,[t("div",ue,[t("h2",pe,[n(r(d),{icon:"heroicons:user-group-solid",class:"w-7 h-7 text-purple-500"}),e[9]||(e[9]=T(" กลุ่มในโรงเรียน ",-1))]),y.value?(l(),p("button",{key:0,onClick:e[0]||(e[0]=i=>b.value=!0),class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300"},[n(r(d),{icon:"heroicons:plus-circle-solid",class:"w-5 h-5"}),e[10]||(e[10]=T(" สร้างกลุ่มใหม่ ",-1))])):B("",!0)]),w.value?(l(),p("div",ge,[n(r(d),{icon:"svg-spinners:ring-resize",class:"w-12 h-12 text-purple-500"})])):m.value.length>0?(l(),p("div",me,[(l(!0),p(K,null,R(m.value,i=>(l(),I(ie,{key:i.id,group:i,isAcademyAdmin:y.value,onClick:D,onDelete:E},null,8,["group","isAcademyAdmin"]))),128))])):(l(),p("div",ye,[n(r(d),{icon:"heroicons:user-group",class:"w-20 h-20 text-gray-300 dark:text-gray-600 mb-4"}),e[11]||(e[11]=t("p",{class:"text-gray-500 dark:text-gray-400 text-lg mb-2"},"ยังไม่มีกลุ่มในโรงเรียนนี้",-1)),y.value?(l(),p("p",be,'กดปุ่ม "สร้างกลุ่มใหม่" เพื่อเริ่มต้น')):B("",!0)])),(l(),I(H,{to:"body"},[b.value?(l(),p("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:e[7]||(e[7]=j(i=>b.value=!1,["self"]))},[t("div",xe,[t("div",fe,[t("h3",ve,[n(r(d),{icon:"heroicons:plus-circle-solid",class:"w-6 h-6"}),e[12]||(e[12]=T(" สร้างกลุ่มใหม่ ",-1))])]),t("div",he,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"}," ชื่อกลุ่ม ",-1)),L(t("input",{"onUpdate:modelValue":e[1]||(e[1]=i=>s.value.name=i),type:"text",class:"w-full px-4 py-3 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"เช่น ฝ่ายวิชาการ, ห้อง ม.4/1"},null,512),[[N,s.value.name]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"}," ประเภทกลุ่ม ",-1)),t("div",ke,[t("button",{onClick:e[2]||(e[2]=i=>s.value.type="department"),class:h(["flex flex-col items-center p-3 rounded-xl border-2 transition-all",s.value.type==="department"?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/30":"border-gray-200 dark:border-gray-600 hover:border-gray-300"])},[n(r(d),{icon:"heroicons:briefcase-solid",class:"w-6 h-6 text-indigo-500 mb-1"}),e[14]||(e[14]=t("span",{class:"text-xs font-medium"},"ฝ่ายงาน",-1))],2),t("button",{onClick:e[3]||(e[3]=i=>s.value.type="classroom"),class:h(["flex flex-col items-center p-3 rounded-xl border-2 transition-all",s.value.type==="classroom"?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/30":"border-gray-200 dark:border-gray-600 hover:border-gray-300"])},[n(r(d),{icon:"heroicons:academic-cap-solid",class:"w-6 h-6 text-cyan-500 mb-1"}),e[15]||(e[15]=t("span",{class:"text-xs font-medium"},"ห้องเรียน",-1))],2),t("button",{onClick:e[4]||(e[4]=i=>s.value.type="club"),class:h(["flex flex-col items-center p-3 rounded-xl border-2 transition-all",s.value.type==="club"?"border-green-500 bg-green-50 dark:bg-green-900/30":"border-gray-200 dark:border-gray-600 hover:border-gray-300"])},[n(r(d),{icon:"heroicons:star-solid",class:"w-6 h-6 text-green-500 mb-1"}),e[16]||(e[16]=t("span",{class:"text-xs font-medium"},"ชมรม",-1))],2)])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"}," คำอธิบาย (ไม่บังคับ) ",-1)),L(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=i=>s.value.description=i),rows:"3",class:"w-full px-4 py-3 border border-gray-200 dark:border-gray-600 rounded-xl bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none",placeholder:"อธิบายเกี่ยวกับกลุ่มนี้..."},null,512),[[N,s.value.description]])])]),t("div",we,[t("button",{onClick:e[6]||(e[6]=i=>b.value=!1),class:"px-4 py-2 text-gray-600 dark:text-gray-300 font-medium rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"}," ยกเลิก "),t("button",{onClick:z,disabled:!s.value.name,class:"px-6 py-2 bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white font-semibold rounded-lg shadow disabled:opacity-50 disabled:cursor-not-allowed transition-all"}," สร้างกลุ่ม ",8,$e)])])])):B("",!0)]))])]),_:1},8,["academy","isAcademyAdmin"])):(l(),p("div",de,[n(r(d),{icon:"heroicons:exclamation-circle",class:"w-16 h-16 text-red-400"}),e[8]||(e[8]=t("p",{class:"text-gray-600 dark:text-gray-300 text-lg"},"ไม่สามารถโหลดข้อมูลโรงเรียนได้",-1)),t("button",{onClick:v,class:"px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg"}," ลองใหม่อีกครั้ง ")]))}};export{De as default};
