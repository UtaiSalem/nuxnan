import{_ as D}from"./ChBnuzYQ.js";import{q as A,p as F,v as O,r as k,V as $,c as n,a as e,d as g,b as c,w as _,u as p,t as d,e as b,$ as l,aa as i,T as f,ab as w,F as h,k as V,ai as z,g as U,j as E,o as s,I as y,aH as I}from"./cTealXVQ.js";const L={class:"space-y-6 max-w-2xl mx-auto"},R={class:"flex items-center gap-4"},H={key:0,class:"p-4 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-xl"},P={class:"flex items-center gap-2 text-green-700 dark:text-green-400"},q={key:1,class:"p-4 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-700 rounded-xl"},G={class:"flex items-center gap-2 text-red-700 dark:text-red-400"},J={class:"flex gap-2"},K={key:0,class:"mt-1 text-sm text-red-500"},Q={key:0,class:"mt-1 text-sm text-red-500"},W={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},X=["value"],Y={class:"relative"},Z={class:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400"},ee={key:0,class:"mt-1 text-sm text-red-500"},re={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},te={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},oe={key:0,class:"mt-1 text-sm text-red-500"},le={key:0,class:"mt-1 text-sm text-red-500"},se=["value"],de={class:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl"},ne={class:"flex items-center gap-3 cursor-pointer"},ie={class:"flex flex-col sm:flex-row gap-3 pt-4"},ue=["disabled"],ye=A({__name:"create",setup(ge){const C=F().public.apiBase,B=O(),x=k(!1),o=k({}),v=k(""),t=$({code:"",name:"",description:"",discount_type:"percentage",discount_value:0,min_purchase:0,max_discount:0,usage_limit:null,per_user_limit:1,start_date:"",end_date:"",is_active:!0,applicable_to:"all"}),M=[{value:"percentage",label:"เปอร์เซ็นต์ (%)"},{value:"fixed",label:"จำนวนเงิน (บาท)"}],S=[{value:"all",label:"ทุกสินค้า/บริการ"},{value:"courses",label:"เฉพาะคอร์สเรียน"},{value:"products",label:"เฉพาะสินค้า"}],T=()=>{const u="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let r="";for(let m=0;m<8;m++)r+=u.charAt(Math.floor(Math.random()*u.length));t.code=r},N=()=>(o.value={},t.code||(o.value.code="กรุณากรอกรหัสคูปอง"),t.name||(o.value.name="กรุณากรอกชื่อคูปอง"),t.discount_value<=0&&(o.value.discount_value="กรุณากรอกมูลค่าส่วนลด"),t.discount_type==="percentage"&&t.discount_value>100&&(o.value.discount_value="เปอร์เซ็นต์ต้องไม่เกิน 100"),t.start_date||(o.value.start_date="กรุณาเลือกวันที่เริ่มต้น"),t.end_date||(o.value.end_date="กรุณาเลือกวันที่สิ้นสุด"),t.start_date&&t.end_date&&new Date(t.start_date)>new Date(t.end_date)&&(o.value.end_date="วันที่สิ้นสุดต้องหลังจากวันที่เริ่มต้น"),Object.keys(o.value).length===0),j=async()=>{if(N()){x.value=!0,v.value="";try{const u=I("token");(await $fetch(`${C}/api/admin/coupons`,{method:"POST",headers:{Authorization:`Bearer ${u.value}`,"Content-Type":"application/json"},body:t})).success&&(v.value="สร้างคูปองสำเร็จ",setTimeout(()=>{B.push("/nuxnan-admin/coupons")},1500))}catch(u){u.data?.errors?o.value=u.data.errors:o.value.general=u.data?.message||"เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง"}finally{x.value=!1}}};return(u,r)=>{const m=D;return s(),n("div",L,[e("div",R,[c(m,{to:"/nuxnan-admin/coupons",class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors"},{default:_(()=>[c(p(y),{icon:"fluent:arrow-left-24-regular",class:"w-5 h-5"})]),_:1}),r[13]||(r[13]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-800 dark:text-white"},"สร้างคูปองใหม่"),e("p",{class:"text-gray-500 dark:text-gray-400 mt-1"},"กรอกข้อมูลเพื่อสร้างคูปองส่วนลด")],-1))]),v.value?(s(),n("div",H,[e("div",P,[c(p(y),{icon:"fluent:checkmark-circle-24-filled",class:"w-5 h-5"}),e("span",null,d(v.value),1)])])):g("",!0),o.value.general?(s(),n("div",q,[e("div",G,[c(p(y),{icon:"fluent:error-circle-24-filled",class:"w-5 h-5"}),e("span",null,d(o.value.general),1)])])):g("",!0),e("form",{onSubmit:E(j,["prevent"]),class:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-gray-700 space-y-6"},[e("div",null,[r[14]||(r[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[b(" รหัสคูปอง "),e("span",{class:"text-red-500"},"*")],-1)),e("div",J,[l(e("input",{"onUpdate:modelValue":r[0]||(r[0]=a=>t.code=a),type:"text",class:f(["flex-1 px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent uppercase",{"border-red-500":o.value.code}]),placeholder:"SAVE20"},null,2),[[i,t.code]]),e("button",{type:"button",onClick:T,class:"px-4 py-2.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-gray-700 dark:text-gray-300 transition-colors"},[c(p(y),{icon:"fluent:arrow-sync-24-regular",class:"w-5 h-5"})])]),o.value.code?(s(),n("p",K,d(o.value.code),1)):g("",!0)]),e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[b(" ชื่อคูปอง "),e("span",{class:"text-red-500"},"*")],-1)),l(e("input",{"onUpdate:modelValue":r[1]||(r[1]=a=>t.name=a),type:"text",class:f(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":o.value.name}]),placeholder:"ส่วนลด 20% สำหรับสมาชิกใหม่"},null,2),[[i,t.name]]),o.value.name?(s(),n("p",Q,d(o.value.name),1)):g("",!0)]),e("div",null,[r[16]||(r[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," คำอธิบาย ",-1)),l(e("textarea",{"onUpdate:modelValue":r[2]||(r[2]=a=>t.description=a),rows:"3",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",placeholder:"รายละเอียดเพิ่มเติมของคูปอง"},null,512),[[i,t.description]])]),e("div",W,[e("div",null,[r[17]||(r[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ประเภทส่วนลด ",-1)),l(e("select",{"onUpdate:modelValue":r[3]||(r[3]=a=>t.discount_type=a),class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"},[(s(),n(h,null,V(M,a=>e("option",{key:a.value,value:a.value},d(a.label),9,X)),64))],512),[[w,t.discount_type]])]),e("div",null,[r[18]||(r[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[b(" มูลค่าส่วนลด "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Y,[l(e("input",{"onUpdate:modelValue":r[4]||(r[4]=a=>t.discount_value=a),type:"number",min:"0",class:f(["w-full px-4 py-2.5 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":o.value.discount_value}])},null,2),[[i,t.discount_value,void 0,{number:!0}]]),e("span",Z,d(t.discount_type==="percentage"?"%":"฿"),1)]),o.value.discount_value?(s(),n("p",ee,d(o.value.discount_value),1)):g("",!0)])]),e("div",re,[e("div",null,[r[19]||(r[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ยอดสั่งซื้อขั้นต่ำ (บาท) ",-1)),l(e("input",{"onUpdate:modelValue":r[5]||(r[5]=a=>t.min_purchase=a),type:"number",min:"0",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"0"},null,512),[[i,t.min_purchase,void 0,{number:!0}]])]),e("div",null,[r[20]||(r[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ส่วนลดสูงสุด (บาท) ",-1)),l(e("input",{"onUpdate:modelValue":r[6]||(r[6]=a=>t.max_discount=a),type:"number",min:"0",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"0 = ไม่จำกัด"},null,512),[[i,t.max_discount,void 0,{number:!0}]])])]),e("div",te,[e("div",null,[r[21]||(r[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," จำนวนใช้งานทั้งหมด ",-1)),l(e("input",{"onUpdate:modelValue":r[7]||(r[7]=a=>t.usage_limit=a),type:"number",min:"0",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"ไม่จำกัด"},null,512),[[i,t.usage_limit,void 0,{number:!0}]])]),e("div",null,[r[22]||(r[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," จำกัดต่อผู้ใช้ ",-1)),l(e("input",{"onUpdate:modelValue":r[8]||(r[8]=a=>t.per_user_limit=a),type:"number",min:"1",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[i,t.per_user_limit,void 0,{number:!0}]])])]),e("div",ae,[e("div",null,[r[23]||(r[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[b(" วันที่เริ่มต้น "),e("span",{class:"text-red-500"},"*")],-1)),l(e("input",{"onUpdate:modelValue":r[9]||(r[9]=a=>t.start_date=a),type:"datetime-local",class:f(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":o.value.start_date}])},null,2),[[i,t.start_date]]),o.value.start_date?(s(),n("p",oe,d(o.value.start_date),1)):g("",!0)]),e("div",null,[r[24]||(r[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[b(" วันที่สิ้นสุด "),e("span",{class:"text-red-500"},"*")],-1)),l(e("input",{"onUpdate:modelValue":r[10]||(r[10]=a=>t.end_date=a),type:"datetime-local",class:f(["w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent",{"border-red-500":o.value.end_date}])},null,2),[[i,t.end_date]]),o.value.end_date?(s(),n("p",le,d(o.value.end_date),1)):g("",!0)])]),e("div",null,[r[25]||(r[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," ใช้ได้กับ ",-1)),l(e("select",{"onUpdate:modelValue":r[11]||(r[11]=a=>t.applicable_to=a),class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-xl text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"},[(s(),n(h,null,V(S,a=>e("option",{key:a.value,value:a.value},d(a.label),9,se)),64))],512),[[w,t.applicable_to]])]),e("div",de,[e("label",ne,[l(e("input",{"onUpdate:modelValue":r[12]||(r[12]=a=>t.is_active=a),type:"checkbox",class:"w-5 h-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"},null,512),[[z,t.is_active]]),r[26]||(r[26]=e("span",{class:"text-gray-700 dark:text-gray-300"},"เปิดใช้งานทันที",-1))])]),e("div",ie,[e("button",{type:"submit",disabled:x.value,class:"flex-1 inline-flex justify-center items-center gap-2 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 rounded-xl text-white font-medium transition-colors"},[x.value?(s(),U(p(y),{key:0,icon:"fluent:spinner-ios-20-regular",class:"w-5 h-5 animate-spin"})):(s(),U(p(y),{key:1,icon:"fluent:save-24-regular",class:"w-5 h-5"})),b(" "+d(x.value?"กำลังบันทึก...":"สร้างคูปอง"),1)],8,ue),c(m,{to:"/nuxnan-admin/coupons",class:"flex-1 inline-flex justify-center items-center gap-2 px-6 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-xl text-gray-700 dark:text-gray-300 font-medium transition-colors"},{default:_(()=>[c(p(y),{icon:"fluent:dismiss-24-regular",class:"w-5 h-5"}),r[27]||(r[27]=b(" ยกเลิก ",-1))]),_:1})])],32)])}}});export{ye as default};
