import{_ as C}from"./BP2gnDQ3.js";import{q as S,ay as B,i as I,y as V,c as i,a as e,b as r,w as L,t as l,u as c,F as z,k as D,g as E,j as F,e as x,d as M,a4 as R,p as T,n as v,r as f,o as a,I as u}from"./Brb_7992.js";import{j as q}from"./unovbEJl.js";import{S as H}from"./BQxta0Da.js";const U={class:"min-h-screen bg-gradient-to-br from-blue-100 via-white to-blue-200"},A={class:"bg-white shadow-sm sticky top-0 z-40"},G={class:"max-w-7xl mx-auto px-4 py-4"},J={class:"flex items-center justify-between"},K={class:"flex items-center gap-4"},O={class:"text-xl font-bold text-gray-800"},P={class:"text-sm text-gray-500"},Q={key:0,class:"flex items-center justify-center py-20"},W={key:1,class:"max-w-7xl mx-auto px-4 py-6"},X={key:0,class:"text-center py-20"},Y={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},Z=["onClick"],ee={class:"relative aspect-[1.6/1] bg-gradient-to-br from-blue-500 to-blue-600 p-4"},te={class:"absolute top-2 right-2 bg-white/20 backdrop-blur px-2 py-1 rounded text-xs text-white"},se={class:"flex items-center gap-3 h-full"},oe={class:"w-20 h-24 bg-white rounded-lg overflow-hidden flex-shrink-0"},le=["src","alt"],ae={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},ie={class:"flex-1 min-w-0 text-white"},ne={class:"font-semibold text-sm truncate"},re={class:"text-xs opacity-80"},ce={class:"p-3 border-t"},de={class:"flex items-center justify-between text-sm"},ue={class:"text-gray-500"},_e={class:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},he={class:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between"},me={class:"p-6"},ve={class:"bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700 rounded-2xl p-6 text-white mb-6 shadow-lg"},ge={class:"flex items-start gap-4"},xe={class:"w-28 h-36 bg-white rounded-xl overflow-hidden flex-shrink-0 shadow-md"},fe=["src","alt"],pe={key:1,class:"w-full h-full flex items-center justify-center bg-gray-100"},be={class:"flex-1"},ye={class:"text-xl font-bold mb-1"},we={class:"text-blue-100 text-sm mb-3"},ke={class:"space-y-1 text-sm"},$e={class:"bg-white p-2 rounded-xl"},je={class:"grid grid-cols-2 gap-4"},Ne={class:"bg-gray-50 rounded-xl p-4"},Ce={class:"font-mono font-semibold text-gray-800"},Se={class:"bg-gray-50 rounded-xl p-4"},Be={class:"font-semibold text-gray-800"},Me=S({__name:"[room]",setup(Ie){const p=B(),w=T().public.apiBase||"",b=v(()=>Number(p.params.level)),d=v(()=>Number(p.params.room)),_=v(()=>["","ม.1","ม.2","ม.3","ม.4","ม.5","ม.6"][b.value]||"");I({title:v(()=>`บัตรนักเรียน ${_.value}/${d.value}`)});const h=f([]),t=f(null),g=f(!0),k=async()=>{g.value=!0;try{const o=await $fetch(`${w}/student-card/${b.value}/${d.value}`);h.value=o.students||[]}catch(o){console.error("Error fetching students:",o),H.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:"ไม่สามารถโหลดข้อมูลนักเรียนได้"})}finally{g.value=!1}},m=o=>o.profile_image?`/storage/images/students/${o.class_level}/${o.class_section}/${o.profile_image}`:null,$=o=>!o||o.length!==13?o:o.replace(/(\d)(\d{4})(\d{5})(\d{2})(\d{1})/,"$1-$2-$3-$4-$5"),j=o=>{t.value=o},y=()=>{t.value=null};return V(()=>{k()}),(o,s)=>{const N=C;return a(),i("div",U,[e("div",A,[e("div",G,[e("div",J,[e("div",K,[r(N,{to:"/student-card",class:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},{default:L(()=>[r(c(u),{icon:"heroicons:arrow-left",class:"w-6 h-6 text-gray-600"})]),_:1}),e("div",null,[e("h1",O,"บัตรนักเรียน "+l(_.value)+"/"+l(d.value),1),e("p",P,l(h.value.length)+" คน",1)])])])])]),g.value?(a(),i("div",Q,[...s[0]||(s[0]=[e("div",{class:"text-center"},[e("div",{class:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e("p",{class:"text-gray-600"},"กำลังโหลดข้อมูล...")],-1)])])):(a(),i("div",W,[h.value.length===0?(a(),i("div",X,[r(c(u),{icon:"heroicons:user-group",class:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s[1]||(s[1]=e("p",{class:"text-gray-500"},"ไม่พบข้อมูลนักเรียน",-1))])):(a(),i("div",Y,[(a(!0),i(z,null,D(h.value,n=>(a(),i("div",{key:n.id,onClick:Le=>j(n),class:"bg-white rounded-xl shadow-md overflow-hidden cursor-pointer hover:shadow-lg transition-shadow"},[e("div",ee,[e("div",te,l(n.student_number),1),e("div",se,[e("div",oe,[m(n)?(a(),i("img",{key:0,src:m(n),alt:n.full_name_thai,class:"w-full h-full object-cover"},null,8,le)):(a(),i("div",ae,[r(c(u),{icon:"heroicons:user",class:"w-8 h-8 text-gray-400"})]))]),e("div",ie,[e("p",ne,l(n.full_name_thai||`${n.title_name}${n.first_name_thai} ${n.last_name_thai}`),1),e("p",re,l(_.value)+"/"+l(d.value),1)])])]),e("div",ce,[e("div",de,[e("span",ue,"เลขที่ "+l(n.order_no),1),s[2]||(s[2]=e("button",{class:"text-blue-600 hover:text-blue-700 font-medium"}," ดูรายละเอียด ",-1))])])],8,Z))),128))]))])),(a(),E(R,{to:"body"},[t.value?(a(),i("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:F(y,["self"])},[e("div",_e,[e("div",he,[s[3]||(s[3]=e("h2",{class:"text-lg font-bold text-gray-800"},"รายละเอียดนักเรียน",-1)),e("button",{onClick:y,class:"p-2 hover:bg-gray-100 rounded-lg"},[r(c(u),{icon:"heroicons:x-mark",class:"w-6 h-6 text-gray-500"})])]),e("div",me,[e("div",ve,[e("div",ge,[e("div",xe,[m(t.value)?(a(),i("img",{key:0,src:m(t.value),alt:t.value.full_name_thai,class:"w-full h-full object-cover"},null,8,fe)):(a(),i("div",pe,[r(c(u),{icon:"heroicons:user",class:"w-12 h-12 text-gray-400"})]))]),e("div",be,[e("p",ye,l(t.value.full_name_thai||`${t.value.title_name}${t.value.first_name_thai} ${t.value.last_name_thai}`),1),e("p",we,l(t.value.first_name_english)+" "+l(t.value.last_name_english),1),e("div",ke,[e("p",null,[s[4]||(s[4]=e("span",{class:"opacity-70"},"รหัสนักเรียน:",-1)),x(" "+l(t.value.student_number),1)]),e("p",null,[s[5]||(s[5]=e("span",{class:"opacity-70"},"ชั้น:",-1)),x(" "+l(_.value)+"/"+l(d.value),1)]),e("p",null,[s[6]||(s[6]=e("span",{class:"opacity-70"},"เลขที่:",-1)),x(" "+l(t.value.order_no),1)])])]),e("div",$e,[r(c(q),{value:t.value.student_number||"",width:80,height:80},null,8,["value"])])])]),e("div",je,[e("div",Ne,[s[7]||(s[7]=e("p",{class:"text-sm text-gray-500 mb-1"},"เลขบัตรประชาชน",-1)),e("p",Ce,l($(t.value.national_id)),1)]),e("div",Se,[s[8]||(s[8]=e("p",{class:"text-sm text-gray-500 mb-1"},"วันเกิด",-1)),e("p",Be,l(t.value.birth_date_string||t.value.birth_date||"-"),1)])])])])])):M("",!0)]))])}}});export{Me as default};
