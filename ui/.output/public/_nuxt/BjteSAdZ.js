import{_ as J,r as v,n as k,c as r,a as e,h as S,e as i,$ as y,ab as A,F as x,k as p,aa as F,t as l,d,o as n,a7 as K,T as f,b as O,w as Q,a1 as R}from"./CHs-R6Sv.js";const W={class:"space-y-6"},X={class:"bg-white shadow-lg rounded-2xl p-6 border border-gray-100 animate-fade-in"},Y={class:"grid md:grid-cols-4 gap-4"},Z={class:"filter-item"},ee={class:"filter-item"},te=["value"],se={class:"filter-item"},ae={class:"filter-item"},re={class:"mt-5 flex items-center justify-between pt-4 border-t border-gray-100"},ne={class:"flex items-center space-x-2"},le={class:"px-3 py-1.5 rounded-lg bg-indigo-50 border border-indigo-200"},oe={class:"text-xs font-semibold text-indigo-700"},ie={class:"space-y-8"},de={key:0,class:"bg-white rounded-2xl shadow-lg p-16 text-center animate-fade-in"},ue={key:0,class:"absolute left-6 top-16 w-0.5 h-full bg-gradient-to-b from-indigo-400 via-purple-400 to-transparent"},ce={class:"flex items-start"},ge={class:"flex flex-col items-center"},me={class:"ml-8 flex-1"},fe={class:"visit-card bg-white rounded-2xl shadow-md hover:shadow-2xl border border-gray-100 overflow-hidden transition-all duration-300 hover:-translate-y-1 group"},xe={class:"p-6"},pe={class:"flex justify-between items-start"},be={class:"flex-1"},ve={class:"text-base font-bold text-gray-900 group-hover:text-indigo-600 transition-colors duration-200 flex items-center"},ye={class:"text-xs text-gray-500 mt-1.5 flex items-center"},he={class:"text-right ml-4"},we={class:"text-xs text-gray-400 flex items-center justify-end mb-2"},_e={key:0,class:"mt-4 p-4 bg-gradient-to-br from-gray-50 to-indigo-50/30 rounded-xl border border-gray-100"},ke={class:"text-sm text-gray-700 leading-relaxed whitespace-pre-line line-clamp-3"},De={key:1,class:"mt-5 grid grid-cols-3 gap-3"},je=["onClick"],Ce=["src"],Ve={key:0,class:"absolute inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center text-white font-bold text-lg"},ze={class:"text-center"},Se={class:"mt-5 grid sm:grid-cols-2 lg:grid-cols-4 gap-4 text-xs"},Ae={class:"flex items-center space-x-2 p-2.5 bg-indigo-50 rounded-lg hover:bg-indigo-100 transition-colors duration-200"},Fe={class:"text-gray-700 font-semibold"},Ne={class:"flex items-center space-x-2 p-2.5 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors duration-200"},Pe={class:"text-gray-700 font-semibold truncate"},Te={key:0,class:"flex items-center space-x-2 p-2.5 bg-pink-50 rounded-lg hover:bg-pink-100 transition-colors duration-200"},Ue={class:"text-gray-700 font-semibold"},$e={key:1,class:"flex items-center space-x-2 p-2.5 bg-green-50 rounded-lg hover:bg-green-100 transition-colors duration-200"},Be={class:"text-gray-700 font-semibold text-[11px]"},Ie={class:"mt-5 pt-5 border-t border-gray-100 flex items-center justify-between"},Me={class:"flex space-x-3"},Ee=["onClick"],Le=["onClick"],qe={class:"flex items-center space-x-2"},He={class:"text-[10px] text-gray-400 bg-gray-50 px-2.5 py-1 rounded-full font-mono"},Ge={key:0,class:"mt-5 pt-5 border-t border-gray-100 space-y-4"},Je={key:0,class:"animate-slide-in"},Ke={class:"space-y-2 ml-2"},Oe={key:1,class:"animate-slide-in animation-delay-100"},Qe={class:"space-y-2 ml-2"},Re={key:2,class:"animate-slide-in animation-delay-200"},We={class:"space-y-2 ml-2"},Xe={key:1,class:"flex justify-center pt-8 animate-fade-in"},Ye={class:"inline-flex items-center bg-white rounded-xl shadow-lg p-2 space-x-1 border border-gray-100","aria-label":"Pagination"},Ze=["disabled"],et={class:"px-6 py-2.5 text-sm"},tt={class:"font-semibold text-indigo-600"},st={class:"text-gray-600"},at=["disabled"],rt={__name:"VisitFeed",props:{visits:{type:Array,default:()=>[]},zones:{type:Array,default:()=>[]}},emits:["view-details"],setup(D,{emit:N}){const P=D,T=N,o=v({status:"",zone:"",startDate:"",endDate:""}),c=v(new Set),g=v(1),h=v(10),U=()=>{o.value={status:"",zone:"",startDate:"",endDate:""}},j=a=>a?new Date(a).toLocaleString("th-TH",{dateStyle:"medium",timeStyle:"short"}):"-",$=a=>{switch(a){case"pending":return"รอดำเนินการ";case"in-progress":return"กำลังดำเนินการ";case"completed":return"เสร็จสิ้น";case"cancelled":return"ยกเลิก";default:return"ไม่ระบุ"}},w=a=>{switch(a){case"pending":return"bg-gray-400";case"in-progress":return"bg-yellow-500";case"completed":return"bg-green-600";case"cancelled":return"bg-red-500";default:return"bg-indigo-500"}},B=a=>{switch(a){case"pending":return"fas fa-clock";case"in-progress":return"fas fa-spinner";case"completed":return"fas fa-check";case"cancelled":return"fas fa-times";default:return"fas fa-info"}},I=a=>{switch(a){case"pending":return"bg-gray-100 text-gray-800";case"in-progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-indigo-100 text-indigo-800"}},M=a=>{switch(a){case"pending":return"bg-gray-500";case"in-progress":return"bg-yellow-500";case"completed":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-indigo-500"}},b=k(()=>P.visits.filter(a=>{if(o.value.status&&a.visit_status!==o.value.status||o.value.zone&&String(a.zone_id)!==String(o.value.zone))return!1;if(o.value.startDate){const t=new Date(a.visit_date),s=new Date(o.value.startDate);if(t<s)return!1}if(o.value.endDate){const t=new Date(a.visit_date),s=new Date(o.value.endDate);if(t>s)return!1}return!0}).sort((a,t)=>new Date(t.visit_date)-new Date(a.visit_date))),_=k(()=>Math.max(1,Math.ceil(b.value.length/h.value))),C=k(()=>{const a=(g.value-1)*h.value;return b.value.slice(a,a+h.value)}),E=()=>{g.value<_.value&&g.value++},L=()=>{g.value>1&&g.value--},q=a=>{c.value.has(a)?c.value.delete(a):c.value.add(a),c.value=new Set(c.value)},V=a=>{T("view-details",a)},H=()=>{},G=a=>typeof a=="string"?a:a&&typeof a=="object"&&(a.url||a.path||a.src)||"";return(a,t)=>(n(),r("div",W,[e("div",{class:"header-card bg-gradient-to-br from-indigo-600 via-purple-600 to-pink-500 shadow-xl rounded-2xl p-8 text-white relative overflow-hidden"},[t[6]||(t[6]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute -top-4 -right-4 w-32 h-32 bg-white rounded-full animate-blob"}),e("div",{class:"absolute -bottom-8 -left-4 w-40 h-40 bg-white rounded-full animate-blob animation-delay-2000"}),e("div",{class:"absolute top-1/2 left-1/2 w-36 h-36 bg-white rounded-full animate-blob animation-delay-4000"})],-1)),e("div",{class:"relative z-10 flex items-center justify-between"},[t[5]||(t[5]=S('<div class="animate-fade-in-up" data-v-cbb856c5><h2 class="text-3xl font-bold flex items-center" data-v-cbb856c5><div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center mr-3 animate-pulse-soft" data-v-cbb856c5><i class="fas fa-stream text-2xl" data-v-cbb856c5></i></div> ฟีดการเยี่ยมบ้านนักเรียน </h2><p class="mt-2 text-white/90 text-sm ml-15" data-v-cbb856c5>ไทม์ไลน์แสดงความคืบหน้าการเยี่ยมบ้านทั้งหมดเรียงตามเวลาล่าสุด</p></div>',1)),e("div",{class:"flex space-x-3 animate-fade-in"},[e("button",{onClick:H,class:"group px-4 py-2.5 text-sm rounded-xl bg-white/20 backdrop-blur-md hover:bg-white/30 transition-all duration-300 border border-white/30 hover:scale-105 hover:shadow-lg"},[...t[4]||(t[4]=[e("i",{class:"fas fa-sync-alt mr-2 group-hover:rotate-180 transition-transform duration-500"},null,-1),i(" รีเฟรช ",-1)])])])])]),e("div",X,[t[15]||(t[15]=e("div",{class:"flex items-center mb-4"},[e("i",{class:"fas fa-filter text-indigo-600 mr-2"}),e("h3",{class:"text-sm font-semibold text-gray-700"},"ตัวกรองข้อมูล")],-1)),e("div",Y,[e("div",Z,[t[8]||(t[8]=e("label",{class:"text-xs font-medium text-gray-700 mb-2 flex items-center"},[e("i",{class:"fas fa-tasks text-indigo-500 mr-1.5 text-xs"}),i(" สถานะ ")],-1)),y(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.status=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 hover:border-indigo-400"},[...t[7]||(t[7]=[S('<option value="" data-v-cbb856c5>ทั้งหมด</option><option value="pending" data-v-cbb856c5>รอดำเนินการ</option><option value="in-progress" data-v-cbb856c5>กำลังดำเนินการ</option><option value="completed" data-v-cbb856c5>เสร็จสิ้น</option><option value="cancelled" data-v-cbb856c5>ยกเลิก</option>',5)])],512),[[A,o.value.status]])]),e("div",ee,[t[10]||(t[10]=e("label",{class:"text-xs font-medium text-gray-700 mb-2 flex items-center"},[e("i",{class:"fas fa-map-marker-alt text-indigo-500 mr-1.5 text-xs"}),i(" โซน ")],-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.zone=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 hover:border-indigo-400"},[t[9]||(t[9]=e("option",{value:""},"ทั้งหมด",-1)),(n(!0),r(x,null,p(D.zones,s=>(n(),r("option",{key:s.id,value:s.id},l(s.name),9,te))),128))],512),[[A,o.value.zone]])]),e("div",se,[t[11]||(t[11]=e("label",{class:"text-xs font-medium text-gray-700 mb-2 flex items-center"},[e("i",{class:"fas fa-calendar-alt text-indigo-500 mr-1.5 text-xs"}),i(" วันที่เริ่ม ")],-1)),y(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>o.value.startDate=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 hover:border-indigo-400"},null,512),[[F,o.value.startDate]])]),e("div",ae,[t[12]||(t[12]=e("label",{class:"text-xs font-medium text-gray-700 mb-2 flex items-center"},[e("i",{class:"fas fa-calendar-check text-indigo-500 mr-1.5 text-xs"}),i(" วันที่สิ้นสุด ")],-1)),y(e("input",{type:"date","onUpdate:modelValue":t[3]||(t[3]=s=>o.value.endDate=s),class:"w-full rounded-lg border-gray-300 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all duration-200 hover:border-indigo-400"},null,512),[[F,o.value.endDate]])])]),e("div",re,[e("button",{onClick:U,class:"group text-xs px-4 py-2 rounded-lg bg-gradient-to-r from-gray-100 to-gray-200 text-gray-700 hover:from-gray-200 hover:to-gray-300 transition-all duration-200 font-medium hover:shadow-md"},[...t[13]||(t[13]=[e("i",{class:"fas fa-redo-alt mr-1.5 group-hover:rotate-180 transition-transform duration-300"},null,-1),i(" ล้างตัวกรอง ",-1)])]),e("div",ne,[e("div",le,[e("span",oe,[t[14]||(t[14]=e("i",{class:"fas fa-chart-bar mr-1"},null,-1)),i(" "+l(b.value.length)+" รายการ ",1)])])])])]),e("div",ie,[b.value.length?d("",!0):(n(),r("div",de,[...t[16]||(t[16]=[e("div",{class:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-gray-100 to-gray-200 rounded-full mb-6 animate-bounce-slow"},[e("i",{class:"fas fa-inbox text-3xl text-gray-400"})],-1),e("h3",{class:"text-lg font-semibold text-gray-700 mb-2"},"ไม่พบข้อมูล",-1),e("p",{class:"text-sm text-gray-500"},"ไม่พบข้อมูลการเยี่ยมบ้านตามเงื่อนไขที่เลือก",-1)])])),(n(!0),r(x,null,p(C.value,(s,z)=>(n(),r("div",{key:s.id,class:"relative timeline-item",style:K({animationDelay:`${z*100}ms`})},[z!==C.value.length-1?(n(),r("div",ue)):d("",!0),e("div",ce,[e("div",ge,[e("div",{class:f(["w-12 h-12 rounded-full flex items-center justify-center shadow-lg text-white relative transition-all duration-300 hover:scale-110",w(s.visit_status)])},[e("div",{class:f(["absolute inset-0 rounded-full animate-ping opacity-20",w(s.visit_status)])},null,2),e("i",{class:f([B(s.visit_status),"text-lg relative z-10"])},null,2)],2)]),e("div",me,[e("div",fe,[e("div",{class:f(["h-1.5",w(s.visit_status)])},null,2),e("div",xe,[e("div",pe,[e("div",be,[e("h3",ve,[t[17]||(t[17]=e("i",{class:"fas fa-user-graduate text-indigo-500 mr-2"},null,-1)),i(" "+l(s.student?.first_name)+" "+l(s.student?.last_name),1)]),e("p",ye,[t[18]||(t[18]=e("i",{class:"fas fa-school text-gray-400 mr-1.5"},null,-1)),i(" ชั้น "+l(s.student?.classroom||"-")+" ",1),t[19]||(t[19]=e("span",{class:"mx-2"},"•",-1)),t[20]||(t[20]=e("i",{class:"fas fa-chalkboard-teacher text-gray-400 mr-1.5"},null,-1)),i(" ครู: "+l(s.teacher_name||"-"),1)])]),e("div",he,[e("div",we,[t[21]||(t[21]=e("i",{class:"far fa-clock mr-1.5"},null,-1)),i(" "+l(j(s.visit_date)),1)]),e("span",{class:f(["inline-flex items-center px-3 py-1.5 rounded-full text-xs font-semibold shadow-sm",I(s.visit_status)])},[e("span",{class:f(["w-2 h-2 rounded-full mr-2 animate-pulse",M(s.visit_status)])},null,2),i(" "+l($(s.visit_status)),1)],2)])]),s.notes||s.summary?(n(),r("div",_e,[e("p",ke,l(s.summary||s.notes),1)])):d("",!0),s.images&&s.images.length?(n(),r("div",De,[(n(!0),r(x,null,p(s.images.slice(0,3),(u,m)=>(n(),r("div",{key:m,class:"aspect-square overflow-hidden rounded-xl cursor-pointer group/img relative shadow-md hover:shadow-xl transition-all duration-300",onClick:nt=>V(s)},[e("img",{src:G(u),class:"object-cover w-full h-full group-hover/img:scale-110 transition-transform duration-500"},null,8,Ce),t[23]||(t[23]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover/img:opacity-100 transition-opacity duration-300"},null,-1)),m===2&&s.images.length>3?(n(),r("div",Ve,[e("div",ze,[t[22]||(t[22]=e("i",{class:"fas fa-images text-2xl mb-1"},null,-1)),e("div",null,"+"+l(s.images.length-3),1)])])):d("",!0)],8,je))),128))])):d("",!0),e("div",Se,[e("div",Ae,[t[25]||(t[25]=e("div",{class:"w-8 h-8 bg-indigo-100 rounded-lg flex items-center justify-center"},[e("i",{class:"fas fa-map-marker-alt text-indigo-600"})],-1)),e("div",null,[t[24]||(t[24]=e("div",{class:"text-[10px] text-indigo-600 font-medium"},"โซน",-1)),e("div",Fe,l(s.zone?.name||"-"),1)])]),e("div",Ne,[t[27]||(t[27]=e("div",{class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},[e("i",{class:"fas fa-user-friends text-purple-600"})],-1)),e("div",null,[t[26]||(t[26]=e("div",{class:"text-[10px] text-purple-600 font-medium"},"ผู้เยี่ยม",-1)),e("div",Pe,l(s.visitor_name||s.teacher_name||"N/A"),1)])]),s.duration?(n(),r("div",Te,[t[29]||(t[29]=e("div",{class:"w-8 h-8 bg-pink-100 rounded-lg flex items-center justify-center"},[e("i",{class:"fas fa-hourglass-half text-pink-600"})],-1)),e("div",null,[t[28]||(t[28]=e("div",{class:"text-[10px] text-pink-600 font-medium"},"ระยะเวลา",-1)),e("div",Ue,l(s.duration)+" นาที",1)])])):d("",!0),s.next_schedule?(n(),r("div",$e,[t[31]||(t[31]=e("div",{class:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center"},[e("i",{class:"fas fa-calendar-plus text-green-600"})],-1)),e("div",null,[t[30]||(t[30]=e("div",{class:"text-[10px] text-green-600 font-medium"},"ครั้งต่อไป",-1)),e("div",Be,l(j(s.next_schedule)),1)])])):d("",!0)]),e("div",Ie,[e("div",Me,[e("button",{onClick:u=>V(s),class:"group/btn flex items-center px-4 py-2 text-xs font-medium text-indigo-600 bg-indigo-50 rounded-lg hover:bg-indigo-600 hover:text-white transition-all duration-200 hover:shadow-md"},[...t[32]||(t[32]=[e("i",{class:"fas fa-eye mr-2 group-hover/btn:scale-110 transition-transform"},null,-1),i(" ดูรายละเอียด ",-1)])],8,Ee),e("button",{onClick:u=>q(s.id),class:"group/btn flex items-center px-4 py-2 text-xs font-medium text-gray-600 bg-gray-50 rounded-lg hover:bg-gray-600 hover:text-white transition-all duration-200 hover:shadow-md"},[e("i",{class:f(["mr-2 transition-transform",c.value.has(s.id)?"fas fa-chevron-up rotate-180":"fas fa-chevron-down"])},null,2),i(" "+l(c.value.has(s.id)?"ย่อ":"ขยาย"),1)],8,Le)]),e("div",qe,[e("span",He," ID: "+l(s.id),1)])]),O(R,{name:"expand"},{default:Q(()=>[c.value.has(s.id)?(n(),r("div",Ge,[s.risks?(n(),r("div",Je,[t[34]||(t[34]=e("div",{class:"flex items-center p-3 bg-red-50 rounded-xl mb-3"},[e("div",{class:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3"},[e("i",{class:"fas fa-exclamation-triangle text-red-600 text-lg"})]),e("div",{class:"font-semibold text-red-800 text-sm"},"ประเด็นที่พบ")],-1)),e("ul",Ke,[(n(!0),r(x,null,p(Array.isArray(s.risks)?s.risks:[],(u,m)=>(n(),r("li",{key:m,class:"flex items-start text-sm text-gray-700 p-2.5 bg-white rounded-lg border border-red-100 hover:shadow-sm transition-shadow"},[t[33]||(t[33]=e("i",{class:"fas fa-circle text-red-400 text-[6px] mt-1.5 mr-3"},null,-1)),e("span",null,l(u),1)]))),128))])])):d("",!0),s.recommendations?(n(),r("div",Oe,[t[36]||(t[36]=e("div",{class:"flex items-center p-3 bg-yellow-50 rounded-xl mb-3"},[e("div",{class:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3"},[e("i",{class:"fas fa-lightbulb text-yellow-600 text-lg"})]),e("div",{class:"font-semibold text-yellow-800 text-sm"},"ข้อเสนอแนะ")],-1)),e("ul",Qe,[(n(!0),r(x,null,p(Array.isArray(s.recommendations)?s.recommendations:[],(u,m)=>(n(),r("li",{key:m,class:"flex items-start text-sm text-gray-700 p-2.5 bg-white rounded-lg border border-yellow-100 hover:shadow-sm transition-shadow"},[t[35]||(t[35]=e("i",{class:"fas fa-circle text-yellow-400 text-[6px] mt-1.5 mr-3"},null,-1)),e("span",null,l(u),1)]))),128))])])):d("",!0),s.follow_up_actions?(n(),r("div",Re,[t[38]||(t[38]=e("div",{class:"flex items-center p-3 bg-indigo-50 rounded-xl mb-3"},[e("div",{class:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center mr-3"},[e("i",{class:"fas fa-tasks text-indigo-600 text-lg"})]),e("div",{class:"font-semibold text-indigo-800 text-sm"},"การติดตามผล")],-1)),e("ul",We,[(n(!0),r(x,null,p(Array.isArray(s.follow_up_actions)?s.follow_up_actions:[],(u,m)=>(n(),r("li",{key:m,class:"flex items-start text-sm text-gray-700 p-2.5 bg-white rounded-lg border border-indigo-100 hover:shadow-sm transition-shadow"},[t[37]||(t[37]=e("i",{class:"fas fa-circle text-indigo-400 text-[6px] mt-1.5 mr-3"},null,-1)),e("span",null,l(u),1)]))),128))])])):d("",!0)])):d("",!0)]),_:2},1024)])])])])],4))),128)),b.value.length?(n(),r("div",Xe,[e("nav",Ye,[e("button",{onClick:L,disabled:g.value===1,class:"px-4 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-indigo-50 hover:text-indigo-600 text-gray-600"},[...t[39]||(t[39]=[e("i",{class:"fas fa-chevron-left mr-2"},null,-1),i(" ก่อนหน้า ",-1)])],8,Ze),e("div",et,[e("span",tt,l(g.value),1),t[40]||(t[40]=e("span",{class:"text-gray-400 mx-1"},"/",-1)),e("span",st,l(_.value),1)]),e("button",{onClick:E,disabled:g.value===_.value,class:"px-4 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 disabled:opacity-40 disabled:cursor-not-allowed hover:bg-indigo-50 hover:text-indigo-600 text-gray-600"},[...t[41]||(t[41]=[i(" ถัดไป ",-1),e("i",{class:"fas fa-chevron-right ml-2"},null,-1)])],8,at)])])):d("",!0)])]))}},ot=J(rt,[["__scopeId","data-v-cbb856c5"]]);export{ot as default};
