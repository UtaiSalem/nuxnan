import{a9 as A,r as _,n as m,p as N,c as i,o as a,a as e,d as y,g as c,b as x,u as d,I as l,t as n,T as V,e as f,j as I,a4 as S}from"./cTealXVQ.js";const T={class:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden border border-gray-200 dark:border-gray-700"},z={class:"px-4 py-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between"},D={class:"flex items-center gap-2"},F={class:"font-semibold text-gray-900 dark:text-white"},L={class:"p-4 space-y-4"},M={class:"flex items-center gap-3"},R={class:"w-12 h-12 rounded-full overflow-hidden bg-gray-200 dark:bg-gray-700 flex items-center justify-center"},q=["src","alt"],E={class:"font-medium text-gray-900 dark:text-white"},O={class:"text-sm text-gray-500 dark:text-gray-400"},U={class:"grid grid-cols-2 gap-4"},W={class:"bg-blue-50 dark:bg-blue-900/30 rounded-lg p-3 text-center"},G={class:"text-lg font-bold text-blue-700 dark:text-blue-300"},H={class:"bg-purple-50 dark:bg-purple-900/30 rounded-lg p-3 text-center"},J={class:"text-lg font-bold text-purple-700 dark:text-purple-300"},K={class:"text-sm space-y-2"},P={class:"flex justify-between"},Q={class:"text-gray-900 dark:text-white"},X={class:"flex justify-between"},Y={class:"text-gray-900 dark:text-white"},Z={class:"flex justify-between"},ee={class:"text-gray-900 dark:text-white"},te={key:0,class:"mt-3"},se=["src"],ae={key:1,class:"mt-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center"},oe={key:2,class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3"},re={class:"text-sm text-gray-900 dark:text-white"},ne={key:0,class:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 flex gap-2"},de=["disabled"],le=["disabled"],ie={class:"relative max-w-4xl max-h-[90vh]"},ce=["src"],ge={__name:"ApproveDonateCard",props:{donate:{type:Object,required:!0}},emits:["approved","rejected"],setup(s,{emit:j}){const v=A(),h=N(),o=s,k=j,r=_(!1),u=_(!1),p=m(()=>o.donate.slip?o.donate.slip.startsWith("http")?o.donate.slip:`${h.public.apiBase}${o.donate.slip}`:null),b=m(()=>{switch(o.donate.status){case 0:return{text:"รออนุมัติ",class:"bg-yellow-100 text-yellow-800",icon:"mdi:clock-outline"};case 1:return{text:"อนุมัติแล้ว",class:"bg-green-100 text-green-800",icon:"mdi:check-circle"};case 2:return{text:"ปฏิเสธ",class:"bg-red-100 text-red-800",icon:"mdi:close-circle"};default:return{text:"ไม่ทราบ",class:"bg-gray-100 text-gray-800",icon:"mdi:help-circle"}}}),C=m(()=>o.donate.donor?.avatar||`${h.public.apiBase}/storage/images/plearnd-logo.png`),$=async()=>{if(!r.value)try{r.value=!0,(await v.patch(`/api/plearnd-admin/supports/donates/${o.donate.id}/recieve`,{})).success&&k("approved",o.donate.id)}catch(g){console.error("Failed to approve donation:",g),alert("ไม่สามารถอนุมัติการสนับสนุนได้")}finally{r.value=!1}},B=async()=>{if(!(r.value||!confirm("คุณแน่ใจหรือไม่ที่จะปฏิเสธการสนับสนุนนี้?")))try{r.value=!0,(await v.patch(`/api/plearnd-admin/supports/donates/${o.donate.id}/reject`,{})).success&&k("rejected",o.donate.id)}catch(t){console.error("Failed to reject donation:",t),alert("ไม่สามารถปฏิเสธการสนับสนุนได้")}finally{r.value=!1}};return(g,t)=>(a(),i("div",T,[e("div",z,[e("div",D,[x(d(l),{icon:"mdi:hand-coin",class:"w-5 h-5 text-purple-500"}),e("span",F,"การสนับสนุน #"+n(s.donate.id),1)]),e("span",{class:V([b.value.class,"px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1"])},[x(d(l),{icon:b.value.icon,class:"w-4 h-4"},null,8,["icon"]),f(" "+n(b.value.text),1)],2)]),e("div",L,[e("div",M,[e("div",R,[e("img",{src:C.value,alt:s.donate.donor_name,class:"w-full h-full object-cover"},null,8,q)]),e("div",null,[e("p",E,n(s.donate.donor_name||"ไม่ประสงค์ออกนาม"),1),e("p",O,n(s.donate.donor?.email||s.donate.donor_email||"-"),1)])]),e("div",U,[e("div",W,[t[4]||(t[4]=e("p",{class:"text-xs text-blue-600 dark:text-blue-400 mb-1"},"จำนวนเงิน",-1)),e("p",G,n(s.donate.amounts),1)]),e("div",H,[t[5]||(t[5]=e("p",{class:"text-xs text-purple-600 dark:text-purple-400 mb-1"},"แต้มทั้งหมด",-1)),e("p",J,n(s.donate.total_points?.toLocaleString()||0),1)])]),e("div",K,[e("div",P,[t[6]||(t[6]=e("span",{class:"text-gray-500 dark:text-gray-400"},"วันที่โอน:",-1)),e("span",Q,n(s.donate.transfer_date||"-"),1)]),e("div",X,[t[7]||(t[7]=e("span",{class:"text-gray-500 dark:text-gray-400"},"เวลา:",-1)),e("span",Y,n(s.donate.transfer_time||"-"),1)]),e("div",Z,[t[8]||(t[8]=e("span",{class:"text-gray-500 dark:text-gray-400"},"สร้างเมื่อ:",-1)),e("span",ee,n(s.donate.diff_humans_created_at),1)])]),p.value?(a(),i("div",te,[e("button",{onClick:t[0]||(t[0]=w=>u.value=!0),class:"w-full border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-2 hover:border-purple-500 transition-colors"},[e("img",{src:p.value,alt:"สลิปโอนเงิน",class:"w-full h-40 object-contain rounded-lg"},null,8,se),t[9]||(t[9]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center"},"คลิกเพื่อดูขนาดใหญ่",-1))])])):(a(),i("div",ae,[x(d(l),{icon:"mdi:image-off",class:"w-8 h-8 text-gray-400 mx-auto"}),t[10]||(t[10]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-2"},"ไม่มีสลิปโอนเงิน",-1))])),s.donate.notes?(a(),i("div",oe,[t[11]||(t[11]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"หมายเหตุ:",-1)),e("p",re,n(s.donate.notes),1)])):y("",!0)]),s.donate.status===0?(a(),i("div",ne,[e("button",{onClick:$,disabled:r.value,class:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-green-300 text-white font-medium rounded-lg transition-colors"},[r.value?(a(),c(d(l),{key:0,icon:"mdi:loading",class:"w-5 h-5 animate-spin"})):(a(),c(d(l),{key:1,icon:"mdi:check",class:"w-5 h-5"})),t[12]||(t[12]=f(" อนุมัติ ",-1))],8,de),e("button",{onClick:B,disabled:r.value,class:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 disabled:bg-red-300 text-white font-medium rounded-lg transition-colors"},[r.value?(a(),c(d(l),{key:0,icon:"mdi:loading",class:"w-5 h-5 animate-spin"})):(a(),c(d(l),{key:1,icon:"mdi:close",class:"w-5 h-5"})),t[13]||(t[13]=f(" ปฏิเสธ ",-1))],8,le)])):y("",!0),(a(),c(S,{to:"body"},[u.value?(a(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 p-4",onClick:t[3]||(t[3]=w=>u.value=!1)},[e("div",ie,[e("button",{onClick:t[1]||(t[1]=w=>u.value=!1),class:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors"},[x(d(l),{icon:"mdi:close",class:"w-8 h-8"})]),e("img",{src:p.value,alt:"สลิปโอนเงิน",class:"max-w-full max-h-[85vh] object-contain rounded-lg",onClick:t[2]||(t[2]=I(()=>{},["stop"]))},null,8,ce)])])):y("",!0)]))]))}};export{ge as _};
