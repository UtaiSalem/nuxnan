import{q as z,r as _,n as j,c as o,o as n,a as e,d as p,b as i,u as d,I as b,T as F,e as D,t as $,j as O,F as E,k as B,a7 as q,a9 as P,a3 as L,g as G,a1 as K,w as J,$ as V,aa as N,ab as Q,f as W,_ as X,K as Z,z as ee,U as R}from"./CHs-R6Sv.js";import{_ as te}from"./oluhtfaa.js";import{_ as Y}from"./DporBo20.js";import{_ as se}from"./CmA_z3zb.js";import{_ as H}from"./CelR1Z2N.js";import{u as ae}from"./CaSR6SuD.js";import{C as re}from"./DEyJstjP.js";import"./B34yIM1Q.js";import"./BQxta0Da.js";const ne={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden mb-6 border border-gray-200 dark:border-gray-700 group"},oe={class:"relative"},le={class:"relative h-32 bg-gradient-to-br from-violet-600 via-indigo-600 to-cyan-600 dark:from-violet-900 dark:via-indigo-900 dark:to-cyan-900 overflow-hidden rounded-t-2xl"},ie={class:"w-full h-full flex items-center justify-center"},de={class:"absolute top-4 left-4 flex flex-wrap gap-2"},ue={key:0,class:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-amber-500/90 backdrop-blur-md text-white text-xs font-bold shadow-lg ring-1 ring-white/20 transition-transform hover:scale-105"},ge={key:0,class:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200"},ce={class:"p-6"},me={class:"mb-4"},be={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2 leading-tight"},ve={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mt-2"},fe={key:0,class:"text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full ml-1"},pe={key:0,class:"mb-6"},xe={key:1,class:"mb-6 p-5 bg-emerald-50 dark:bg-emerald-900/10 rounded-xl border border-emerald-100 dark:border-emerald-700/30"},ye={class:"flex justify-between items-start mb-3"},he={class:"text-sm font-bold text-emerald-900 dark:text-emerald-100 flex items-center gap-2"},ke={key:0,class:"text-sm text-gray-700 dark:text-gray-300 mb-4 leading-relaxed font-sans bg-white dark:bg-gray-800 p-3 rounded-lg border border-gray-100 dark:border-gray-700"},we={key:1,class:"flex flex-wrap gap-3"},$e=["src","onClick"],_e={key:2,class:"mt-4"},Ce={class:"pt-4 border-t border-gray-100 dark:border-gray-700"},Se={key:0,class:"flex items-center justify-between mb-4"},Ae={key:0,class:"flex items-center gap-2"},Ie={key:1},De={key:1,class:"mt-3"},je={class:"flex justify-between items-center mb-1.5"},Te={key:0,class:"ml-1 text-xs font-normal"},Me={key:0,class:"text-emerald-500"},Fe={key:1,class:"text-red-400"},Ge={class:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},Ue={key:2,class:"mt-4"},Ee={key:3,class:"mt-4"},Be=z({__name:"AssignmentCard",props:{assignment:{},isCourseAdmin:{type:Boolean,default:!1},courseId:{}},emits:["edit","delete","click","refresh"],setup(r,{emit:A}){const u=r,y=A;_(!1);const I=h=>h?new Date(h).toLocaleString("th-TH",{dateStyle:"medium",timeStyle:"short"}):"-",k=j(()=>u.assignment.status===1||u.assignment.is_published?{text:"เผยแพร่",color:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400",icon:"fluent:checkmark-circle-16-filled"}:{text:"ร่าง",color:"bg-gray-100 text-gray-700 dark:bg-gray-700/30 dark:text-gray-400",icon:"fluent:drafts-16-regular"}),a=j(()=>u.assignment.due_date?new Date(u.assignment.due_date)<new Date:!1),g=j(()=>u.assignment.answers&&u.assignment.answers.length>0?u.assignment.answers[0]:null),x=j(()=>!!g.value),v=j(()=>g.value?g.value.status:u.assignment.answer_status),S=j(()=>g.value?.content),T=j(()=>g.value?.images||[]);j(()=>v.value==="submitted"||v.value==="graded");const U=h=>{window.open(h.full_url||h.image_url,"_blank")};_(!1);const f=_(!1),c=()=>{f.value=!1,y("refresh")};return(h,m)=>(n(),o("article",ne,[e("div",oe,[e("div",le,[m[6]||(m[6]=e("div",{class:"absolute inset-0 bg-black/10"},null,-1)),e("div",ie,[i(d(b),{icon:"fluent:clipboard-task-24-filled",class:"w-16 h-16 text-white/20 animate-pulse"})])]),e("div",de,[e("span",{class:F(["inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-bold shadow-lg backdrop-blur-md bg-white/90 dark:bg-gray-900/80 ring-1 ring-white/20 transition-transform hover:scale-105",k.value.color])},[i(d(b),{icon:k.value.icon,class:"w-3.5 h-3.5"},null,8,["icon"]),D(" "+$(k.value.text),1)],2),r.assignment.points?(n(),o("span",ue,[i(d(b),{icon:"fluent:star-20-filled",class:"w-3.5 h-3.5"}),D(" "+$(r.assignment.points)+" คะแนน ",1)])):p("",!0)]),r.isCourseAdmin?(n(),o("div",ge,[e("button",{onClick:m[0]||(m[0]=O(t=>y("edit",r.assignment),["stop"])),class:"p-2 bg-white/90 dark:bg-gray-800/90 rounded-lg hover:bg-white dark:hover:bg-gray-800 text-blue-600 shadow-lg backdrop-blur hover:scale-105 transition-all",title:"แก้ไข"},[i(d(b),{icon:"fluent:edit-24-regular",class:"w-5 h-5"})]),e("button",{onClick:m[1]||(m[1]=O(t=>y("delete",r.assignment.id),["stop"])),class:"p-2 bg-white/90 dark:bg-gray-800/90 rounded-lg hover:bg-white dark:hover:bg-gray-800 text-red-600 shadow-lg backdrop-blur hover:scale-105 transition-all",title:"ลบ"},[i(d(b),{icon:"fluent:delete-24-regular",class:"w-5 h-5"})])])):p("",!0)]),e("div",ce,[e("div",me,[e("button",{onClick:m[2]||(m[2]=t=>y("click",r.assignment)),class:"text-left w-full group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors"},[e("h2",be,$(r.assignment.title||r.assignment.name),1)]),e("div",ve,[r.assignment.due_date?(n(),o("div",{key:0,class:F(["flex items-center gap-1.5",a.value?"text-red-500 font-medium":""])},[i(d(b),{icon:"fluent:calendar-clock-24-regular",class:"w-4 h-4"}),e("span",null,"กำหนดส่ง: "+$(I(r.assignment.due_date)),1),a.value?(n(),o("span",fe,"เกินกำหนด")):p("",!0)],2)):p("",!0)])]),r.assignment.description?(n(),o("div",pe,[i(Y,{"model-value":r.assignment.description,disabled:"",class:"!min-h-0"},null,8,["model-value"])])):p("",!0),!r.isCourseAdmin&&v.value==="graded"&&x.value?(n(),o("div",xe,[e("div",ye,[e("h3",he,[i(d(b),{icon:"fluent:person-feedback-24-regular",class:"w-5 h-5 text-emerald-600"}),m[7]||(m[7]=D(" คำตอบของคุณ (ตรวจแล้ว): ",-1))]),e("button",{onClick:m[3]||(m[3]=t=>f.value=!f.value),class:"text-xs font-bold text-emerald-600 hover:text-emerald-700 flex items-center gap-1 px-2 py-1 rounded-lg hover:bg-emerald-100 transition-colors"},[i(d(b),{icon:f.value?"fluent:dismiss-16-regular":"fluent:edit-16-regular",class:"w-4 h-4"},null,8,["icon"]),D(" "+$(f.value?"ยกเลิก":"แก้ไข"),1)])]),S.value&&!f.value?(n(),o("div",ke,[i(te,{content:S.value},null,8,["content"])])):p("",!0),T.value.length&&!f.value?(n(),o("div",we,[(n(!0),o(E,null,B(T.value,t=>(n(),o("div",{key:t.id,class:"group relative w-24 h-24 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-600 shadow-sm hover:shadow-md transition-all"},[e("img",{src:t.full_url||t.image_url,class:"w-full h-full object-cover cursor-zoom-in group-hover:scale-110 transition-transform duration-500",onClick:s=>U(t)},null,8,$e)]))),128))])):p("",!0),f.value?(n(),o("div",_e,[i(H,{assignment:r.assignment,courseId:r.courseId,"is-editing":!0,"existing-answer":g.value,"show-cancel":!0,onSubmitted:c,onCancel:m[4]||(m[4]=t=>f.value=!1)},null,8,["assignment","courseId","existing-answer"])])):p("",!0)])):p("",!0),e("div",Ce,[v.value||!r.isCourseAdmin&&x.value?(n(),o("div",Se,[v.value?(n(),o("div",Ae,[m[8]||(m[8]=e("span",{class:"text-sm font-medium text-gray-500"},"สถานะ:",-1)),e("span",{class:F(["px-3 py-1 rounded-full text-xs font-bold border flex items-center gap-1.5",v.value==="submitted"||v.value==="graded"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-orange-50 text-orange-500 border-orange-100"])},[i(d(b),{icon:v.value==="submitted"||v.value==="graded"?"fluent:checkmark-circle-16-filled":"fluent:circle-16-regular"},null,8,["icon"]),D(" "+$(v.value==="submitted"||v.value==="graded"?"ส่งแล้ว":"ยังไม่ส่ง"),1)],2)])):(n(),o("div",Ie))])):p("",!0),!r.isCourseAdmin&&v.value==="graded"&&x.value?(n(),o("div",De,[e("div",je,[m[9]||(m[9]=e("span",{class:"text-xs font-medium text-gray-500 dark:text-gray-400"},"คะแนน",-1)),e("span",{class:F(["text-sm font-bold",(g.value?.points||0)>=(r.assignment.passing_score||0)?"text-emerald-600":"text-red-500"])},[D($(g.value?.points||0)+" / "+$(r.assignment.points)+" ",1),r.assignment.passing_score?(n(),o("span",Te,[(g.value?.points||0)>=r.assignment.passing_score?(n(),o("span",Me,"✓ ผ่าน")):(n(),o("span",Fe,"✗ ไม่ผ่าน"))])):p("",!0)],2)]),e("div",Ge,[e("div",{class:F(["h-full rounded-full transition-all duration-500",(g.value?.points||0)>=(r.assignment.passing_score||0)?"bg-gradient-to-r from-emerald-400 to-emerald-600":"bg-gradient-to-r from-red-400 to-red-600"]),style:q({width:`${(g.value?.points||0)/(r.assignment.points||1)*100}%`})},null,6)])])):p("",!0),r.isCourseAdmin?(n(),o("div",Ue,[i(se,{assignment:r.assignment,courseId:r.courseId},null,8,["assignment","courseId"])])):p("",!0),!r.isCourseAdmin&&v.value!=="graded"?(n(),o("div",Ee,[i(H,{assignment:r.assignment,courseId:r.courseId,"is-editing":x.value,"existing-answer":g.value,"show-cancel":!1,onSubmitted:m[5]||(m[5]=t=>y("refresh"))},null,8,["assignment","courseId","is-editing","existing-answer"])])):p("",!0)])])]))}}),Ve={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},ze={class:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"},Le={class:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center sticky top-0 bg-white dark:bg-gray-800 z-10"},Ne={class:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2"},Pe={class:"p-6 space-y-6"},Oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Re={class:"col-span-1 md:col-span-2"},He={class:"grid grid-cols-2 gap-4"},Ye={class:"relative"},qe={class:"relative"},Ke=["max"],Je={class:"relative"},Qe={key:0},We={class:"flex flex-wrap gap-3"},Xe=["onClick"],Ze={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},et=["src"],tt=["onClick"],st=["src"],at={class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center"},rt=["onClick"],nt={class:"aspect-video flex flex-col items-center justify-center border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg cursor-pointer hover:border-green-500 hover:text-green-500 transition-colors bg-gray-50 dark:bg-gray-700/50 hover:bg-green-50 dark:hover:bg-green-900/10"},ot={class:"p-6 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3 bg-gray-50 dark:bg-gray-800/50 rounded-b-2xl sticky bottom-0 z-10"},lt=["disabled"],it={key:1},dt=z({__name:"CourseAssignmentFormModal",props:{show:{type:Boolean},courseId:{},assignment:{},availableGroups:{}},emits:["close","submit"],setup(r,{emit:A}){const u=r,y=A,I=P(),k=ae(),a=_({title:"",description:"",points:10,passing_score:0,start_date:"",due_date:"",status:"1",target_groups:[],images:[],existingImages:[]}),g=_(!1),x=_([]),v=()=>{const t=new Date,s=t.getFullYear(),w=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),C=String(t.getHours()).padStart(2,"0"),M=String(t.getMinutes()).padStart(2,"0");return`${s}-${w}-${l}T${C}:${M}`},S=()=>{const t=new Date;t.setDate(t.getDate()+1);const s=t.getFullYear(),w=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),C=String(t.getHours()).padStart(2,"0"),M=String(t.getMinutes()).padStart(2,"0");return`${s}-${w}-${l}T${C}:${M}`},T=()=>{a.value={title:"",description:"",points:10,passing_score:5,start_date:v(),due_date:S(),status:"1",target_groups:[],images:[],existingImages:[]},x.value=[]};L(()=>u.assignment,t=>{t?a.value={title:t.title,description:t.description||"",points:t.points||10,passing_score:t.passing_score||0,start_date:t.start_date?new Date(t.start_date):"",due_date:t.due_date?new Date(t.due_date):"",status:String(t.status??"1"),target_groups:t.target_groups||[],images:[],existingImages:t.images||[]}:T()},{immediate:!0}),L(()=>a.value.points,t=>{u.assignment||(a.value.passing_score=Math.floor(t/2))});const U=t=>{const s=t.target;if(s.files){const w=Array.from(s.files);a.value.images=[...a.value.images,...w],w.forEach(l=>{const C=new FileReader;C.onload=M=>{M.target?.result&&x.value.push(M.target.result)},C.readAsDataURL(l)})}},f=t=>{a.value.images.splice(t,1),x.value.splice(t,1)},c=t=>{a.value.existingImages=a.value.existingImages.filter(s=>s.id!==t)},h=t=>{const s=a.value.target_groups.indexOf(t);s===-1?a.value.target_groups.push(t):a.value.target_groups.splice(s,1)},m=async()=>{if(!a.value.title){k.toast("กรุณาระบุหัวข้อแบบฝึกหัด","warning");return}g.value=!0;try{const t=new FormData;t.append("title",a.value.title),a.value.description&&t.append("description",a.value.description),t.append("points",a.value.points.toString()),t.append("passing_score",a.value.passing_score.toString()),t.append("status",a.value.status.toString()),a.value.start_date&&t.append("start_date",new Date(a.value.start_date).toISOString()),a.value.due_date&&t.append("due_date",new Date(a.value.due_date).toISOString()),a.value.target_groups&&a.value.target_groups.length>0&&a.value.target_groups.forEach((w,l)=>{t.append(`target_groups[${l}]`,w.toString())}),a.value.images.forEach(w=>{t.append("images[]",w)});let s;u.assignment?(t.append("_method","PUT"),s=await I.post(`/api/courses/${u.courseId}/assignments/${u.assignment.id}`,t)):s=await I.post(`/api/courses/${u.courseId}/assignments`,t),s.assignment&&(y("submit",s.assignment),k.toast(u.assignment?"แก้ไขแบบฝึกหัดสำเร็จ":"สร้างแบบฝึกหัดสำเร็จ","success"),y("close"))}catch(t){console.error("Failed to save assignment:",t),k.error(t?.data?.message||"ไม่สามารถบันทึกข้อมูลได้")}finally{g.value=!1}};return L(()=>u.show,t=>{t&&!u.assignment&&T()}),(t,s)=>{const w=W("VueDatePicker");return n(),G(K,{name:"fade"},{default:J(()=>[r.show?(n(),o("div",Ve,[e("div",ze,[e("div",Le,[e("h3",Ne,[i(d(b),{icon:"fluent:clipboard-task-edit-24-filled",class:"text-green-600"}),D(" "+$(r.assignment?"แก้ไขแบบฝึกหัด":"สร้างแบบฝึกหัดใหม่"),1)]),e("button",{onClick:s[0]||(s[0]=l=>y("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors"},[i(d(b),{icon:"fluent:dismiss-24-regular",class:"w-6 h-6 text-gray-500"})])]),e("div",Pe,[e("div",Oe,[e("div",Re,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[D(" หัวข้อแบบฝึกหัด "),e("span",{class:"text-red-500"},"*")],-1)),V(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>a.value.title=l),type:"text",class:"w-full px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all",placeholder:"Ex. แบบฝึกหัดทบทวนบทที่ 1"},null,512),[[N,a.value.title]])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," สถานะ ",-1)),V(e("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>a.value.status=l),class:"w-full px-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all appearance-none"},[...s[10]||(s[10]=[e("option",{value:"1"},"เผยแพร่ (Published)",-1),e("option",{value:"0"},"ฉบับร่าง (Draft)",-1)])],512),[[Q,a.value.status]])]),e("div",He,[e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," คะแนนเต็ม ",-1)),e("div",Ye,[V(e("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>a.value.points=l),type:"number",min:"0",class:"w-full px-4 py-2 pl-10 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all"},null,512),[[N,a.value.points]]),i(d(b),{icon:"fluent:star-24-regular",class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," เกณฑ์ผ่าน ",-1)),e("div",qe,[V(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>a.value.passing_score=l),type:"number",min:"0",max:a.value.points,class:"w-full px-4 py-2 pl-10 rounded-xl border border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-700 focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition-all"},null,8,Ke),[[N,a.value.passing_score]]),i(d(b),{icon:"fluent:checkmark-circle-24-regular",class:"absolute left-3 top-2.5 w-5 h-5 text-gray-400"})])])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," วันที่เริ่มต้น (Start Date) ",-1)),e("div",Je,[i(w,{modelValue:a.value.start_date,"onUpdate:modelValue":s[5]||(s[5]=l=>a.value.start_date=l),"auto-apply":"","enable-time-picker":!0,dark:!0},null,8,["modelValue"])])]),e("div",null,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," กำหนดส่ง (Due Date) ",-1)),i(w,{modelValue:a.value.due_date,"onUpdate:modelValue":s[6]||(s[6]=l=>a.value.due_date=l),"auto-apply":"","enable-time-picker":!0,dark:!0},null,8,["modelValue"])])]),e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," คำอธิบาย / โจทย์ ",-1)),i(Y,{modelValue:a.value.description,"onUpdate:modelValue":s[7]||(s[7]=l=>a.value.description=l),placeholder:"ระบุรายละเอียดของงาน...",class:"min-h-[200px]"},null,8,["modelValue"])]),r.availableGroups&&r.availableGroups.length>0?(n(),o("div",Qe,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," มอบหมายให้กลุ่มเรียน (Target Groups) ",-1)),e("div",We,[(n(!0),o(E,null,B(r.availableGroups,l=>(n(),o("button",{key:l.id,type:"button",onClick:C=>h(l.id),class:F(["flex items-center gap-2 px-4 py-2 rounded-lg border transition-all duration-200",[a.value.target_groups.includes(l.id)?"bg-green-50 border-green-500 text-green-700 dark:bg-green-900/30 dark:border-green-500 dark:text-green-400":"bg-gray-50 border-gray-200 text-gray-600 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-400 hover:border-gray-300 dark:hover:border-gray-500"]])},[e("div",{class:F(["w-5 h-5 rounded border flex items-center justify-center transition-colors",[a.value.target_groups.includes(l.id)?"bg-green-500 border-green-500":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-500"]])},[a.value.target_groups.includes(l.id)?(n(),G(d(b),{key:0,icon:"fluent:checkmark-12-filled",class:"w-3 h-3 text-white"})):p("",!0)],2),e("span",null,$(l.name),1)],10,Xe))),128))]),s[18]||(s[18]=e("p",{class:"text-xs text-gray-500 mt-2"},"* หากไม่เลือกกลุ่มเรียนใดๆ งานจะถูกมอบหมายให้นักเรียนทุกคนในรายวิชา",-1))])):p("",!0),e("div",null,[s[20]||(s[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," รูปภาพประกอบ ",-1)),e("div",Ze,[(n(!0),o(E,null,B(a.value.existingImages,l=>(n(),o("div",{key:l.id,class:"relative group aspect-video bg-gray-100 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},[e("img",{src:l.full_url||l.image_url,class:"w-full h-full object-cover"},null,8,et),e("button",{onClick:C=>c(l.id),class:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600"},[i(d(b),{icon:"fluent:delete-16-filled",class:"w-4 h-4"})],8,tt)]))),128)),(n(!0),o(E,null,B(x.value,(l,C)=>(n(),o("div",{key:C,class:"relative group aspect-video bg-gray-100 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700"},[e("img",{src:l,class:"w-full h-full object-cover"},null,8,st),e("div",at,[e("button",{onClick:M=>f(C),class:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors"},[i(d(b),{icon:"fluent:delete-20-filled",class:"w-5 h-5"})],8,rt)])]))),128)),e("label",nt,[i(d(b),{icon:"fluent:image-add-24-regular",class:"w-8 h-8 mb-2"}),s[19]||(s[19]=e("span",{class:"text-xs font-medium"},"เพิ่มรูปภาพ",-1)),e("input",{type:"file",multiple:"",accept:"image/*",class:"hidden",onChange:U},null,32)])])])]),e("div",ot,[e("button",{onClick:s[8]||(s[8]=l=>y("close")),class:"px-5 py-2.5 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl transition-colors"}," ยกเลิก "),e("button",{onClick:m,disabled:g.value,class:"px-5 py-2.5 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-medium rounded-xl shadow-lg shadow-green-500/30 hover:shadow-green-500/40 hover:from-green-600 hover:to-emerald-700 active:scale-[0.98] transition-all flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"},[g.value?(n(),G(d(b),{key:0,icon:"eos-icons:loading",class:"w-5 h-5"})):(n(),o("span",it,$(r.assignment?"บันทึกการแก้ไข":"สร้างแบบฝึกหัด"),1))],8,lt)])])])):p("",!0)]),_:1})}}}),ut=X(dt,[["__scopeId","data-v-a24a25fe"]]),gt={class:"space-y-4"},ct={key:0,class:"bg-gradient-to-r from-violet-600 via-indigo-600 to-cyan-600 dark:from-violet-900 dark:via-indigo-900 dark:to-cyan-900 rounded-2xl p-6 shadow-xl mb-6 text-white"},mt={class:"flex items-center justify-between"},bt={class:"flex items-center gap-4"},vt={class:"w-14 h-14 rounded-xl bg-white/20 backdrop-blur-sm flex items-center justify-center shadow-lg"},ft={class:"text-white/80 text-sm"},pt={key:1,class:"space-y-3"},xt={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-12 text-center border border-gray-100 dark:border-gray-700"},yt={class:"w-24 h-24 bg-gray-50 dark:bg-gray-700/50 rounded-full flex items-center justify-center mx-auto mb-6"},ht={class:"text-gray-500 dark:text-gray-400 mb-8 max-w-xs mx-auto"},kt=z({__name:"AssignmentsList",props:{assignments:{default:()=>[]},isCourseAdmin:{type:Boolean,default:!1},courseId:{},availableGroups:{default:()=>[]}},emits:["refresh"],setup(r,{emit:A}){const u=r,y=A,I=P(),k=_(!1),a=_(!1),g=_(null),x=(f=null)=>{g.value=f,a.value=!0},v=()=>{y("refresh"),a.value=!1},S=f=>{Z(`/courses/${u.courseId}/assignments/${f.id}`)},T=f=>{x(f)},U=async f=>{if(confirm("ยืนยันการลบภาระงานนี้หรือไม่?")){k.value=!0;try{await I.delete(`/api/courses/${u.courseId}/assignments/${f}`)&&y("refresh")}catch(c){alert(c.data?.msg||"ไม่สามารถลบภาระงานได้")}finally{k.value=!1}}};return(f,c)=>(n(),o("div",gt,[r.isCourseAdmin?(n(),o("div",ct,[e("div",mt,[e("div",bt,[e("div",vt,[i(d(b),{icon:"material-symbols:assignment-outline",class:"w-7 h-7 text-white"})]),e("div",null,[c[4]||(c[4]=e("h2",{class:"text-2xl font-bold mb-1"},"ภาระงานทั้งหมด",-1)),e("p",ft,$(r.assignments.length)+" งาน",1)])]),r.isCourseAdmin?(n(),o("button",{key:0,onClick:c[0]||(c[0]=h=>x(null)),class:"flex items-center gap-2 px-5 py-3 bg-white/10 text-white rounded-xl hover:bg-white/20 border border-white/20 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 font-bold backdrop-blur-sm"},[i(d(b),{icon:"fluent:add-circle-24-filled",class:"w-5 h-5"}),c[5]||(c[5]=e("span",null,"สร้างงานใหม่",-1))])):p("",!0)])])):p("",!0),r.assignments.length>0?(n(),o("div",pt,[(n(!0),o(E,null,B(r.assignments,h=>(n(),G(Be,{key:h.id,assignment:h,"course-id":r.courseId,"is-course-admin":r.isCourseAdmin,onClick:S,onEdit:T,onDelete:U,onRefresh:c[1]||(c[1]=m=>y("refresh"))},null,8,["assignment","course-id","is-course-admin"]))),128))])):(n(),o("div",xt,[e("div",yt,[i(d(b),{icon:"fluent:clipboard-task-24-regular",class:"w-12 h-12 text-gray-400"})]),c[7]||(c[7]=e("h3",{class:"text-xl font-bold text-gray-900 dark:text-white mb-2"},"ยังไม่มีภาระงาน",-1)),e("p",ht,$(r.isCourseAdmin?"เริ่มต้นสร้างภาระงานให้นักเรียนของคุณ":"อาจารย์ยังไม่ได้มอบหมายงานในขณะนี้"),1),r.isCourseAdmin?(n(),o("button",{key:0,onClick:c[2]||(c[2]=h=>x(null)),class:"inline-flex items-center gap-2 px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-all shadow-lg hover:shadow-orange-500/30 font-semibold"},[i(d(b),{icon:"fluent:add-24-filled",class:"w-5 h-5"}),c[6]||(c[6]=D(" สร้างภาระงานแรก ",-1))])):p("",!0)])),i(ut,{show:a.value,assignment:g.value,"course-id":r.courseId,"available-groups":r.availableGroups,onClose:c[3]||(c[3]=h=>a.value=!1),onSubmit:v},null,8,["show","assignment","course-id","available-groups"])]))}}),Tt=z({__name:"index",setup(r){const A=R("course"),u=R("isCourseAdmin"),y=P(),I=_([]),k=_([]),a=_(!0),g=async()=>{if(A.value?.id){a.value=!0;try{const x=A.value.id,v=await y.get(`/api/courses/${x}/assignments`),S=v.assignments||[];I.value=Array.isArray(S)?S:S.data||[],k.value=v.groups||[]}catch(x){console.error("Failed to load assignments:",x)}finally{a.value=!1}}};return ee(()=>{g()}),(x,v)=>(n(),o("div",null,[d(a)?(n(),G(re,{key:0})):(n(),G(kt,{key:1,assignments:d(I),"available-groups":d(k),"course-id":d(A)?.id,"is-course-admin":d(u),onRefresh:g},null,8,["assignments","available-groups","course-id","is-course-admin"]))]))}});export{Tt as default};
