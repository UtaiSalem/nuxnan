import{r as s,n,g as w,o as p,w as m,a as r,c as $,d as I,S as L,b as g}from"./cTealXVQ.js";import{S as c}from"./BQxta0Da.js";import R from"./Dtfmjnau.js";import{_ as T}from"./kD1PCJ5t.js";import{_ as x}from"./DHU2WLsk.js";import"./ChBnuzYQ.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./CYLt1a9j.js";import"./srasqk13.js";import"./BZ03tRGr.js";const B={class:"mt-4"},D={key:0},E={__name:"AcademyLayout",props:{academy:Object,isAcademyAdmin:Boolean},setup(i){const t=i;s(!1),s([]);const d=n(()=>t.academy?.data||t.academy||{}),y=n(()=>{const e=d.value.logo;return e?"/storage/images/academies/logos/"+e:"/storage/images/academies/logos/default_logo.png"}),v=n(()=>{const e=d.value.cover;return e?"/storage/images/academies/covers/"+e:"/storage/images/academies/covers/default_cover.png"}),l=s(d.value.name||""),u=s(d.value.slogan||"");async function b(e){const a=new FormData;a.append("cover",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function f(e){const a=new FormData;a.append("logo",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function S(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{name:e})}async function C(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{slogan:e})}async function h(){try{let e=await axios.post(`/academies/${t.academy.data.id}/members`);e.data&&e.data.success?(t.academy.data.memberStatus=e.data.memberStatus,t.academy.data.total_students=e.data.totalStudents,e.data&&e.data.success&&(t.academy.data.memberStatus=e.data.memberStatus,c.fire("เสร็จสิ้น","ขอเป็นสมาชิกเรียบร้อยแล้ว","success"))):e.data&&!e.data.success&&c.fire("เกิดข้อผิดพลาด",e.data.msg,"error")}catch(e){console.log(e)}}async function A(){console.log("unmember");try{let e=await axios.post(`/academies/${t.academy.data.id}/unmembers`);e.data&&e.data.success&&(t.academy.data.memberStatus==2&&t.academy.data.total_students--,t.academy.data.memberStatus=null,c.fire("เสร็จสิ้น","ออกจากการเป็นสมาชิกเรียบร้อยแล้ว","success"))}catch(e){console.log(e)}}return(e,a)=>(p(),w(R,{title:d.value.name||"Academy"},{coverProfileCard:m(()=>[g(T,{coverImage:v.value,logoImage:y.value,coverHeader:l.value,"onUpdate:coverHeader":a[0]||(a[0]=o=>l.value=o),coverSubheader:u.value,"onUpdate:coverSubheader":a[1]||(a[1]=o=>u.value=o),model:"Academy",modelTable:"academies",modelableId:d.value.id,modelableType:"app/models/Academy",modelableRoute:`/academies/${d.value.id}`,modelData:d.value,subModelDataLength:d.value.courses_offered,subModelNameTh:"รายวิชา",isAcademyAdmin:t.isAcademyAdmin,onCoverImageChange:a[2]||(a[2]=o=>{b(o)}),onLogoImageChange:a[3]||(a[3]=o=>{f(o)}),onHeaderChange:a[4]||(a[4]=o=>{S(o)}),onSubheaderChange:a[5]||(a[5]=o=>{C(o)}),onRequestTobeMember:h,onRequestTobeUnmember:A},null,8,["coverImage","logoImage","coverHeader","coverSubheader","modelableId","modelableRoute","modelData","subModelDataLength","isAcademyAdmin"]),g(x,{academy:i.academy,activeTab:0},null,8,["academy"])]),leftSideWidget:m(()=>[...a[6]||(a[6]=[r("div",{class:"space-y-4"},null,-1)])]),mainContent:m(()=>[r("div",B,[e.$slots.academyContent?(p(),$("div",D,[L(e.$slots,"academyContent")])):I("",!0)])]),rightSideWidget:m(()=>[...a[7]||(a[7]=[r("div",null,null,-1)])]),_:3},8,["title"]))}};export{E as default};
