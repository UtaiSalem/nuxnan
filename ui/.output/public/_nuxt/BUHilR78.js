import{q as ie,ay as ne,a9 as de,r as b,V as A,z as ue,n as ce,c,a as t,d as D,u as r,b as g,t as _,$ as m,T as F,e as k,a0 as K,aa as $,ai as G,F as P,k as E,g as J,f as ge,o as u,K as pe,I as p}from"./cTealXVQ.js";import{S as h}from"./BQxta0Da.js";const fe={class:"container mx-auto px-4 py-6 max-w-4xl"},be={class:"flex items-center gap-4 mb-6"},xe={class:"text-sm text-gray-500"},me={key:0,class:"flex justify-center p-12"},ye={key:1,class:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},ve={class:"flex border-b border-gray-200 dark:border-gray-700"},ke={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-purple-600 dark:bg-purple-400"},_e={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-purple-600 dark:bg-purple-400"},he={class:"p-6 space-y-6"},we={class:"grid gap-6"},Ce={class:"grid md:grid-cols-2 gap-6"},$e={class:"space-y-4"},qe={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},Ve={class:"relative"},ze={class:"space-y-4"},Ue={class:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},Me={class:"flex flex-col sm:flex-row gap-6"},je={class:"flex items-center gap-3 cursor-pointer group"},Oe={class:"relative flex items-center"},De={class:"flex items-center gap-3 cursor-pointer group"},Fe={class:"relative flex items-center"},Qe={class:"flex justify-end gap-3 pt-4"},Be=["disabled"],Te=["disabled"],Ie={key:0},Se={key:1},Pe={class:"p-6"},Ee={class:"flex justify-between items-center mb-6"},Le={key:0,class:"text-center py-12 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-xl"},Re={key:1,class:"space-y-4"},He={class:"flex items-start justify-between gap-4"},Ne={class:"flex gap-3"},Ae={class:"w-8 h-8 rounded-full bg-white dark:bg-gray-800 flex items-center justify-center font-bold text-gray-500 text-sm shadow-sm"},Ke={class:"font-medium text-gray-900 dark:text-white mb-2"},Ge={class:"space-y-1"},Je={class:"flex items-center gap-1"},We={class:"text-xs font-bold px-2 py-1 bg-blue-100 dark:bg-blue-900/30 rounded text-blue-600 dark:text-blue-300 mr-1"},Xe={class:"text-xs font-bold px-2 py-1 bg-orange-100 dark:bg-orange-900/30 rounded text-orange-600 dark:text-orange-300 mr-2"},Ye=["onClick"],Ze=["onClick"],et={key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm"},tt={class:"bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-2xl overflow-hidden max-h-[90vh] flex flex-col"},rt={class:"p-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center"},st={class:"font-bold text-lg text-gray-900 dark:text-white"},at={class:"p-6 overflow-y-auto flex-1 space-y-6"},ot={class:"mt-3"},lt={key:0,class:"relative inline-block mb-2"},it=["src"],nt={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors w-fit"},dt={class:"grid grid-cols-2 gap-4"},ut={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},ct={class:"flex items-center justify-between mb-2"},gt={class:"space-y-3"},pt={class:"flex items-start gap-3"},ft=["onClick"],bt={class:"flex-1 space-y-2"},xt=["onUpdate:modelValue","placeholder"],mt={class:"flex items-center gap-2"},yt={key:0,class:"relative inline-block"},vt=["src","alt"],kt=["onClick"],_t={key:1,class:"flex items-center gap-1 px-2 py-1 bg-gray-100 dark:bg-gray-600 text-gray-500 dark:text-gray-400 rounded cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors text-xs"},ht=["onChange"],wt=["onClick"],Ct={class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},$t={class:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50 flex justify-end gap-3"},qt=["disabled"],Vt=["disabled"],jt=ie({__name:"edit",setup(zt){const L=ne(),V=L.params.id,z=L.params.quizId,y=de(),w=b("settings"),I=b(!1),U=b(!1),B=b([]),l=A({title:"",description:"",start_date:new Date,end_date:new Date,time_limit:60,passing_score:50,is_active:!0,shuffle_questions:!1}),x=b(null),T=b([]),Q=async()=>{I.value=!0;try{const a=await y.get(`/api/courses/${V}/quizzes/${z}`);x.value=a.quiz,l.title=x.value.title,l.description=x.value.description,l.start_date=new Date(x.value.start_date),l.end_date=new Date(x.value.end_date),l.time_limit=x.value.time_limit,l.passing_score=x.value.passing_score,l.is_active=!!x.value.is_active,l.shuffle_questions=!!x.value.shuffle_questions,T.value=x.value.questions||[]}catch(a){console.error(a),h.fire("Error","Failed to load quiz data","error")}finally{I.value=!1}};ue(()=>{Q()});const R=ce(()=>l.title.trim()!==""&&l.time_limit>0&&l.passing_score>=0&&l.passing_score<=100&&(!l.start_date||!l.end_date||new Date(l.end_date)>new Date(l.start_date))),W=async()=>{if(!(!R.value||U.value)){U.value=!0,B.value=[];try{const a={title:l.title,description:l.description,time_limit:l.time_limit,passing_score:l.passing_score,is_active:l.is_active,shuffle_questions:l.shuffle_questions,start_date:l.start_date,end_date:l.end_date},e=await y.put(`/api/courses/${V}/quizzes/${z}`,a);x.value=e.quiz||e.data?.quiz,h.fire({icon:"success",title:"บันทึกสำเร็จ",timer:1500,showConfirmButton:!1})}catch(a){console.error(a),a.data?.errors?B.value=Object.values(a.data.errors).flat():B.value=["เกิดข้อผิดพลาดในการบันทึก"],h.fire({icon:"error",title:"เกิดข้อผิดพลาด",text:B.value[0]})}finally{U.value=!1}}},q=b(!1),C=b(null),M=b(!1),j=b(null),O=b(null),f=b({}),v=b({}),i=A({text:"",points:1,pp_fine:0,media_url:null,options:[{text:"",is_correct:!1,media_url:null},{text:"",is_correct:!1,media_url:null}]}),X=a=>{const d=a.target.files?.[0];d&&(j.value=d,O.value=URL.createObjectURL(d))},Y=()=>{j.value=null,O.value=null,i.media_url=null},Z=(a,e)=>{const s=a.target.files?.[0];s&&(f.value[e]=s,v.value[e]=URL.createObjectURL(s))},ee=a=>{f.value[a]=null,v.value[a]=null,i.options[a].media_url=null},te=()=>{i.options.push({text:"",is_correct:!1,media_url:null})},re=a=>{if(i.options.length>2){i.options.splice(a,1),delete f.value[a],delete v.value[a];const e={},d={};Object.keys(f.value).forEach(s=>{const o=parseInt(s);o>a?(e[o-1]=f.value[o],d[o-1]=v.value[o]):(e[o]=f.value[o],d[o]=v.value[o])}),f.value=e,v.value=d}},H=()=>{C.value=null,i.text="",i.points=1,i.pp_fine=0,i.media_url=null,i.options=[{text:"",is_correct:!1,media_url:null},{text:"",is_correct:!1,media_url:null}],j.value=null,O.value=null,f.value={},v.value={},q.value=!0},se=a=>{C.value=a,i.text=a.text,i.points=a.points,i.pp_fine=a.pp_fine||0,i.media_url=a.media_url||null,j.value=null,O.value=a.media_url||null,f.value={},v.value={},a.options&&a.options.length?i.options=a.options.map((e,d)=>(e.media_url&&(v.value[d]=e.media_url),{id:e.id,text:e.text,is_correct:!!e.is_correct,media_url:e.media_url||null})):i.options=[{text:"",is_correct:!1,media_url:null},{text:"",is_correct:!1,media_url:null}],q.value=!0},ae=a=>{i.options[a].is_correct=!i.options[a].is_correct},S=async a=>{try{const e=new FormData;e.append("file",a);const d=await y.post("/api/upload/media",e);return d.url||d.data?.url||null}catch(e){return console.error("Upload failed",e),null}},oe=async()=>{if(!i.text||!i.options.some(a=>a.is_correct)){h.fire("กรุณากรอกข้อมูล","ต้องมีคำถามและเฉลยอย่างน้อย 1 ข้อ","warning");return}M.value=!0;try{let a=i.media_url;if(j.value&&(a=await S(j.value)),C.value){const e=C.value.id;await y.patch(`/api/courses/${V}/quizzes/${z}/questions/${e}`,{text:i.text,points:i.points,pp_fine:i.pp_fine,media_url:a});const d=i.options.filter(s=>s.text.trim()!=="");if(C.value.options){const s=d.filter(o=>o.id).map(o=>o.id);for(const o of C.value.options)if(!s.includes(o.id))try{await y.delete(`/api/questions/${e}/options/${o.id}`)}catch(n){console.error("Failed to delete option",n)}}for(let s=0;s<d.length;s++){const o=d[s];let n=o.media_url;f.value[s]&&(n=await S(f.value[s])),o.id?await y.patch(`/api/questions/${e}/options/${o.id}`,{text:o.text,is_correct:o.is_correct?1:0,media_url:n}):await y.post(`/api/questions/${e}/options`,{text:o.text,is_correct:o.is_correct?1:0,media_url:n})}await Q(),q.value=!1,C.value=null,h.fire("Success","แก้ไขคำถามเรียบร้อย","success")}else{const e=await y.post(`/api/courses/${V}/quizzes/${z}/questions`,{text:i.text,points:i.points,pp_fine:i.pp_fine,media_url:a});if(e.success&&e.question){const d=e.question,s=i.options.filter(o=>o.text.trim()!=="");for(let o=0;o<s.length;o++){const n=s[o];let N=n.media_url;f.value[o]&&(N=await S(f.value[o])),await y.post(`/api/questions/${d.id}/options`,{text:n.text,is_correct:n.is_correct?1:0,media_url:N})}await Q(),q.value=!1,h.fire("Success","เพิ่มคำถามเรียบร้อย","success")}}}catch(a){console.error(a),h.fire("Error","ไม่สามารถบันทึกคำถามได้","error")}finally{M.value=!1}},le=async a=>{if((await h.fire({title:"ยืนยันการลบ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"})).isConfirmed)try{await y.delete(`/api/courses/${V}/quizzes/${z}/questions/${a}`),await Q()}catch{try{await y.delete(`/api/questions/${a}`),await Q()}catch{h.fire("Error","ลบไม่สำเร็จ","error")}}};return(a,e)=>{const d=ge("VueDatePicker");return u(),c("div",fe,[t("div",be,[t("button",{onClick:e[0]||(e[0]=s=>("navigateTo"in a?a.navigateTo:r(pe))(`/courses/${r(V)}/quizzes/${r(z)}`)),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-500 transition-colors"},[g(r(p),{icon:"fluent:arrow-left-24-regular",class:"w-6 h-6"})]),t("div",null,[e[17]||(e[17]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"แก้ไขแบบทดสอบ",-1)),t("p",xe,_(r(x)?.title),1)])]),r(I)?(u(),c("div",me,[g(r(p),{icon:"svg-spinners:3-dots-fade",class:"w-10 h-10 text-gray-400"})])):(u(),c("div",ye,[t("div",ve,[t("button",{onClick:e[1]||(e[1]=s=>w.value="settings"),class:F(["px-6 py-3 font-medium text-sm focus:outline-none transition-colors relative",r(w)==="settings"?"text-purple-600 dark:text-purple-400":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"])},[e[18]||(e[18]=k(" ตั้งค่าทั่วไป ",-1)),r(w)==="settings"?(u(),c("div",ke)):D("",!0)],2),t("button",{onClick:e[2]||(e[2]=s=>w.value="questions"),class:F(["px-6 py-3 font-medium text-sm focus:outline-none transition-colors relative",r(w)==="questions"?"text-purple-600 dark:text-purple-400":"text-gray-500 hover:text-gray-900 dark:hover:text-gray-300"])},[k(" ข้อสอบ ("+_(r(T).length)+") ",1),r(w)==="questions"?(u(),c("div",_e)):D("",!0)],2)]),m(t("div",he,[t("div",we,[t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[k("ชื่อแบบทดสอบ "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>r(l).title=s),type:"text",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[$,r(l).title]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"คำอธิบาย",-1)),m(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=s=>r(l).description=s),rows:"3",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[$,r(l).description]])])]),e[32]||(e[32]=t("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),t("div",Ce,[t("div",$e,[t("h3",qe,[g(r(p),{icon:"fluent:timer-24-regular",class:"w-5 h-5 text-gray-400"}),e[21]||(e[21]=k(" การตั้งค่าเวลาและคะแนน ",-1))]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[k("เวลา (นาที) "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>r(l).time_limit=s),type:"number",min:"1",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[$,r(l).time_limit,void 0,{number:!0}]])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},[k("เกณฑ์ผ่าน (%) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",Ve,[m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>r(l).passing_score=s),type:"number",min:"0",max:"100",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent pr-8"},null,512),[[$,r(l).passing_score,void 0,{number:!0}]]),e[23]||(e[23]=t("span",{class:"absolute right-3 top-2.5 text-gray-500"},"%",-1))])])]),t("div",ze,[t("h3",Ue,[g(r(p),{icon:"fluent:calendar-ltr-24-regular",class:"w-5 h-5 text-gray-400"}),e[25]||(e[25]=k(" กำหนดการ ",-1))]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"เริ่ม",-1)),g(d,{modelValue:r(l).start_date,"onUpdate:modelValue":e[7]||(e[7]=s=>r(l).start_date=s),format:"dd/MM/yyyy HH:mm","auto-apply":"",teleport:!0,"input-class-name":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white"},null,8,["modelValue"])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"สิ้นสุด",-1)),g(d,{modelValue:r(l).end_date,"onUpdate:modelValue":e[8]||(e[8]=s=>r(l).end_date=s),format:"dd/MM/yyyy HH:mm","auto-apply":"",teleport:!0},null,8,["modelValue"])])])]),e[33]||(e[33]=t("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),t("div",Me,[t("label",je,[t("div",Oe,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=s=>r(l).shuffle_questions=s),class:"peer sr-only"},null,512),[[G,r(l).shuffle_questions]]),e[28]||(e[28]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-purple-600"},null,-1))]),e[29]||(e[29]=t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-300"},"สลับข้อคำถาม",-1))]),t("label",De,[t("div",Fe,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>r(l).is_active=s),class:"peer sr-only"},null,512),[[G,r(l).is_active]]),e[30]||(e[30]=t("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 dark:peer-focus:ring-purple-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-green-600"},null,-1))]),e[31]||(e[31]=t("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-300"},"เปิดใช้งาน",-1))])]),t("div",Qe,[t("button",{onClick:e[11]||(e[11]=s=>a.$router.back()),class:"px-6 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",disabled:r(U)}," ยกเลิก ",8,Be),t("button",{onClick:W,class:"px-6 py-2 rounded-lg bg-purple-600 text-white font-medium hover:bg-purple-700 disabled:opacity-50 transition-colors",disabled:!r(R)||r(U)},[r(U)?(u(),c("span",Ie,"กำลังบันทึก...")):(u(),c("span",Se,"บันทึกการเปลี่ยนแปลง"))],8,Te)])],512),[[K,r(w)==="settings"]]),m(t("div",Pe,[t("div",Ee,[e[35]||(e[35]=t("h3",{class:"font-bold text-gray-900 dark:text-white"},"รายการคำถาม",-1)),t("button",{onClick:H,class:"px-4 py-2 rounded-lg bg-purple-100 text-purple-600 hover:bg-purple-200 dark:bg-purple-900/30 dark:text-purple-400 dark:hover:bg-purple-900/50 transition-colors flex items-center gap-2 font-medium"},[g(r(p),{icon:"fluent:add-circle-24-regular",class:"w-5 h-5"}),e[34]||(e[34]=k(" เพิ่มข้อสอบ ",-1))])]),r(T).length===0?(u(),c("div",Le,[g(r(p),{icon:"fluent:quiz-new-24-regular",class:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e[36]||(e[36]=t("p",{class:"text-gray-500"},"ยังไม่มีข้อสอบในชุดนี้",-1)),t("button",{onClick:H,class:"text-purple-600 hover:underline mt-2"},"เพิ่มข้อสอบแรก")])):(u(),c("div",Re,[(u(!0),c(P,null,E(r(T),(s,o)=>(u(),c("div",{key:s.id,class:"bg-gray-50 dark:bg-gray-700/30 rounded-lg p-4 border border-gray-100 dark:border-gray-700"},[t("div",He,[t("div",Ne,[t("div",Ae,_(o+1),1),t("div",null,[t("h4",Ke,_(s.text),1),t("div",Ge,[(u(!0),c(P,null,E(s.options,n=>(u(),c("div",{key:n.id,class:"flex items-center gap-2 text-sm"},[g(r(p),{icon:n.is_correct?"fluent:checkmark-circle-24-filled":"fluent:circle-24-regular",class:F(n.is_correct?"text-green-500":"text-gray-400")},null,8,["icon","class"]),t("span",{class:F(n.is_correct?"text-green-700 dark:text-green-400 font-medium":"text-gray-600 dark:text-gray-400")},_(n.text),3)]))),128))])])]),t("div",Je,[t("span",We,_(s.points)+" คะแนน",1),t("span",Xe,_(s.pp_fine||0)+" แต้ม",1),t("button",{onClick:n=>se(s),class:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-full transition-colors",title:"แก้ไขคำถาม"},[g(r(p),{icon:"fluent:edit-20-regular",class:"w-5 h-5"})],8,Ye),t("button",{onClick:n=>le(s.id),class:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors",title:"ลบคำถาม"},[g(r(p),{icon:"fluent:delete-20-regular",class:"w-5 h-5"})],8,Ze)])])]))),128))]))],512),[[K,r(w)==="questions"]])])),r(q)?(u(),c("div",et,[t("div",tt,[t("div",rt,[t("h3",st,_(r(C)?"แก้ไขข้อสอบ":"เพิ่มข้อสอบใหม่"),1),t("button",{onClick:e[12]||(e[12]=s=>q.value=!1),class:"text-gray-400 hover:text-gray-500"},[g(r(p),{icon:"fluent:dismiss-24-regular",class:"w-6 h-6"})])]),t("div",at,[t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"คำถาม",-1)),m(t("textarea",{"onUpdate:modelValue":e[13]||(e[13]=s=>r(i).text=s),rows:"3",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"},null,512),[[$,r(i).text]]),t("div",ot,[e[38]||(e[38]=t("label",{class:"block text-xs font-medium text-gray-600 dark:text-gray-400 mb-2"},"แนบรูปภาพ/ไฟล์ประกอบคำถาม",-1)),r(O)||r(i).media_url?(u(),c("div",lt,[t("img",{src:r(O)||r(i).media_url,class:"h-24 w-auto rounded-lg object-cover",alt:"Question media"},null,8,it),t("button",{onClick:Y,type:"button",class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors"},[g(r(p),{icon:"fluent:dismiss-12-regular",class:"w-4 h-4"})])])):(u(),c("label",nt,[g(r(p),{icon:"fluent:image-add-20-regular",class:"w-5 h-5"}),e[37]||(e[37]=t("span",{class:"text-sm"},"เลือกไฟล์",-1)),t("input",{type:"file",accept:"image/*,video/*,audio/*",class:"hidden",onChange:X},null,32)]))])]),t("div",dt,[t("div",null,[e[40]||(e[40]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"คะแนน",-1)),m(t("input",{"onUpdate:modelValue":e[14]||(e[14]=s=>r(i).points=s),type:"number",min:"1",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[$,r(i).points,void 0,{number:!0}]])]),t("div",null,[t("label",ut,[e[41]||(e[41]=k(" แต้มค่าปรับ (PP Fine) ",-1)),g(r(p),{icon:"fluent:info-16-regular",class:"inline w-4 h-4 text-gray-400 ml-1",title:"จำนวนแต้มที่ผู้ใช้ต้องใช้เพื่อแก้ไขคำตอบหลังส่ง (0 = ฟรี)"})]),m(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>r(i).pp_fine=s),type:"number",min:"0",class:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"},null,512),[[$,r(i).pp_fine,void 0,{number:!0}]]),e[42]||(e[42]=t("p",{class:"text-xs text-gray-500 mt-1"},"0 = แก้ไขได้ฟรี",-1))])]),t("div",null,[t("div",ct,[e[44]||(e[44]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"ตัวเลือก (คลิกเพื่อเลือกข้อที่ถูก - เลือกได้มากกว่า 1 ข้อ)",-1)),t("button",{onClick:te,type:"button",class:"text-sm text-purple-600 hover:text-purple-700 dark:text-purple-400 flex items-center gap-1"},[g(r(p),{icon:"fluent:add-circle-16-regular",class:"w-4 h-4"}),e[43]||(e[43]=k(" เพิ่มตัวเลือก ",-1))])]),t("div",gt,[(u(!0),c(P,null,E(r(i).options,(s,o)=>(u(),c("div",{key:o,class:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-3"},[t("div",pt,[t("button",{onClick:n=>ae(o),class:"focus:outline-none mt-2.5",type:"button",title:"คลิกเพื่อเลือก/ยกเลิกคำตอบที่ถูกต้อง"},[t("div",{class:F(["w-6 h-6 rounded border-2 flex items-center justify-center transition-colors duration-200",s.is_correct?"bg-green-500 border-green-500 text-white":"border-gray-300 dark:border-gray-600 hover:border-green-400"])},[s.is_correct?(u(),J(r(p),{key:0,icon:"fluent:checkmark-16-filled",class:"w-4 h-4"})):D("",!0)],2)],8,ft),t("div",bt,[m(t("input",{"onUpdate:modelValue":n=>s.text=n,type:"text",placeholder:`ตัวเลือกที่ ${o+1}`,class:F(["w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",{"border-green-500 ring-1 ring-green-500":s.is_correct}])},null,10,xt),[[$,s.text]]),t("div",mt,[r(v)[o]||s.media_url?(u(),c("div",yt,[t("img",{src:r(v)[o]||s.media_url,class:"h-16 w-auto rounded object-cover",alt:`Option ${o+1} media`},null,8,vt),t("button",{onClick:n=>ee(o),type:"button",class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 transition-colors"},[g(r(p),{icon:"fluent:dismiss-12-regular",class:"w-3 h-3"})],8,kt)])):(u(),c("label",_t,[g(r(p),{icon:"fluent:image-add-20-regular",class:"w-4 h-4"}),e[45]||(e[45]=t("span",null,"แนบรูป",-1)),t("input",{type:"file",accept:"image/*",class:"hidden",onChange:n=>Z(n,o)},null,40,ht)]))])]),r(i).options.length>2?(u(),c("button",{key:0,onClick:n=>re(o),type:"button",class:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors mt-1",title:"ลบตัวเลือกนี้"},[g(r(p),{icon:"fluent:delete-20-regular",class:"w-5 h-5"})],8,wt)):D("",!0)])]))),128))]),t("p",Ct,[g(r(p),{icon:"fluent:info-16-regular",class:"inline w-3.5 h-3.5 mr-1"}),e[46]||(e[46]=k(" สามารถเลือกคำตอบที่ถูกต้องได้มากกว่า 1 ข้อ ",-1))])])]),t("div",$t,[t("button",{onClick:e[16]||(e[16]=s=>q.value=!1),class:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",disabled:r(M)},"ยกเลิก",8,qt),t("button",{onClick:oe,class:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-medium disabled:opacity-50 flex items-center gap-2",disabled:r(M)},[r(M)?(u(),J(r(p),{key:0,icon:"svg-spinners:ring-resize",class:"w-5 h-5"})):D("",!0),t("span",null,_(r(M)?"กำลังบันทึก...":"บันทึก"),1)],8,Vt)])])])):D("",!0)])}}});export{jt as default};
