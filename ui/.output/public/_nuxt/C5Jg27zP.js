import{a9 as O,r as G,n as h,c as l,b as d,w as k,o as n,a as r,d as _,u as c,I as g,F as w,k as A,T as x,t as m,g as I}from"./CHs-R6Sv.js";import T from"./D8Y91RFH.js";import{_ as j}from"./1kDC0fma.js";import{M as B}from"./cJcCQ7yW.js";import"./BLVhfM2G.js";import"./DROJGjoa.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./C6kxWCFL.js";import"./3QJUtkDr.js";import"./o5TVmNQv.js";import"./BWv91NqQ.js";const $={class:"mt-4"},q={class:"mb-6"},N={class:"flex items-center mb-4"},U={class:"flex flex-wrap gap-2 border-b border-gray-200 dark:border-gray-700 pb-2"},V=["onClick"],D={key:0,class:"mb-4 p-4 bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-gray-800 dark:to-gray-700 rounded-xl border border-indigo-100 dark:border-gray-600"},E={class:"flex items-center justify-between"},F={class:"flex items-center"},R={class:"p-2 bg-indigo-100 dark:bg-indigo-900 rounded-lg mr-3"},z={class:"font-bold text-gray-800 dark:text-white"},L={class:"text-sm text-gray-500 dark:text-gray-400"},S={key:1,class:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-xl"},oe={__name:"Members",props:{course:Object,members:Object,groups:Object,isCourseAdmin:Boolean,courseMemberOfAuth:Object},setup(b){const C=O(),u=b,a=G((()=>{const e=u.courseMemberOfAuth?.last_accessed_group_tab;if(!e)return 0;const t=(u.groups?.data||[]).findIndex(o=>o.id===e);return t>=0?t:0})()),i=h(()=>u.groups?.data||[]),p=h(()=>{const e=u.members?.data||[],s=u.course?.data?.user?.id;return e.filter(t=>!t.group&&!t.group_id).filter(t=>t.user?.id!==s)}),v=h(()=>{const e=i.value;return a.value>=e.length?p.value:e[a.value]?e[a.value].members||[]:[]}),y=h(()=>{const e=i.value;return a.value>=e.length?{id:null,name:"ไม่มีกลุ่ม",members_count:p.value.length}:e[a.value]||null});async function f(e){if(a.value===e)return;a.value=e;const s=i.value;if(e<s.length&&u.courseMemberOfAuth){const t=s[e].id;try{await C.patch(`/api/courses/${u.course.data.id}/members/update-last-access-group`,{last_accessed_group_tab:t})}catch(o){console.error("Error saving group tab:",o)}}}const M=e=>{console.log("Unmember request:",e)};return(e,s)=>(n(),l("div",null,[d(T,{isCourseAdmin:b.isCourseAdmin,courseMemberOfAuth:b.courseMemberOfAuth,course:b.course,activeTab:4},{courseContent:k(()=>[r("div",$,[r("div",q,[r("div",N,[d(c(g),{icon:"heroicons:user-group-solid",class:"w-6 h-6 text-indigo-600 mr-2"}),s[1]||(s[1]=r("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"},"สมาชิกรายวิชา",-1))]),r("div",U,[(n(!0),l(w,null,A(i.value,(t,o)=>(n(),l("button",{key:t.id,onClick:J=>f(o),class:x(["px-4 py-2 rounded-t-lg font-medium text-sm transition-all duration-200 flex items-center gap-2",a.value===o?"bg-indigo-600 text-white shadow-md":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[d(c(g),{icon:"heroicons:users",class:"w-4 h-4"}),r("span",null,m(t.name),1),r("span",{class:x(["px-2 py-0.5 text-xs rounded-full",a.value===o?"bg-white/20 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"])},m(t.members_count||t.members?.length||0),3)],10,V))),128)),p.value.length>0?(n(),l("button",{key:0,onClick:s[0]||(s[0]=t=>f(i.value.length)),class:x(["px-4 py-2 rounded-t-lg font-medium text-sm transition-all duration-200 flex items-center gap-2",a.value===i.value.length?"bg-orange-500 text-white shadow-md":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[d(c(g),{icon:"heroicons:user-minus",class:"w-4 h-4"}),s[2]||(s[2]=r("span",null,"ไม่มีกลุ่ม",-1)),r("span",{class:x(["px-2 py-0.5 text-xs rounded-full",a.value===i.value.length?"bg-white/20 text-white":"bg-orange-100 dark:bg-orange-900 text-orange-600 dark:text-orange-300"])},m(p.value.length),3)],2)):_("",!0)])]),y.value?(n(),l("div",D,[r("div",E,[r("div",F,[r("div",R,[d(c(g),{icon:"heroicons:user-group-solid",class:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})]),r("div",null,[r("h4",z,m(y.value.name),1),r("p",L,m(v.value.length)+" สมาชิก ",1)])])])])):_("",!0),d(j,{duration:50,tag:"ul",class:"flex flex-col w-full space-y-3"},{default:k(()=>[v.value.length>0?(n(!0),l(w,{key:0},A(v.value,(t,o)=>(n(),I(B,{key:t.id,member:t,dataIndex:o,onRequestUnmemberCourse:M},null,8,["member","dataIndex"]))),128)):(n(),l("div",S,[d(c(g),{icon:"heroicons:users",class:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),s[3]||(s[3]=r("p",{class:"text-gray-500 dark:text-gray-400 text-lg"},"ยังไม่มีสมาชิกในกลุ่มนี้",-1))]))]),_:1})])]),_:1},8,["isCourseAdmin","courseMemberOfAuth","course"])]))}};export{oe as default};
