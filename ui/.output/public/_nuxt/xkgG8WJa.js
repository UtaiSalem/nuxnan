import{_ as U,r as y,n as h,c as n,a as t,d as r,j as x,t as o,T as f,e as d,F as j,k as I,o as l}from"./CHs-R6Sv.js";const H={class:"flex min-h-screen items-center justify-center p-4"},S={class:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4"},q={class:"flex items-center justify-between"},A={class:"flex items-center text-white"},E={class:"text-indigo-100 text-sm mt-1"},O={class:"overflow-y-auto max-h-[calc(90vh-80px)]"},P={class:"p-6 space-y-6"},W={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},G={class:"bg-blue-50 rounded-lg p-4"},J={class:"text-lg font-bold text-gray-900"},K={key:0,class:"text-sm text-gray-600 mt-1"},Q={class:"bg-green-50 rounded-lg p-4"},X={class:"bg-purple-50 rounded-lg p-4"},Y={class:"text-sm font-semibold text-gray-900"},Z={class:"bg-orange-50 rounded-lg p-4"},tt={class:"text-lg font-bold text-gray-900"},et={class:"bg-white border border-gray-200 rounded-lg p-6"},st={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},it={class:"flex items-center space-x-4"},ot={class:"flex-shrink-0"},nt={class:"w-16 h-16 rounded-full bg-indigo-100 flex items-center justify-center"},lt={class:"text-indigo-600 font-bold text-xl"},at={class:"text-lg font-semibold text-gray-900"},rt={key:0,class:"text-sm text-gray-500"},dt={key:1,class:"text-sm text-gray-600 mt-1"},gt={class:"space-y-2"},ct={key:0,class:"text-sm"},ut={class:"text-gray-900 ml-2"},mt={key:1,class:"text-sm"},vt={class:"text-gray-900 ml-2"},xt={key:2,class:"text-sm"},ft={class:"text-gray-900 ml-2"},yt={key:1,class:"text-gray-500 italic"},bt={class:"bg-white border border-gray-200 rounded-lg p-6"},ht={key:0,class:"space-y-3"},pt={class:"flex items-center space-x-3"},wt={class:"font-medium text-gray-900"},kt={key:0,class:"text-sm text-gray-500"},Ct={key:0,class:"text-sm"},_t={class:"px-2 py-1 bg-indigo-100 text-indigo-800 rounded-full text-xs font-medium"},$t={key:1,class:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg"},jt={class:"font-medium text-gray-900"},It={key:0,class:"text-sm text-gray-500"},Dt={key:2,class:"text-gray-500 italic text-center py-4"},Tt={key:0,class:"bg-white border border-gray-200 rounded-lg p-6"},Mt={class:"prose max-w-none"},zt={class:"text-gray-700 whitespace-pre-wrap"},Lt={key:1,class:"bg-white border border-gray-200 rounded-lg p-6"},Bt={class:"prose max-w-none"},Nt={class:"text-gray-700 whitespace-pre-wrap"},Vt={key:2,class:"bg-white border border-gray-200 rounded-lg p-6"},Ft={class:"prose max-w-none"},Rt={class:"text-gray-700 whitespace-pre-wrap"},Ut={key:3,class:"bg-white border border-gray-200 rounded-lg p-6"},Ht={class:"prose max-w-none"},St={class:"text-gray-700 whitespace-pre-wrap"},qt={key:0,class:"mt-4 p-3 bg-blue-50 rounded-lg"},At={class:"text-sm font-medium text-blue-900"},Et={key:4,class:"bg-white border border-gray-200 rounded-lg p-6"},Ot={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},Pt={class:"mb-4 flex space-x-2 border-b border-gray-200"},Wt={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Gt=["onClick"],Jt={class:"aspect-square rounded-lg overflow-hidden bg-gray-100"},Kt=["src","alt"],Qt={key:0,class:"absolute top-2 right-2"},Xt={class:"bg-gray-50 border border-gray-200 rounded-lg p-6"},Yt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},Zt={class:"text-gray-900 ml-2"},te={class:"text-gray-900 ml-2"},ee={key:0},se={class:"text-gray-900 ml-2"},ie={class:"border-t border-gray-200 px-6 py-4 bg-gray-50 sticky bottom-0"},oe={class:"flex items-center justify-between"},ne={class:"flex space-x-3"},le=["src","alt"],ae={key:0,class:"text-white text-center mt-4"},re={__name:"VisitDetailModal",props:{visit:{type:Object,required:!0}},emits:["close"],setup(s,{emit:de}){const v=s,c=y("all"),b=y(!1),u=y(null),g=y(0),p=h(()=>v.visit.images?.filter(i=>i.image_type==="evidence")||[]),w=h(()=>v.visit.images?.filter(i=>i.image_type==="activity")||[]),m=h(()=>c.value==="evidence"?p.value:c.value==="activity"?w.value:v.visit.images||[]),D=i=>{u.value=i,g.value=m.value.findIndex(e=>e.id===i.id),b.value=!0},k=()=>{b.value=!1,u.value=null},T=()=>{g.value>0&&(g.value--,u.value=m.value[g.value])},M=()=>{g.value<m.value.length-1&&(g.value++,u.value=m.value[g.value])},C=i=>i?i.startsWith("http")?i:`/storage/${i}`:"",_=i=>i?new Date(i).toLocaleDateString("th-TH",{year:"numeric",month:"long",day:"numeric"}):"-",z=i=>{if(!i)return"-";try{return new Date(`2000-01-01 ${i}`).toLocaleTimeString("th-TH",{hour:"2-digit",minute:"2-digit"})}catch{return i}},$=i=>i?new Date(i).toLocaleString("th-TH",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",L=i=>i?`${i.first_name||""} ${i.last_name||""}`.trim()||"ไม่ระบุชื่อ":"ไม่ระบุ",B=i=>!i||!i.first_name?"N":i.first_name.charAt(0).toUpperCase(),N=i=>({pending:"รอดำเนินการ","in-progress":"กำลังดำเนินการ",completed:"เสร็จสิ้น",cancelled:"ยกเลิก"})[i]||i,V=i=>`px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full ${{pending:"bg-orange-100 text-orange-800","in-progress":"bg-yellow-100 text-yellow-800",completed:"bg-green-100 text-green-800",cancelled:"bg-gray-100 text-gray-800"}[i]||"bg-gray-100 text-gray-800"}`,F=()=>{window.print()},R=async()=>{try{const i=await axios.get(`/api/home-visit/admin/visits/${v.visit.id}/report`,{responseType:"blob"}),e=window.URL.createObjectURL(new Blob([i.data])),a=document.createElement("a");a.href=e,a.setAttribute("download",`home-visit-report-${v.visit.id}.pdf`),document.body.appendChild(a),a.click(),a.remove()}catch(i){console.error("Download failed:",i),alert("เกิดข้อผิดพลาดในการดาวน์โหลด")}};return(i,e)=>(l(),n("div",{class:"fixed inset-0 z-50 overflow-y-auto",onClick:e[8]||(e[8]=x(a=>i.$emit("close"),["self"]))},[e[43]||(e[43]=t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),t("div",H,[t("div",{class:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",onClick:e[6]||(e[6]=x(()=>{},["stop"]))},[t("div",S,[t("div",q,[t("div",A,[e[10]||(e[10]=t("i",{class:"fas fa-home text-2xl mr-3"},null,-1)),t("div",null,[e[9]||(e[9]=t("h3",{class:"text-xl font-bold"},"รายละเอียดการเยี่ยมบ้าน",-1)),t("p",E," รหัส: #"+o(s.visit.id),1)])]),t("button",{onClick:e[0]||(e[0]=a=>i.$emit("close")),class:"text-white hover:text-gray-200 transition-colors rounded-full hover:bg-white/20 p-2",title:"ปิดหน้าต่าง"},[...e[11]||(e[11]=[t("i",{class:"fas fa-times text-2xl"},null,-1)])])])]),t("div",O,[t("div",P,[t("div",W,[t("div",G,[e[12]||(e[12]=t("div",{class:"text-sm font-medium text-blue-600 mb-1"},"วันที่เยี่ยม",-1)),t("div",J,o(_(s.visit.visit_date)),1),s.visit.visit_time?(l(),n("div",K," เวลา "+o(z(s.visit.visit_time)),1)):r("",!0)]),t("div",Q,[e[13]||(e[13]=t("div",{class:"text-sm font-medium text-green-600 mb-1"},"สถานะ",-1)),t("div",null,[t("span",{class:f(V(s.visit.visit_status))},o(N(s.visit.visit_status)),3)])]),t("div",X,[e[15]||(e[15]=t("div",{class:"text-sm font-medium text-purple-600 mb-1"},"โซน",-1)),t("div",Y,[e[14]||(e[14]=t("i",{class:"fas fa-map-marker-alt mr-1"},null,-1)),d(" "+o(s.visit.zone?.zone_name||"ไม่ระบุ"),1)])]),t("div",Z,[e[17]||(e[17]=t("div",{class:"text-sm font-medium text-orange-600 mb-1"},"รูปภาพ",-1)),t("div",tt,[e[16]||(e[16]=t("i",{class:"fas fa-images mr-2"},null,-1)),d(" "+o(s.visit.images?.length||0)+" รูป ",1)])])]),t("div",et,[e[21]||(e[21]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-user-graduate mr-2 text-indigo-600"}),d(" ข้อมูลนักเรียน ")],-1)),s.visit.student?(l(),n("div",st,[t("div",it,[t("div",ot,[t("div",nt,[t("span",lt,o(B(s.visit.student)),1)])]),t("div",null,[t("div",at,o(L(s.visit.student)),1),s.visit.student.nickname?(l(),n("div",rt," ชื่อเล่น: "+o(s.visit.student.nickname),1)):r("",!0),s.visit.student.student_code?(l(),n("div",dt," รหัสนักเรียน: "+o(s.visit.student.student_code),1)):r("",!0)])]),t("div",gt,[s.visit.student.email?(l(),n("div",ct,[e[18]||(e[18]=t("span",{class:"text-gray-500"},"อีเมล:",-1)),t("span",ut,o(s.visit.student.email),1)])):r("",!0),s.visit.student.phone?(l(),n("div",mt,[e[19]||(e[19]=t("span",{class:"text-gray-500"},"เบอร์โทร:",-1)),t("span",vt,o(s.visit.student.phone),1)])):r("",!0),s.visit.student.classroom?(l(),n("div",xt,[e[20]||(e[20]=t("span",{class:"text-gray-500"},"ห้องเรียน:",-1)),t("span",ft,o(s.visit.student.classroom),1)])):r("",!0)])])):(l(),n("div",yt," ไม่มีข้อมูลนักเรียน "))]),t("div",bt,[e[24]||(e[24]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-users mr-2 text-indigo-600"}),d(" ครูผู้เข้าร่วมการเยี่ยมบ้าน ")],-1)),s.visit.participants&&s.visit.participants.length>0?(l(),n("div",ht,[(l(!0),n(j,null,I(s.visit.participants,a=>(l(),n("div",{key:a.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",pt,[e[22]||(e[22]=t("div",{class:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center"},[t("i",{class:"fas fa-user text-indigo-600"})],-1)),t("div",null,[t("div",wt,o(a.participant_name),1),a.participant_position?(l(),n("div",kt,o(a.participant_position),1)):r("",!0)])]),a.participant_role?(l(),n("div",Ct,[t("span",_t,o(a.participant_role),1)])):r("",!0)]))),128))])):s.visit.visitor_name?(l(),n("div",$t,[e[23]||(e[23]=t("div",{class:"w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center"},[t("i",{class:"fas fa-user text-indigo-600"})],-1)),t("div",null,[t("div",jt,o(s.visit.visitor_name),1),s.visit.visitor_position?(l(),n("div",It,o(s.visit.visitor_position),1)):r("",!0)])])):(l(),n("div",Dt," ไม่มีข้อมูลครูผู้เข้าร่วม "))]),s.visit.observations?(l(),n("div",Tt,[e[25]||(e[25]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-clipboard-list mr-2 text-indigo-600"}),d(" ผลการสังเกต ")],-1)),t("div",Mt,[t("p",zt,o(s.visit.observations),1)])])):r("",!0),s.visit.notes?(l(),n("div",Lt,[e[26]||(e[26]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-sticky-note mr-2 text-indigo-600"}),d(" บันทึกเพิ่มเติม ")],-1)),t("div",Bt,[t("p",Nt,o(s.visit.notes),1)])])):r("",!0),s.visit.recommendations?(l(),n("div",Vt,[e[27]||(e[27]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-lightbulb mr-2 text-yellow-600"}),d(" ข้อเสนอแนะ ")],-1)),t("div",Ft,[t("p",Rt,o(s.visit.recommendations),1)])])):r("",!0),s.visit.follow_up?(l(),n("div",Ut,[e[29]||(e[29]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-tasks mr-2 text-indigo-600"}),d(" การติดตามผล ")],-1)),t("div",Ht,[t("p",St,o(s.visit.follow_up),1)]),s.visit.next_visit?(l(),n("div",qt,[t("div",At,[e[28]||(e[28]=t("i",{class:"fas fa-calendar-alt mr-2"},null,-1)),d(" กำหนดการเยี่ยมครั้งถัดไป: "+o(_(s.visit.next_visit)),1)])])):r("",!0)])):r("",!0),s.visit.images&&s.visit.images.length>0?(l(),n("div",Et,[t("h4",Ot,[e[30]||(e[30]=t("i",{class:"fas fa-images mr-2 text-indigo-600"},null,-1)),d(" รูปภาพประกอบ ("+o(s.visit.images.length)+" รูป) ",1)]),t("div",Pt,[t("button",{onClick:e[1]||(e[1]=a=>c.value="all"),class:f(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",c.value==="all"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"])}," ทั้งหมด ("+o(s.visit.images.length)+") ",3),t("button",{onClick:e[2]||(e[2]=a=>c.value="evidence"),class:f(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",c.value==="evidence"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"])}," หลักฐาน ("+o(p.value.length)+") ",3),t("button",{onClick:e[3]||(e[3]=a=>c.value="activity"),class:f(["px-4 py-2 text-sm font-medium border-b-2 transition-colors",c.value==="activity"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"])}," กิจกรรม ("+o(w.value.length)+") ",3)]),t("div",Wt,[(l(!0),n(j,null,I(m.value,a=>(l(),n("div",{key:a.id,class:"relative group cursor-pointer",onClick:ge=>D(a)},[t("div",Jt,[t("img",{src:C(a.image_path),alt:a.image_description||"รูปภาพการเยี่ยมบ้าน",class:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-200"},null,8,Kt)]),e[31]||(e[31]=t("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-opacity rounded-lg flex items-center justify-center"},[t("i",{class:"fas fa-search-plus text-white text-2xl opacity-0 group-hover:opacity-100 transition-opacity"})],-1)),a.image_type?(l(),n("div",Qt,[t("span",{class:f(["px-2 py-1 rounded-full text-xs font-medium",a.image_type==="evidence"?"bg-blue-500 text-white":"bg-green-500 text-white"])},o(a.image_type==="evidence"?"หลักฐาน":"กิจกรรม"),3)])):r("",!0)],8,Gt))),128))])])):r("",!0),t("div",Xt,[e[35]||(e[35]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},[t("i",{class:"fas fa-info-circle mr-2 text-gray-600"}),d(" ข้อมูลเพิ่มเติม ")],-1)),t("div",Yt,[t("div",null,[e[32]||(e[32]=t("span",{class:"text-gray-500"},"สร้างเมื่อ:",-1)),t("span",Zt,o($(s.visit.created_at)),1)]),t("div",null,[e[33]||(e[33]=t("span",{class:"text-gray-500"},"แก้ไขล่าสุด:",-1)),t("span",te,o($(s.visit.updated_at)),1)]),s.visit.creator?(l(),n("div",ee,[e[34]||(e[34]=t("span",{class:"text-gray-500"},"สร้างโดย:",-1)),t("span",se,o(s.visit.creator.name),1)])):r("",!0)])])])]),t("div",ie,[t("div",oe,[t("button",{onClick:F,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors"},[...e[36]||(e[36]=[t("i",{class:"fas fa-print mr-2"},null,-1),d(" พิมพ์รายงาน ",-1)])]),t("div",ne,[t("button",{onClick:R,class:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors"},[...e[37]||(e[37]=[t("i",{class:"fas fa-download mr-2"},null,-1),d(" ดาวน์โหลด PDF ",-1)])]),t("button",{onClick:e[4]||(e[4]=a=>i.$emit("close")),class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg transition-colors shadow-lg"},[...e[38]||(e[38]=[t("i",{class:"fas fa-times mr-2"},null,-1),d(" ปิด ",-1)])])])])]),t("button",{onClick:e[5]||(e[5]=a=>i.$emit("close")),class:"fixed bottom-6 right-6 z-10 w-14 h-14 bg-red-600 hover:bg-red-700 text-white rounded-full shadow-2xl flex items-center justify-center transition-all hover:scale-110",title:"ปิดหน้าต่าง"},[...e[39]||(e[39]=[t("i",{class:"fas fa-times text-xl"},null,-1)])])])]),b.value?(l(),n("div",{key:0,class:"fixed inset-0 z-[60] bg-black bg-opacity-90 flex items-center justify-center p-4",onClick:k},[t("button",{onClick:k,class:"absolute top-4 right-4 text-white hover:text-gray-300 text-3xl"},[...e[40]||(e[40]=[t("i",{class:"fas fa-times"},null,-1)])]),t("div",{class:"max-w-5xl max-h-full",onClick:e[7]||(e[7]=x(()=>{},["stop"]))},[t("img",{src:C(u.value?.image_path),alt:u.value?.image_description,class:"max-w-full max-h-[80vh] object-contain mx-auto"},null,8,le),u.value?.image_description?(l(),n("div",ae,o(u.value.image_description),1)):r("",!0)]),g.value>0?(l(),n("button",{key:0,onClick:x(T,["stop"]),class:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 text-4xl"},[...e[41]||(e[41]=[t("i",{class:"fas fa-chevron-left"},null,-1)])])):r("",!0),g.value<m.value.length-1?(l(),n("button",{key:1,onClick:x(M,["stop"]),class:"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300 text-4xl"},[...e[42]||(e[42]=[t("i",{class:"fas fa-chevron-right"},null,-1)])])):r("",!0)])):r("",!0)]))}},ue=U(re,[["__scopeId","data-v-f786d967"]]);export{ue as default};
