import{r as u,o as p,g as w,w as s,a as m,c as $,S as I,d as L,b as g,n}from"./Brb_7992.js";import{S as r}from"./BQxta0Da.js";import R from"./Bw_wEDt3.js";import{_ as T}from"./rPLS4Pv1.js";import{_ as x}from"./BerWVpxm.js";import"./BP2gnDQ3.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./CZYWTWzM.js";import"./BF4yyfxD.js";import"./KqkJvF9s.js";const B={class:"mt-4"},D={key:0},E={__name:"AcademyLayout",props:{academy:Object,isAcademyAdmin:Boolean},setup(c){const t=c,d=n(()=>t.academy?.data||t.academy||{}),y=n(()=>{const e=d.value.logo;return e?"/storage/images/academies/logos/"+e:"/storage/images/academies/logos/default_logo.png"}),v=n(()=>{const e=d.value.cover;return e?"/storage/images/academies/covers/"+e:"/storage/images/academies/covers/default_cover.png"}),i=u(d.value.name||""),l=u(d.value.slogan||"");async function b(e){const a=new FormData;a.append("cover",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function f(e){const a=new FormData;a.append("logo",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function S(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{name:e})}async function C(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{slogan:e})}async function h(){try{let e=await axios.post(`/academies/${t.academy.data.id}/members`);e.data&&e.data.success?(t.academy.data.memberStatus=e.data.memberStatus,t.academy.data.total_students=e.data.totalStudents,e.data&&e.data.success&&(t.academy.data.memberStatus=e.data.memberStatus,r.fire("เสร็จสิ้น","ขอเป็นสมาชิกเรียบร้อยแล้ว","success"))):e.data&&!e.data.success&&r.fire("เกิดข้อผิดพลาด",e.data.msg,"error")}catch(e){console.log(e)}}async function A(){console.log("unmember");try{let e=await axios.post(`/academies/${t.academy.data.id}/unmembers`);e.data&&e.data.success&&(t.academy.data.memberStatus==2&&t.academy.data.total_students--,t.academy.data.memberStatus=null,r.fire("เสร็จสิ้น","ออกจากการเป็นสมาชิกเรียบร้อยแล้ว","success"))}catch(e){console.log(e)}}return(e,a)=>(p(),w(R,{title:d.value.name||"Academy"},{coverProfileCard:s(()=>[g(T,{coverImage:v.value,logoImage:y.value,coverHeader:i.value,"onUpdate:coverHeader":a[0]||(a[0]=o=>i.value=o),coverSubheader:l.value,"onUpdate:coverSubheader":a[1]||(a[1]=o=>l.value=o),model:"Academy",modelTable:"academies",modelableId:d.value.id,modelableType:"app/models/Academy",modelableRoute:`/academies/${d.value.id}`,modelData:d.value,subModelDataLength:d.value.courses_offered,subModelNameTh:"รายวิชา",isAcademyAdmin:t.isAcademyAdmin,onCoverImageChange:a[2]||(a[2]=o=>{b(o)}),onLogoImageChange:a[3]||(a[3]=o=>{f(o)}),onHeaderChange:a[4]||(a[4]=o=>{S(o)}),onSubheaderChange:a[5]||(a[5]=o=>{C(o)}),onRequestTobeMember:h,onRequestTobeUnmember:A},null,8,["coverImage","logoImage","coverHeader","coverSubheader","modelableId","modelableRoute","modelData","subModelDataLength","isAcademyAdmin"]),g(x,{academy:c.academy,activeTab:0},null,8,["academy"])]),leftSideWidget:s(()=>[...a[6]||(a[6]=[m("div",{class:"space-y-4"},null,-1)])]),mainContent:s(()=>[m("div",B,[e.$slots.academyContent?(p(),$("div",D,[I(e.$slots,"academyContent")])):L("",!0)])]),rightSideWidget:s(()=>[...a[7]||(a[7]=[m("div",null,null,-1)])]),_:3},8,["title"]))}};export{E as default};
