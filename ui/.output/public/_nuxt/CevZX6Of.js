import{r as d,z as F,g as H,w as h,o as r,a as o,c as i,e as v,t as l,b as c,u,I as p,F as U,k as B}from"./cTealXVQ.js";import{S as b}from"./BQxta0Da.js";import D from"./Dtfmjnau.js";import{_ as L}from"./kD1PCJ5t.js";import{_ as T}from"./DHU2WLsk.js";import"./ChBnuzYQ.js";import"./DJsVOgax.js";import"./Cpj98o6Y.js";import"./CYLt1a9j.js";import"./srasqk13.js";import"./BZ03tRGr.js";const j={class:""},R={class:"section-header my-4 p-4 bg-white rounded-xl shadow-lg flex justify-between items-center"},N={class:"section-header-info"},E={class:"section-title font-prompt text-xl font-bold"},V={class:"text-indigo-600 ml-2"},q={key:0,class:"flex justify-center p-8"},O={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},z=["src"],P={class:"overflow-hidden"},G={class:"font-bold text-gray-800 dark:text-gray-200 truncate"},J={class:"text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1"},K={class:"inline-block mt-1 px-2 py-0.5 text-[10px] rounded-full bg-blue-100 text-blue-600 dark:bg-blue-900 dark:text-blue-300"},Q={key:2,class:"flex flex-col items-center justify-center p-12 bg-white dark:bg-gray-800 rounded-xl shadow text-center"},ne={__name:"AcademyMembers",props:{academy:Object,courses:Object,isAcademyAdmin:Boolean,app_url:String},setup(x){const t=x;d(!1);const n=d([]),m=d(!0),_=d(t.academy.data.logo?"/storage/images/academies/logos/"+t.academy.data.logo:"/storage/images/academies/logos/default_logo.png"),w=d(t.academy.data.cover?"/storage/images/academies/covers/"+t.academy.data.cover:"/storage/images/academies/covers/default_cover.png");consttempHeader=d(t.academy.data.name);const g=d(t.academy.data.slogan);async function y(){m.value=!0;try{const e=await axios.get(`/api/academies/${t.academy.data.id}/members`);e.data.success&&(e.data.members&&e.data.members.data?n.value=e.data.members.data:n.value=e.data.members||[])}catch(e){console.error("Error fetching members:",e)}finally{m.value=!1}}F(()=>{y()});const f=e=>e.user?e.user.name:e.student?`${e.student.first_name_th} ${e.student.last_name_th}`:"Unknown Member",k=e=>e.user&&e.user.profile_photo_url?e.user.profile_photo_url:`https://ui-avatars.com/api/?name=${encodeURIComponent(f(e))}&color=7F9CF5&background=EBF4FF`,C=e=>e.student?e.student.student_id:e.member_code?e.member_code:"-";async function M(e){const a=new FormData;a.append("cover",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function A(e){const a=new FormData;a.append("logo",e),a.append("_method","patch"),await axios.post(`/academies/${t.academy.data.id}/update`,a)}async function I(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{name:e})}async function $(e){await axios.patch(`/academies/${t.academy.data.id}/update`,{slogan:e})}async function S(){try{let e=await axios.post(`/academies/${t.academy.data.id}/members`);e.data.success&&(t.academy.data.isMember=e.data.isMember,t.academy.data.total_students=e.data.totalStudents,y(),e.data.isMember?b.fire("เสร็จสิ้น","ขอเป็นสมาชิกเรียบร้อยแล้ว","success"):b.fire("เสร็จสิ้น","ออกจากการเป็นสมาชิกเรียบร้อยแล้ว","success"))}catch{}}return(e,a)=>(r(),H(D,{title:"Academy Members",appUrl:t.app_url},{coverProfileCard:h(()=>[o("div",j,[c(L,{coverImage:w.value,logoImage:_.value,coverHeader:e.tempHeader,"onUpdate:coverHeader":a[0]||(a[0]=s=>e.tempHeader=s),coverSubheader:g.value,"onUpdate:coverSubheader":a[1]||(a[1]=s=>g.value=s),model:"Academy",modelTable:"academies",modelableId:t.academy.data.id,modelableType:"app/models/Academy",modelableRoute:`/academies/${t.academy.data.id}`,modelData:t.academy.data,subModelData:t.courses.data,subModelNameTh:"รายวิชา",isAcademyAdmin:t.isAcademyAdmin,onCoverImageChange:a[2]||(a[2]=s=>{M(s)}),onLogoImageChange:a[3]||(a[3]=s=>{A(s)}),onHeaderChange:a[4]||(a[4]=s=>{I(s)}),onSubheaderChange:a[5]||(a[5]=s=>{$(s)}),onRequestTobeMember:a[6]||(a[6]=s=>S())},null,8,["coverImage","logoImage","coverHeader","coverSubheader","modelableId","modelableRoute","modelData","subModelData","isAcademyAdmin"])]),c(T,{academy:t.academy,activeTab:3},null,8,["academy"])]),mainContent:h(()=>[o("div",R,[o("div",N,[o("h2",E,[a[7]||(a[7]=v("สมาชิกทั้งหมด ",-1)),o("span",V,l(n.value.length)+" คน",1)])])]),m.value?(r(),i("div",q,[c(u(p),{icon:"svg-spinners:3-dots-scale",class:"w-10 h-10 text-indigo-500"})])):n.value.length>0?(r(),i("div",O,[(r(!0),i(U,null,B(n.value,s=>(r(),i("div",{key:s.id,class:"bg-white dark:bg-gray-800 rounded-xl shadow p-4 flex items-center space-x-4 hover:shadow-md transition-shadow"},[o("img",{src:k(s),alt:"Avatar",class:"w-12 h-12 rounded-full object-cover ring-2 ring-indigo-100"},null,8,z),o("div",P,[o("h3",G,l(f(s)),1),o("p",J,[c(u(p),{icon:"heroicons:identification",class:"w-3 h-3"}),v(" "+l(C(s)),1)]),o("span",K,l(s.role||"Student"),1)])]))),128))])):(r(),i("div",Q,[c(u(p),{icon:"heroicons:users",class:"w-16 h-16 text-gray-300 mb-4"}),a[8]||(a[8]=o("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"ยังไม่มีสมาชิก",-1)),a[9]||(a[9]=o("p",{class:"text-gray-500 text-sm mt-1"},'คลิก "เชิญสมาชิก" เพื่อเชิญผู้ใช้เข้าร่วม (ถ้ามีสิทธิ์)',-1))]))]),_:1},8,["appUrl"]))}};export{ne as default};
